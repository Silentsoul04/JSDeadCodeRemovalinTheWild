(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(e,t,r){var n;!function(r){var i={};i.EventTarget=function(){"use strict";function e(){this._handlers={}}return e.prototype={constructor:e,on:function(e,t){var r,n,i=this._handlers[e];for(void 0===i&&(i=this._handlers[e]=[]),r=0,n=i.length;r<n;r++)if(i[r]===t)return;i.push(t)},fire:function(e,t){var r,n,i,a={type:e,data:t};if((r=this._handlers[a.type])instanceof Array)for(n=0,i=(r=r.concat()).length;n<i;n++)r[n].call(this,a)},off:function(e,t){var r,n,i=this._handlers[e];if(i instanceof Array)for(r=0,n=i.length;r<n;r++)if(i[r]===t){i.splice(r,1);break}}},e}(),i.NativeDOM=function(){"use strict";return{type:"native",query:function(e,t){return e.querySelector(t)},queryAll:function(e,t){return e.querySelectorAll(t)},on:function(e,t,r){e.addEventListener(t,r,!1)},off:function(e,t,r){e.removeEventListener(t,r,!1)}}}(),i.DOM=i.NativeDOM,i.DOMEventDelegate=function(){"use strict";var e=["click","mouseover","mouseout","mousedown","mouseup","mouseenter","mouseleave","mousemove","keydown","keyup","submit","change","contextmenu","dblclick","input","focusin","focusout"];function t(e){return e&&e.hasAttribute("data-module")}function r(e){return e&&e.hasAttribute("data-type")}function n(e,t,r,n){var i,a;for(i=0;i<e.length;i++)t["on"+(a=e[i])]&&r.call(n,a)}function a(t,r,n){this.element=t,this._handler=r,this._eventTypes=n||e,this._boundHandler={},this._attached=!1}return a.prototype={constructor:a,_handleEvent:function(e){var n=function(e){for(var n=!1,i=!1;!n&&e&&e.parentNode&&!i;)n=r(e),i=t(e),n||(e=e.parentNode);return n?e:null}(e.target),i=n?n.getAttribute("data-type"):"";this._handler["on"+e.type](e,n,i)},attachEvents:function(){this._attached||(n(this._eventTypes,this._handler,function(e){var t=this;function r(){t._handleEvent.apply(t,arguments)}i.DOM.on(this.element,e,r),this._boundHandler[e]=r},this),this._attached=!0)},detachEvents:function(){n(this._eventTypes,this._handler,function(e){i.DOM.off(this.element,e,this._boundHandler[e])},this)}},a}(),i.Context=function(){"use strict";function e(e,t){this.application=e,this.element=t}return e.prototype={constructor:e,broadcast:function(e,t){this.application.broadcast(e,t)},getService:function(e){return this.application.getService(e)},hasService:function(e){return this.application.hasService(e)},getConfig:function(e){return this.application.getModuleConfig(this.element,e)},getGlobal:function(e){return this.application.getGlobal(e)},getGlobalConfig:function(e){return this.application.getGlobalConfig(e)},reportError:function(e){this.application.reportError(e)},getElement:function(){return this.element}},e}(),i.Application=function(){"use strict";var e={},t={},n=[],a={},o={},s={},l=!1,u=null,c=new i.EventTarget;function d(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function f(t){if("function"!=typeof u){if(e.debug)throw t;c.fire("error",{exception:t})}else u(t)}function h(e,t){"function"==typeof e[t]&&e[t].apply(e,Array.prototype.slice.call(arguments,2))}function p(e){var t,r,n,i,a,s=[],l={};for(r=e.instance.behaviors||[],t=0;t<r.length;t++)a=r[t],"behaviorInstances"in e||(e.behaviorInstances={}),i=e.behaviorInstances,n=o[a],a in l?f(new Error('Behavior "'+a+'" cannot be specified twice in a module.')):n?(i[a]||(i[a]=n.creator(e.context)),s.push(i[a])):f(new Error('Behavior "'+a+'" not found')),l[a]=!0;return s}function v(t,r,n){var a=new i.DOMEventDelegate(r,n,e.eventTypes);t.push(a),a.attachEvents()}function g(e){return s[e.id]}function y(e,t,r){null!==e.onmessage&&"object"==typeof e.onmessage&&e.onmessage.hasOwnProperty(t)?e.onmessage[t].call(e,r):-1!==function(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}(e.messages||[],t)&&e.onmessage.call(e,t,r)}return d(c,{init:function(t){return d(e,t||{}),this.startAll(document.documentElement),this.fire("init"),l=!0,this},destroy:function(){return this.stopAll(document.documentElement),e={},t={},a={},n=[],o={},s={},l=!1,this},isStarted:function(e){return"object"==typeof g(e)},start:function(r){var n,a,o,l=function(e){var t=e.getAttribute("data-module");return t?t.split(" ")[0]:""}(r),u=t[l];if(!u)return f(new Error('Module type "'+l+'" is not defined.')),this;if(!this.isStarted(r)){r.id||(r.id="mod-"+l+"-"+u.counter),u.counter++,a=new i.Context(this,r),o=u.creator(a),e.debug||function(e,t){var r,n;for(r in e)"function"==typeof(n=e[r])&&(e[r]=function(e,r){return function(){var n=t+"."+e+"() - ";try{return r.apply(this,arguments)}catch(r){r.methodName=e,r.objectName=t,r.name=n+r.name,r.message=n+r.message,f(r)}}}(r,n))}(o,l),n={moduleName:l,instance:o,context:a,element:r,eventDelegates:[]},s[r.id]=n;for(var c=p(n),d=0,g=c.length;d<g;d++)h(c[d],"init");h(n.instance,"init"),function(e){var t=e.eventDelegates,r=p(e);v(t,e.element,e.instance);for(var n=0;n<r.length;n++)v(t,e.element,r[n])}(n)}return this},stop:function(t){var r=g(t);if(r){!function(e){for(var t=e.eventDelegates,r=0;r<t.length;r++)t[r].detachEvents();e.eventDelegates=[]}(r);for(var n=p(r),i=n.length-1;i>=0;i--)h(n[i],"destroy");h(r.instance,"destroy"),delete s[t.id]}else if(e.debug)return f(new Error("Unable to stop module associated with element: "+t.id)),this;return this},startAll:function(e){for(var t=i.DOM.queryAll(e,"[data-module]"),r=0,n=t.length;r<n;r++)this.start(t[r]);return this},stopAll:function(e){for(var t=i.DOM.queryAll(e,"[data-module]"),r=0,n=t.length;r<n;r++)this.stop(t[r]);return this},addModule:function(e,r){return void 0!==t[e]?(f(new Error("Module "+e+" has already been added.")),this):(t[e]={creator:r,counter:1},this)},getModuleConfig:function(e,t){var r=g(e),n=null;if(r&&r.config)n=r.config;else{var a=i.DOM.query(e,'script[type="text/x-config"]');if(a)try{n=JSON.parse(a.text)}catch(t){f(new Error("Module with id "+e.id+" has a malformed config."))}r&&(r.config=n)}return n?void 0===t?n:t in n?n[t]:null:null},addService:function(e,t){return void 0!==a[e]?(f(new Error("Service "+e+" has already been added.")),this):(a[e]={creator:t,instance:null},this)},getService:function(e){var t=a[e];if(t){if(!t.instance){if(function(e){for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return!0;return!1}(e))return f(new ReferenceError("Circular service dependency: "+n.join(" -> ")+" -> "+e)),null;n.push(e),t.instance=t.creator(c),n.pop()}return t.instance}return f(new Error('Service "'+e+'" not found')),null},hasService:function(e){return a.hasOwnProperty(e)},addBehavior:function(e,t){return void 0!==o[e]?(f(new Error("Behavior "+e+" has already been added.")),this):(o[e]={creator:t,instance:null},this)},broadcast:function(e,t){var r,n,i,a;for(n in s)if(s.hasOwnProperty(n))for(y((i=s[n]).instance,e,t),a=p(i),r=0;r<a.length;r++)y(a[r],e,t);return this.fire("message",{message:e,messageData:t}),this},getGlobal:function(e){return e in r?r[e]:null},getGlobalConfig:function(t){return void 0===t?e:t in e?e[t]:null},setGlobalConfig:function(t){return l?(f(new Error("Cannot set global configuration after application initialization")),this):(d(e,t),this)},setErrorHandler:function(e){u=e},reportError:f,reportWarning:function(t){if(e.debug){var r=this.getGlobal("console");r&&r.warn&&r.warn(t)}else c.fire("warning",t)},reportInfo:function(t){if(e.debug){var r=this.getGlobal("console");r&&r.info&&r.info(t)}}})}(),void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)}("undefined"!=typeof window?window:this)},,,function(e,t,r){var n=r(86);e.exports=function(e,t,r){var i=null==e?void 0:n(e,t);return void 0===i?r:i}},,,,,,,,,,function(e,t,r){var n=r(57),i=r(16),a=r(49),o="[object String]";e.exports=function(e){return"string"==typeof e||!i(e)&&a(e)&&n(e)==o}},,function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){var n=r(53),i=r(169),a=r(98),o=r(82),s=n(function(e,t,r){var n=1;if(r.length){var l=o(r,a(s));n|=32}return i(e,n,t,r,l)});s.placeholder={},e.exports=s},,function(e,t,r){var n=r(307),i=r(165);e.exports=function(e,t){return null!=e&&i(e,t,n)}},,,,function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},,,function(e,t,r){var n=r(79),i=r(53),a=r(361),o=r(144),s=i(function(e){return e.push(void 0,a),n(o,void 0,e)});e.exports=s},function(e,t,r){var n=r(57),i=r(23),a="[object AsyncFunction]",o="[object Function]",s="[object GeneratorFunction]",l="[object Proxy]";e.exports=function(e){if(!i(e))return!1;var t=n(e);return t==o||t==s||t==a||t==l}},,,function(e,t,r){var n=r(136),i=r(103)(function(e,t,r){n(e,t,r)});e.exports=i},function(e,t,r){var n;!function(i){function a(e,t,r,n,i){this._listener=t,this._isOnce=r,this.context=n,this._signal=e,this._priority=i||0}function o(e,t){if("function"!=typeof e)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))}function s(){this._bindings=[],this._prevParams=null;var e=this;this.dispatch=function(){s.prototype.dispatch.apply(e,arguments)}}a.prototype={active:!0,params:null,execute:function(e){var t,r;return this.active&&this._listener&&(r=this.params?this.params.concat(e):e,t=this._listener.apply(this.context,r),this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},s.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(e,t,r,n){var i,o=this._indexOfListener(e,r);if(-1!==o){if((i=this._bindings[o]).isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else i=new a(this,e,t,r,n),this._addBinding(i);return this.memorize&&this._prevParams&&i.execute(this._prevParams),i},_addBinding:function(e){var t=this._bindings.length;do{--t}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){for(var r,n=this._bindings.length;n--;)if((r=this._bindings[n])._listener===e&&r.context===t)return n;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,r){return o(e,"add"),this._registerListener(e,!1,t,r)},addOnce:function(e,t,r){return o(e,"addOnce"),this._registerListener(e,!0,t,r)},remove:function(e,t){o(e,"remove");var r=this._indexOfListener(e,t);return-1!==r&&(this._bindings[r]._destroy(),this._bindings.splice(r,1)),e},removeAll:function(){for(var e=this._bindings.length;e--;)this._bindings[e]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(e){if(this.active){var t,r=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=r),n){t=this._bindings.slice(),this._shouldPropagate=!0;do{n--}while(t[n]&&this._shouldPropagate&&!1!==t[n].execute(r))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var l=s;l.Signal=s,void 0===(n=function(){return l}.call(t,r,t,e))||(e.exports=n)}()},function(e,t){e.exports=function(e){return void 0===e}},,,,function(e,t,r){var n=r(354);e.exports=function(e,t,r){for(var i=r?e:e.parentNode;i&&i!==document;){if(n(i,t))return i;i=i.parentNode}}},function(e,t,r){var n=r(153),i="object"==typeof self&&self&&self.Object===Object&&self,a=n||i||Function("return this")();e.exports=a},,,function(e,t,r){var n=r(161),i=r(163),a=r(59);e.exports=function(e){return a(e)?n(e):i(e)}},,function(e,t,r){var n=r(84),i=r(23),a="Expected a function";e.exports=function(e,t,r){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError(a);return i(r)&&(o="leading"in r?!!r.leading:o,s="trailing"in r?!!r.trailing:s),n(e,t,{leading:o,maxWait:t,trailing:s})}},,function(e,t,r){var n=r(196);e.exports=function(e,t,r){return null==e?e:n(e,t,r)}},function(e,t,r){var n=r(57),i=r(121),a=r(49),o="[object Object]",s=Function.prototype,l=Object.prototype,u=s.toString,c=l.hasOwnProperty,d=u.call(Object);e.exports=function(e){if(!a(e)||n(e)!=o)return!1;var t=i(e);if(null===t)return!0;var r=c.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&u.call(r)==d}},function(e,t,r){var n=r(326),i=1,a=4;e.exports=function(e){return n(e,i|a)}},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,r){"use strict";var n="function"==typeof fetch?fetch:function(e,t){return t=t||{},new Promise(function(r,n){var i=new XMLHttpRequest;for(var a in i.open(t.method||"get",e),t.headers)i.setRequestHeader(a,t.headers[a]);function o(){var e,t=[],r=[],n={};return i.getAllResponseHeaders().replace(/^(.*?):\s*([\s\S]*?)$/gm,function(i,a,o){t.push(a=a.toLowerCase()),r.push([a,o]),e=n[a],n[a]=e?e+","+o:o}),{ok:1==(i.status/200|0),status:i.status,statusText:i.statusText,url:i.responseURL,clone:o,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(i.responseText).then(JSON.parse)},xml:function(){return Promise.resolve(i.responseXML)},blob:function(){return Promise.resolve(new Blob([i.response]))},headers:{keys:function(){return t},entries:function(){return r},get:function(e){return n[e.toLowerCase()]},has:function(e){return e.toLowerCase()in n}}}}i.withCredentials="include"==t.credentials,i.onload=function(){r(o())},i.onerror=n,i.send(t.body)})};t.a=n},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,r){var n=r(360),i=r(40);e.exports=function(e){return null==e?[]:n(e,i(e))}},,,function(e,t,r){var n=r(78),i=r(157),a=r(119);e.exports=function(e,t){return a(i(e,t,n),e+"")}},,,,function(e,t,r){var n=r(65),i=r(271),a=r(272),o="[object Null]",s="[object Undefined]",l=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?s:o:l&&l in Object(e)?i(e):a(e)}},function(e,t,r){var n=r(279),i=r(282);e.exports=function(e,t){var r=i(e,t);return n(r)?r:void 0}},function(e,t,r){var n=r(27),i=r(120);e.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},function(e,t,r){var n=r(129),i=r(130);e.exports=function(e,t,r,a){var o=!r;r||(r={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=a?a(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),o?i(r,u,c):n(r,u,c)}return r}},function(e,t,r){var n=r(364),i=r(372),a=r(78),o=r(16),s=r(373);e.exports=function(e){return"function"==typeof e?e:null==e?a:"object"==typeof e?o(e)?i(e[0],e[1]):n(e):s(e)}},,,,function(e,t,r){var n=r(37).Symbol;e.exports=n},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,r){var n=r(87),i=1/0;e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}},function(e,t,r){var n=r(300);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},function(e,t){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,r){var n=r(161),i=r(334),a=r(59);e.exports=function(e){return a(e)?n(e,!0):i(e)}},function(e,t,r){var n=r(163),i=r(99),a=r(80),o=r(16),s=r(59),l=r(81),u=r(94),c=r(93),d="[object Map]",f="[object Set]",h=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(o(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||c(e)||a(e)))return!e.length;var t=i(e);if(t==d||t==f)return!e.size;if(u(e))return!n(e).length;for(var r in e)if(h.call(e,r))return!1;return!0}},function(e,t){e.exports=function(){var e,t,r=[],n=Array.prototype.slice.call(arguments),i=n.length,a=0;if(!i)throw new Error("zip requires at least one argument");for(e=0;e<i;e++){if(!Array.isArray(n[e]))throw new Error("all arguments must be arrays");var o=n[e].length;o>a&&(a=o)}for(e=0;e<a;e++){var s=[];for(t=0;t<i;t++){if(!Array.isArray(n[t]))throw new Error("all arguments must be arrays");s[t]=n[t][e]}r[e]=s}return r}},function(e,t,r){var n=r(79),i=r(358),a=r(53),o=r(359),s=a(function(e){return e.push(void 0,o),n(i,void 0,e)});e.exports=s},function(e,t,r){e.exports=r(383)},function(e,t,r){!function(t){"use strict";function r(e){return!isNaN(parseFloat(e))&&isFinite(e)}t.timing=t.timing||{getTimes:function(e){var n=t.performance||t.webkitPerformance||t.msPerformance||t.mozPerformance;if(void 0===n)return!1;var i=n.timing,a={};if(e=e||{},i){if(e&&!e.simple)for(var o in i)r(i[o])&&(a[o]=parseFloat(i[o]));if(void 0===a.firstPaint){var s=0;t.chrome&&t.chrome.loadTimes?(s=1e3*t.chrome.loadTimes().firstPaintTime,a.firstPaintTime=s-1e3*t.chrome.loadTimes().startLoadTime):"number"==typeof t.performance.timing.msFirstPaint&&(s=t.performance.timing.msFirstPaint,a.firstPaintTime=s-t.performance.timing.navigationStart),e&&!e.simple&&(a.firstPaint=s)}a.loadTime=i.loadEventEnd-i.fetchStart,a.domReadyTime=i.domComplete-i.domInteractive,a.readyStart=i.fetchStart-i.navigationStart,a.redirectTime=i.redirectEnd-i.redirectStart,a.appcacheTime=i.domainLookupStart-i.fetchStart,a.unloadEventTime=i.unloadEventEnd-i.unloadEventStart,a.lookupDomainTime=i.domainLookupEnd-i.domainLookupStart,a.connectTime=i.connectEnd-i.connectStart,a.requestTime=i.responseEnd-i.requestStart,a.initDomTreeTime=i.domInteractive-i.responseEnd,a.loadEventTime=i.loadEventEnd-i.loadEventStart}return a},printTable:function(e){var t={},r=this.getTimes(e)||{};Object.keys(r).sort().forEach(function(e){t[e]={ms:r[e],s:+(r[e]/1e3).toFixed(2)}}),console.table(t)},printSimpleTable:function(){this.printTable({simple:!0})}},e.exports&&(e.exports=t.timing)}("undefined"!=typeof window?window:{})},function(e,t,r){var n=r(16),i=r(116),a=r(273),o=r(155);e.exports=function(e,t){return n(e)?e:i(e,t)?[e]:a(o(e))}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}},function(e,t){e.exports=function(e){return e}},function(e,t){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},function(e,t,r){var n=r(302),i=r(49),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return i(e)&&o.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},function(e,t,r){(function(e){var n=r(37),i=r(303),a=t&&!t.nodeType&&t,o=a&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===a?n.Buffer:void 0,l=(s?s.isBuffer:void 0)||i;e.exports=l}).call(this,r(92)(e))},function(e,t){var r="__lodash_placeholder__";e.exports=function(e,t){for(var n=-1,i=e.length,a=0,o=[];++n<i;){var s=e[n];s!==t&&s!==r||(e[n]=r,o[a++]=n)}return o}},,function(e,t,r){var n=r(23),i=r(357),a=r(160),o="Expected a function",s=Math.max,l=Math.min;e.exports=function(e,t,r){var u,c,d,f,h,p,v=0,g=!1,y=!1,m=!0;if("function"!=typeof e)throw new TypeError(o);function b(t){var r=u,n=c;return u=c=void 0,v=t,f=e.apply(n,r)}function _(e){var r=e-p;return void 0===p||r>=t||r<0||y&&e-v>=d}function E(){var e=i();if(_(e))return k(e);h=setTimeout(E,function(e){var r=t-(e-p);return y?l(r,d-(e-v)):r}(e))}function k(e){return h=void 0,m&&u?b(e):(u=c=void 0,f)}function w(){var e=i(),r=_(e);if(u=arguments,c=this,p=e,r){if(void 0===h)return function(e){return v=e,h=setTimeout(E,t),g?b(e):f}(p);if(y)return h=setTimeout(E,t),b(p)}return void 0===h&&(h=setTimeout(E,t)),f}return t=a(t)||0,n(r)&&(g=!!r.leading,d=(y="maxWait"in r)?s(a(r.maxWait)||0,t):d,m="trailing"in r?!!r.trailing:m),w.cancel=function(){void 0!==h&&clearTimeout(h),v=0,u=p=c=h=void 0},w.flush=function(){return void 0===h?f:k(i())},w}},function(e,t,r){var n=r(347),i=r(156),a=r(68),o=r(155);e.exports=function(e,t,r){return e=o(e),r=null==r?0:n(a(r),0,e.length),t=i(t),e.slice(r,r+t.length)==t}},function(e,t,r){var n=r(76),i=r(67);e.exports=function(e,t){for(var r=0,a=(t=n(t,e)).length;null!=e&&r<a;)e=e[i(t[r++])];return r&&r==a?e:void 0}},function(e,t,r){var n=r(57),i=r(49),a="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||i(e)&&n(e)==a}},function(e,t,r){var n=r(58)(Object,"create");e.exports=n},function(e,t,r){var n=r(287),i=r(288),a=r(289),o=r(290),s=r(291);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},function(e,t,r){var n=r(66);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},function(e,t,r){var n=r(293);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},,function(e,t,r){var n=r(304),i=r(162),a=r(305),o=a&&a.isTypedArray,s=o?i(o):n;e.exports=s},function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t,r){var n=r(96),i=r(23);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=n(e.prototype),a=e.apply(r,t);return i(a)?a:r}}},function(e,t,r){var n=r(23),i=Object.create,a=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=a},function(e,t){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,r){var n=r(324),i=r(118),a=r(325),o=r(182),s=r(172),l=r(57),u=r(154),c=u(n),d=u(i),f=u(a),h=u(o),p=u(s),v=l;(n&&"[object DataView]"!=v(new n(new ArrayBuffer(1)))||i&&"[object Map]"!=v(new i)||a&&"[object Promise]"!=v(a.resolve())||o&&"[object Set]"!=v(new o)||s&&"[object WeakMap]"!=v(new s))&&(v=function(e){var t=l(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case c:return"[object DataView]";case d:return"[object Map]";case f:return"[object Promise]";case h:return"[object Set]";case p:return"[object WeakMap]"}return t}),e.exports=v},function(e,t,r){var n=r(89),i=r(327),a=r(328),o=r(329),s=r(330),l=r(331);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=s,u.prototype.set=l,e.exports=u},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},function(e,t,r){var n=r(66),i=r(59),a=r(69),o=r(23);e.exports=function(e,t,r){if(!o(r))return!1;var s=typeof t;return!!("number"==s?i(r)&&a(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},function(e,t,r){var n=r(53),i=r(102);e.exports=function(e){return n(function(t,r){var n=-1,a=r.length,o=a>1?r[a-1]:void 0,s=a>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(a--,o):void 0,s&&i(r[0],r[1],s)&&(o=a<3?void 0:o,a=1),t=Object(t);++n<a;){var l=r[n];l&&e(t,l,n,o)}return t})}},function(e,t,r){var n=r(166),i=r(377)(n);e.exports=i},,function(e,t){e.exports=function(e){return null==e}},function(e,t,r){var n=r(348)("jsonp");e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={});t||(t={});var o,s,l=t.prefix||"__jp",u=t.name||l+i++,c=t.param||"callback",d=null!=t.timeout?t.timeout:6e4,f=encodeURIComponent,h=document.getElementsByTagName("script")[0]||document.head;d&&(s=setTimeout(function(){p(),r&&r(new Error("Timeout"))},d));function p(){o.parentNode&&o.parentNode.removeChild(o),window[u]=a,s&&clearTimeout(s)}return window[u]=function(e){n("jsonp got",e),p(),r&&r(null,e)},e=(e+=(~e.indexOf("?")?"&":"?")+c+"="+f(u)).replace("?&","?"),n('jsonp req "%s"',e),(o=document.createElement("script")).src=e,h.parentNode.insertBefore(o,h),function(){window[u]&&p()}};var i=0;function a(){}},function(e,t,r){var n=r(351),i=r(198)(function(e,t){return null==e?{}:n(e,t)});e.exports=i},function(e,t,r){var n=r(128),i=r(59),a=r(14),o=r(68),s=r(50),l=Math.max;e.exports=function(e,t,r,u){e=i(e)?e:s(e),r=r&&!u?o(r):0;var c=e.length;return r<0&&(r=l(c+r,0)),a(e)?r<=c&&e.indexOf(t,r)>-1:!!c&&n(e,t,r)>-1}},function(e,t,r){var n=r(362);n.Template=r(363).Template,n.template=n.Template,e.exports=n},function(e,t,r){var n=r(200),i=r(61),a=r(376),o=r(16),s=r(102);e.exports=function(e,t,r){var l=o(e)?n:a;return r&&s(e,t,r)&&(t=void 0),l(e,i(t,3))}},function(e,t,r){var n=r(138);e.exports=function(e,t){return n(e,t)}},function(e,t,r){var n=r(53),i=r(169),a=r(98),o=r(82),s=n(function(e,t){var r=o(t,a(s));return i(e,64,void 0,t,r)});s.placeholder={},e.exports=s},function(e,t,r){"use strict";(function(t){var n=r(453),i="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},a=i.Raven,o=new n;o.noConflict=function(){return i.Raven=a,o},o.afterLoad(),e.exports=o}).call(this,r(51))},,function(e,t,r){var n=r(16),i=r(87),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!i(e))||o.test(e)||!a.test(e)||null!=t&&e in Object(t)}},function(e,t,r){var n=r(276),i=r(292),a=r(294),o=r(295),s=r(296);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},function(e,t,r){var n=r(58)(r(37),"Map");e.exports=n},function(e,t,r){var n=r(299),i=r(159)(n);e.exports=i},function(e,t){var r=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},function(e,t,r){var n=r(164)(Object.getPrototypeOf,Object);e.exports=n},function(e,t,r){var n=r(96),i=r(123),a=4294967295;function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=a,this.__views__=[]}o.prototype=n(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(){}},function(e,t,r){var n=r(171),i=r(178),a=n?function(e){return n.get(e)}:i;e.exports=a},function(e,t,r){var n=r(96),i=r(123);function a(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}a.prototype=n(i.prototype),a.prototype.constructor=a,e.exports=a},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},function(e,t,r){var n=r(128);e.exports=function(e,t){return!(null==e||!e.length)&&n(e,t,0)>-1}},function(e,t,r){var n=r(318),i=r(319),a=r(320);e.exports=function(e,t,r){return t==t?a(e,t,r):n(e,i,r)}},function(e,t,r){var n=r(130),i=r(66),a=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var o=e[t];a.call(e,t)&&i(o,r)&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t,r){var n=r(158);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},function(e,t,r){var n=r(184),i=r(185),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,s=o?function(e){return null==e?[]:(e=Object(e),n(o(e),function(t){return a.call(e,t)}))}:i;e.exports=s},function(e,t){e.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},function(e,t,r){var n=r(190);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},function(e,t,r){var n=r(132),i=r(353);e.exports=function e(t,r,a,o,s){var l=-1,u=t.length;for(a||(a=i),s||(s=[]);++l<u;){var c=t[l];r>0&&a(c)?r>1?e(c,r-1,a,o,s):n(s,c):o||(s[s.length]=c)}return s}},function(e,t,r){var n=r(100),i=r(199),a=r(167),o=r(355),s=r(23),l=r(70);e.exports=function e(t,r,u,c,d){t!==r&&a(r,function(a,l){if(s(a))d||(d=new n),o(t,r,l,u,e,c,d);else{var f=c?c(t[l],a,l+"",t,r,d):void 0;void 0===f&&(f=a),i(t,l,f)}},l)}},function(e,t,r){var n=r(59),i=r(49);e.exports=function(e){return i(e)&&n(e)}},function(e,t,r){var n=r(366),i=r(49);e.exports=function e(t,r,a,o,s){return t===r||(null==t||null==r||!i(t)&&!i(r)?t!=t&&r!=r:n(t,r,a,o,e,s))}},function(e,t,r){var n=r(117),i=r(367),a=r(368);function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=a,e.exports=o},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},,function(e,t,r){var n=r(135);e.exports=function(e){return null!=e&&e.length?n(e,1):[]}},function(e,t,r){var n=r(136),i=r(103)(function(e,t,r,i){n(e,t,r,i)});e.exports=i},,,,function(e,t,r){var n=r(68),i="Expected a function";e.exports=function(e,t){if("function"!=typeof t)throw new TypeError(i);return e=n(e),function(){if(--e<1)return t.apply(this,arguments)}}},function(e,t,r){var n,i,a;i=[r(31)],void 0===(a="function"==typeof(n=function(e){var t,r,n;function i(e,t){if(e.indexOf)return e.indexOf(t);for(var r=e.length;r--;)if(e[r]===t)return r;return-1}function a(e,t){var r=i(e,t);-1!==r&&e.splice(r,1)}function o(e,t){return"[object "+t+"]"===Object.prototype.toString.call(e)}function s(e){return o(e,"RegExp")}function l(e){return o(e,"Array")}function u(e){return"function"==typeof e}function c(e){return null===e||"null"===e?null:"true"===e||"false"!==e&&(e===n||"undefined"===e?n:""===e||isNaN(e)?e:parseFloat(e))}function d(e,t){for(var r,n,i,a,o=(e||"").replace("?","").split("&"),s=-1,u={};n=o[++s];)r=n.indexOf("="),a=n.substring(0,r),i=decodeURIComponent(n.substring(r+1)),!1!==t&&(i=c(i)),a in u?l(u[a])?u[a].push(i):u[a]=[u[a],i]:u[a]=i;return u}function f(){this.bypassed=new e.Signal,this.routed=new e.Signal,this._routes=[],this._prevRoutes=[],this._piped=[],this.resetState()}function h(t,r,n,i){var a=s(t),o=i.patternLexer;this._router=i,this._pattern=t,this._paramsIds=a?null:o.getParamIds(t),this._optionalParamsIds=a?null:o.getOptionalParamsIds(t),this._matchRegexp=a?t:o.compilePattern(t,i.ignoreCase),this.matched=new e.Signal,this.switched=new e.Signal,r&&this.matched.add(r),this._priority=n||0}return r=""===/t(.+)?/.exec("t")[1],f.prototype={greedy:!1,greedyEnabled:!0,ignoreCase:!0,ignoreState:!1,shouldTypecast:!1,normalizeFn:null,resetState:function(){this._prevRoutes.length=0,this._prevMatchedRequest=null,this._prevBypassedRequest=null},create:function(){return new f},addRoute:function(e,t,r){var n=new h(e,t,r,this);return this._sortedInsert(n),n},removeRoute:function(e){a(this._routes,e),e._destroy()},removeAllRoutes:function(){for(var e=this.getNumRoutes();e--;)this._routes[e]._destroy();this._routes.length=0},parse:function(e,t){if(e=e||"",t=t||[],this.ignoreState||e!==this._prevMatchedRequest&&e!==this._prevBypassedRequest){var r,n=this._getMatchedRoutes(e),i=0,a=n.length;if(a)for(this._prevMatchedRequest=e,this._notifyPrevRoutes(n,e),this._prevRoutes=n;i<a;)(r=n[i]).route.matched.dispatch.apply(r.route.matched,t.concat(r.params)),r.isFirst=!i,this.routed.dispatch.apply(this.routed,t.concat([e,r])),i+=1;else this._prevBypassedRequest=e,this.bypassed.dispatch.apply(this.bypassed,t.concat([e]));this._pipeParse(e,t)}},_notifyPrevRoutes:function(e,t){for(var r,n=0;r=this._prevRoutes[n++];)r.route.switched&&this._didSwitch(r.route,e)&&r.route.switched.dispatch(t)},_didSwitch:function(e,t){for(var r,n=0;r=t[n++];)if(r.route===e)return!1;return!0},_pipeParse:function(e,t){for(var r,n=0;r=this._piped[n++];)r.parse(e,t)},getNumRoutes:function(){return this._routes.length},_sortedInsert:function(e){var t=this._routes,r=t.length;do{--r}while(t[r]&&e._priority<=t[r]._priority);t.splice(r+1,0,e)},_getMatchedRoutes:function(e){for(var t,r=[],n=this._routes,i=n.length;(t=n[--i])&&((!r.length||this.greedy||t.greedy)&&t.match(e)&&r.push({route:t,params:t._getParamsArray(e)}),this.greedyEnabled||!r.length););return r},pipe:function(e){this._piped.push(e)},unpipe:function(e){a(this._piped,e)},toString:function(){return"[crossroads numRoutes:"+this.getNumRoutes()+"]"}},(t=new f).VERSION="0.12.2",t.NORM_AS_ARRAY=function(e,t){return[t.vals_]},t.NORM_AS_OBJECT=function(e,t){return[t]},h.prototype={greedy:!1,rules:void 0,match:function(e){return e=e||"",this._matchRegexp.test(e)&&this._validateParams(e)},_validateParams:function(e){var t,r=this.rules,n=this._getParamsObject(e);for(t in r)if("normalize_"!==t&&r.hasOwnProperty(t)&&!this._isValidParam(e,t,n))return!1;return!0},_isValidParam:function(e,t,r){var n=this.rules[t],a=r[t],o=!1,c=0===t.indexOf("?");return null==a&&this._optionalParamsIds&&-1!==i(this._optionalParamsIds,t)?o=!0:s(n)?(c&&(a=r[t+"_"]),o=n.test(a)):l(n)?(c&&(a=r[t+"_"]),o=this._isValidArrayRule(n,a)):u(n)&&(o=n(a,e,r)),o},_isValidArrayRule:function(e,t){if(!this._router.ignoreCase)return-1!==i(e,t);"string"==typeof t&&(t=t.toLowerCase());for(var r,n=e.length;n--;)if(("string"==typeof(r=e[n])?r.toLowerCase():r)===t)return!0;return!1},_getParamsObject:function(e){for(var t,n,a=this._router.shouldTypecast,o=this._router.patternLexer.getParamValues(e,this._matchRegexp,a),s={},l=o.length;l--;)n=o[l],this._paramsIds&&(0===(t=this._paramsIds[l]).indexOf("?")&&n&&(s[t+"_"]=n,n=d(n,a),o[l]=n),r&&""===n&&-1!==i(this._optionalParamsIds,t)&&(n=void 0,o[l]=n),s[t]=n),s[l]=n;return s.request_=a?c(e):e,s.vals_=o,s},_getParamsArray:function(e){var t=this.rules?this.rules.normalize_:null;return(t=t||this._router.normalizeFn)&&u(t)?t(e,this._getParamsObject(e)):this._getParamsObject(e).vals_},interpolate:function(e){var t=this._router.patternLexer.interpolate(this._pattern,e);if(!this._validateParams(t))throw new Error("Generated string doesn't validate against `Route.rules`.");return t},dispose:function(){this._router.removeRoute(this)},_destroy:function(){this.matched.dispose(),this.switched.dispose(),this.matched=this.switched=this._pattern=this._matchRegexp=null},toString:function(){return'[Route pattern:"'+this._pattern+'", numListeners:'+this.matched.getNumListeners()+"]"}},f.prototype.patternLexer=function(){var e=/[\\.+*?\^$\[\](){}\/'#]/g,t=/^\/|\/$/g,r=/\/$/g,n=/(?:\{|:)([^}:]+)(?:\}|:)/g,i={OS:{rgx:/([:}]|\w(?=\/))\/?(:|(?:\{\?))/g,save:"$1{{id}}$2",res:"\\/?"},RS:{rgx:/([:}])\/?(\{)/g,save:"$1{{id}}$2",res:"\\/"},RQ:{rgx:/\{\?([^}]+)\}/g,res:"\\?([^#]+)"},OQ:{rgx:/:\?([^:]+):/g,res:"(?:\\?([^#]*))?"},OR:{rgx:/:([^:]+)\*:/g,res:"(.*)?"},RR:{rgx:/\{([^}]+)\*\}/g,res:"(.+)"},RP:{rgx:/\{([^}]+)\}/g,res:"([^\\/?]+)"},OP:{rgx:/:([^:]+):/g,res:"([^\\/?]+)?/?"}},a=1,o=2,s=3,u=a;function d(e,t){var r,n=[];for(e.lastIndex=0;r=e.exec(t);)n.push(r[1]);return n}function f(e,t,r){var n,a;for(a in i)i.hasOwnProperty(a)&&(n=i[a],e=e.replace(n[t],n[r]));return e}return function(){var e,t;for(e in i)i.hasOwnProperty(e)&&((t=i[e]).id="__CR_"+e+"__",t.save="save"in t?t.save.replace("{{id}}",t.id):t.id,t.rRestore=new RegExp(t.id,"g"))}(),{strict:function(){u=o},loose:function(){u=a},legacy:function(){u=s},getParamIds:function(e){return d(n,e)},getOptionalParamsIds:function(e){return d(i.OP.rgx,e)},getParamValues:function(e,t,r){var n=t.exec(e);return n&&(n.shift(),r&&(n=function(e){for(var t=e.length,r=[];t--;)r[t]=c(e[t]);return r}(n))),n},compilePattern:function(n,i){return(n=n||"")&&(u===a?n=n.replace(t,""):u===s&&(n=n.replace(r,"")),n=f(n=(n=f(n,"rgx","save")).replace(e,"\\$&"),"rRestore","res"),u===a&&(n="\\/?"+n)),u!==o&&(n+="\\/?"),new RegExp("^"+n+"$",i?"i":"")},interpolate:function(e,t){if(t=t||{},"string"!=typeof e)throw new Error("Route pattern should be a string.");return i.OS.trail||(i.OS.trail=new RegExp("(?:"+i.OS.id+")+$")),e.replace(i.OS.rgx,i.OS.save).replace(n,function(e,r){var n;if(r="?"===r.substr(0,1)?r.substr(1):r,null!=t[r]){if("object"==typeof t[r]){var i,a=[];for(var o in t[r])if(l(i=t[r][o]))for(var s in i)"[]"==o.slice(-2)?a.push(encodeURI(o.slice(0,-2))+"[]="+encodeURI(i[s])):a.push(encodeURI(o+"="+i[s]));else a.push(encodeURI(o+"="+i));n="?"+a.join("&")}else n=String(t[r]);if(-1===e.indexOf("*")&&-1!==n.indexOf("/"))throw new Error('Invalid value "'+n+'" for segment "'+e+'".')}else{if(-1!==e.indexOf("{"))throw new Error("The segment "+e+" is required.");n=""}return n}).replace(i.OS.trail,"").replace(i.OS.rRestore,"/")}}}(),t})?n.apply(t,i):n)||(e.exports=a)},function(e,t,r){var n=r(381),i=r(382),a=r(61),o=r(16),s=r(102);e.exports=function(e,t,r){var l=o(e)?n:i;return r&&s(e,t,r)&&(t=void 0),l(e,a(t,3))}},function(e,t,r){var n=r(414),i=r(135),a=r(61),o=r(53),s=r(137),l=r(141),u=o(function(e,t){var r=l(t);return s(r)&&(r=void 0),s(e)?n(e,i(t,1,s,!0),a(r,2)):[]});e.exports=u},,function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(51))},function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,r){var n=r(156);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(65),i=r(77),a=r(16),o=r(87),s=1/0,l=n?n.prototype:void 0,u=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(a(t))return i(t,e)+"";if(o(t))return u?u.call(t):"";var r=t+"";return"0"==r&&1/t==-s?"-0":r}},function(e,t,r){var n=r(79),i=Math.max;e.exports=function(e,t,r){return t=i(void 0===t?e.length-1:t,0),function(){for(var a=arguments,o=-1,s=i(a.length-t,0),l=Array(s);++o<s;)l[o]=a[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=a[o];return u[t]=r(l),n(e,this,u)}}},function(e,t,r){var n=r(58),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t){var r=800,n=16,i=Date.now;e.exports=function(e){var t=0,a=0;return function(){var o=i(),s=n-(o-a);if(a=o,s>0){if(++t>=r)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,r){var n=r(23),i=r(87),a=NaN,o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return a;if(n(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=n(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var r=l.test(e);return r||u.test(e)?c(e.slice(2),r?2:8):s.test(e)?a:+e}},function(e,t,r){var n=r(301),i=r(80),a=r(16),o=r(81),s=r(69),l=r(93),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=a(e),c=!r&&i(e),d=!r&&!c&&o(e),f=!r&&!c&&!d&&l(e),h=r||c||d||f,p=h?n(e.length,String):[],v=p.length;for(var g in e)!t&&!u.call(e,g)||h&&("length"==g||d&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,v))||p.push(g);return p}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,r){var n=r(94),i=r(306),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))a.call(e,r)&&"constructor"!=r&&t.push(r);return t}},function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},function(e,t,r){var n=r(76),i=r(80),a=r(16),o=r(69),s=r(120),l=r(67);e.exports=function(e,t,r){for(var u=-1,c=(t=n(t,e)).length,d=!1;++u<c;){var f=l(t[u]);if(!(d=null!=e&&r(e,f)))break;e=e[f]}return d||++u!=c?d:!!(c=null==e?0:e.length)&&s(c)&&o(f,c)&&(a(e)||i(e))}},function(e,t,r){var n=r(167),i=r(40);e.exports=function(e,t){return e&&n(e,t,i)}},function(e,t,r){var n=r(308)();e.exports=n},function(e,t,r){var n=r(78);e.exports=function(e){return"function"==typeof e?e:n}},function(e,t,r){var n=r(170),i=r(309),a=r(310),o=r(173),s=r(322),l=r(124),u=r(323),c=r(180),d=r(181),f=r(68),h="Expected a function",p=1,v=2,g=8,y=16,m=32,b=64,_=Math.max;e.exports=function(e,t,r,E,k,w,T,S){var A=t&v;if(!A&&"function"!=typeof e)throw new TypeError(h);var R=E?E.length:0;if(R||(t&=~(m|b),E=k=void 0),T=void 0===T?T:_(f(T),0),S=void 0===S?S:f(S),R-=k?k.length:0,t&b){var x=E,L=k;E=k=void 0}var O=A?void 0:l(e),D=[e,t,r,E,k,x,L,w,T,S];if(O&&u(D,O),e=D[0],t=D[1],r=D[2],E=D[3],k=D[4],!(S=D[9]=void 0===D[9]?A?0:e.length:_(D[9]-R,0))&&t&(g|y)&&(t&=~(g|y)),t&&t!=p)P=t==g||t==y?a(e,t,S):t!=m&&t!=(p|m)||k.length?o.apply(void 0,D):s(e,t,r,E);else var P=i(e,t,r);return d((O?n:c)(P,D),e,t)}},function(e,t,r){var n=r(78),i=r(171),a=i?function(e,t){return i.set(e,t),e}:n;e.exports=a},function(e,t,r){var n=r(172),i=n&&new n;e.exports=i},function(e,t,r){var n=r(58)(r(37),"WeakMap");e.exports=n},function(e,t,r){var n=r(174),i=r(175),a=r(311),o=r(95),s=r(176),l=r(98),u=r(321),c=r(82),d=r(37),f=1,h=2,p=8,v=16,g=128,y=512;e.exports=function e(t,r,m,b,_,E,k,w,T,S){var A=r&g,R=r&f,x=r&h,L=r&(p|v),O=r&y,D=x?void 0:o(t);return function f(){for(var h=arguments.length,p=Array(h),v=h;v--;)p[v]=arguments[v];if(L)var g=l(f),y=a(p,g);if(b&&(p=n(p,b,_,L)),E&&(p=i(p,E,k,L)),h-=y,L&&h<S){var P=c(p,g);return s(t,r,e,f.placeholder,m,p,P,w,T,S-h)}var I=R?m:this,C=x?I[t]:t;return h=p.length,w?p=u(p,w):O&&h>1&&p.reverse(),A&&T<h&&(p.length=T),this&&this!==d&&this instanceof f&&(C=D||o(C)),C.apply(I,p)}}},function(e,t){var r=Math.max;e.exports=function(e,t,n,i){for(var a=-1,o=e.length,s=n.length,l=-1,u=t.length,c=r(o-s,0),d=Array(u+c),f=!i;++l<u;)d[l]=t[l];for(;++a<s;)(f||a<o)&&(d[n[a]]=e[a]);for(;c--;)d[l++]=e[a++];return d}},function(e,t){var r=Math.max;e.exports=function(e,t,n,i){for(var a=-1,o=e.length,s=-1,l=n.length,u=-1,c=t.length,d=r(o-l,0),f=Array(d+c),h=!i;++a<d;)f[a]=e[a];for(var p=a;++u<c;)f[p+u]=t[u];for(;++s<l;)(h||a<o)&&(f[p+n[s]]=e[a++]);return f}},function(e,t,r){var n=r(177),i=r(180),a=r(181),o=1,s=2,l=4,u=8,c=32,d=64;e.exports=function(e,t,r,f,h,p,v,g,y,m){var b=t&u;t|=b?c:d,(t&=~(b?d:c))&l||(t&=~(o|s));var _=[e,t,h,b?p:void 0,b?v:void 0,b?void 0:p,b?void 0:v,g,y,m],E=r.apply(void 0,_);return n(e)&&i(E,_),E.placeholder=f,a(E,e,t)}},function(e,t,r){var n=r(122),i=r(124),a=r(179),o=r(313);e.exports=function(e){var t=a(e),r=o[t];if("function"!=typeof r||!(t in n.prototype))return!1;if(e===r)return!0;var s=i(r);return!!s&&e===s[0]}},function(e,t){e.exports=function(){}},function(e,t,r){var n=r(312),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",r=n[t],a=i.call(n,t)?r.length:0;a--;){var o=r[a],s=o.func;if(null==s||s==e)return o.name}return t}},function(e,t,r){var n=r(170),i=r(159)(n);e.exports=i},function(e,t,r){var n=r(315),i=r(316),a=r(119),o=r(317);e.exports=function(e,t,r){var s=t+"";return a(e,i(s,o(n(s),r)))}},function(e,t,r){var n=r(58)(r(37),"Set");e.exports=n},function(e,t,r){(function(e){var n=r(37),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i?n.Buffer:void 0,s=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}).call(this,r(92)(e))},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,a=[];++r<n;){var o=e[r];t(o,r,e)&&(a[i++]=o)}return a}},function(e,t){e.exports=function(){return[]}},function(e,t,r){var n=r(132),i=r(121),a=r(131),o=r(185),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,a(e)),e=i(e);return t}:o;e.exports=s},function(e,t,r){var n=r(188),i=r(131),a=r(40);e.exports=function(e){return n(e,a,i)}},function(e,t,r){var n=r(132),i=r(16);e.exports=function(e,t,r){var a=t(e);return i(e)?a:n(a,r(e))}},function(e,t,r){var n=r(188),i=r(186),a=r(70);e.exports=function(e){return n(e,a,i)}},function(e,t,r){var n=r(37).Uint8Array;e.exports=n},function(e,t){e.exports=function(e,t,r,n){var i=-1,a=null==e?0:e.length;for(n&&a&&(r=e[++i]);++i<a;)r=t(r,e[i],i,e);return r}},function(e,t,r){var n=r(133);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},function(e,t,r){var n=r(96),i=r(121),a=r(94);e.exports=function(e){return"function"!=typeof e.constructor||a(e)?{}:n(i(e))}},function(e,t){e.exports=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(i);++n<i;)a[n]=e[n+t];return a}},function(e,t,r){var n=r(86),i=r(196),a=r(76);e.exports=function(e,t,r){for(var o=-1,s=t.length,l={};++o<s;){var u=t[o],c=n(e,u);r(c,u)&&i(l,a(u,e),c)}return l}},function(e,t,r){var n=r(129),i=r(76),a=r(69),o=r(23),s=r(67);e.exports=function(e,t,r,l){if(!o(e))return e;for(var u=-1,c=(t=i(t,e)).length,d=c-1,f=e;null!=f&&++u<c;){var h=s(t[u]),p=r;if(u!=d){var v=f[h];void 0===(p=l?l(v,h,f):void 0)&&(p=o(v)?v:a(t[u+1])?[]:{})}n(f,h,p),f=f[h]}return e}},function(e,t,r){var n=r(352),i=r(165);e.exports=function(e,t){return null!=e&&i(e,t,n)}},function(e,t,r){var n=r(143),i=r(157),a=r(119);e.exports=function(e){return a(i(e,void 0,n),e+"")}},function(e,t,r){var n=r(130),i=r(66);e.exports=function(e,t,r){(void 0===r||i(e[t],r))&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},function(e,t,r){var n=r(139),i=r(200),a=r(140),o=1,s=2;e.exports=function(e,t,r,l,u,c){var d=r&o,f=e.length,h=t.length;if(f!=h&&!(d&&h>f))return!1;var p=c.get(e);if(p&&c.get(t))return p==t;var v=-1,g=!0,y=r&s?new n:void 0;for(c.set(e,t),c.set(t,e);++v<f;){var m=e[v],b=t[v];if(l)var _=d?l(b,m,v,t,e,c):l(m,b,v,e,t,c);if(void 0!==_){if(_)continue;g=!1;break}if(y){if(!i(t,function(e,t){if(!a(y,t)&&(m===e||u(m,e,r,l,c)))return y.push(t)})){g=!1;break}}else if(m!==b&&!u(m,b,r,l,c)){g=!1;break}}return c.delete(e),c.delete(t),g}},function(e,t,r){var n=r(23);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}},function(e,t,r){var n=r(139),i=r(127),a=r(205),o=r(140),s=r(384),l=r(101),u=200;e.exports=function(e,t,r){var c=-1,d=i,f=e.length,h=!0,p=[],v=p;if(r)h=!1,d=a;else if(f>=u){var g=t?null:s(e);if(g)return l(g);h=!1,d=o,v=new n}else v=t?[]:p;e:for(;++c<f;){var y=e[c],m=t?t(y):y;if(y=r||0!==y?y:0,h&&m==m){for(var b=v.length;b--;)if(v[b]===m)continue e;t&&v.push(m),p.push(y)}else d(v,m,r)||(v!==p&&v.push(m),p.push(y))}return p}},function(e,t){e.exports=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}},,function(e,t,r){var n=r(419);e.exports=function(e){var t=e.length;return t?e[n(0,t-1)]:void 0}},,,,,function(e,t,r){"use strict";e.exports={isObject:function(e){return"object"==typeof e&&null!==e},isError:function(e){switch({}.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}},wrappedCallback:function(e){return function(t,r){var n=e(t)||t;return r&&r(n)||n}}}},,function(e,t,r){var n=r(298),i=r(53)(function(e,t){return n(e,1,t)});e.exports=i},function(e,t){e.exports=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n}},function(e,t,r){var n=r(166),i=r(168);e.exports=function(e,t){return e&&n(e,i(t))}},,function(e,t,r){var n=r(194),i=r(102),a=r(68);e.exports=function(e,t,r){var o=null==e?0:e.length;return o?(r&&"number"!=typeof r&&i(e,t,r)?(t=0,r=o):(t=null==t?0:a(t),r=void 0===r?o:a(r)),n(e,t,r)):[]}},function(e,t,r){var n=r(61),i=r(378);e.exports=function(e,t){var r=[];if(!e||!e.length)return r;var a=-1,o=[],s=e.length;for(t=n(t,3);++a<s;){var l=e[a];t(l,a,e)&&(r.push(l),o.push(a))}return i(e,o),r}},function(e,t,r){var n=r(204);e.exports=function(e){return e&&e.length?n(e):[]}},function(e,t,r){var n=r(128),i=r(68),a=Math.max;e.exports=function(e,t,r){var o=null==e?0:e.length;if(!o)return-1;var s=null==r?0:i(r);return s<0&&(s=a(o+s,0)),n(e,t,s)}},function(e,t,r){var n=r(135),i=r(61),a=r(53),o=r(204),s=r(137),l=r(141),u=a(function(e){var t=l(e);return s(t)&&(t=void 0),o(n(e,1,s,!0),i(t,2))});e.exports=u},function(e,t,r){var n=r(77),i=r(61),a=r(195),o=r(189);e.exports=function(e,t){if(null==e)return{};var r=n(o(e),function(e){return[e]});return t=i(t),a(e,r,function(e,r){return t(e,r[0])})}},function(e,t,r){var n=r(415)(r(40));e.exports=n},,function(e,t,r){var n=r(126),i=r(104),a=r(168),o=r(16);e.exports=function(e,t){return(o(e)?n:i)(e,a(t))}},,function(e,t,r){var n=r(207),i=r(420),a=r(16);e.exports=function(e){return(a(e)?n:i)(e)}},,,,,,,,function(e,t,r){var n=r(428)();e.exports=n},,,,,,,,,,,,function(e,t,r){var n=r(184),i=r(449),a=r(61),o=r(16);e.exports=function(e,t){return(o(e)?n:i)(e,a(t,3))}},,,,,,,,,,,,,,,,,,,function(e,t,r){var n;e.exports=function e(t,r,i){function a(s,l){if(!r[s]){if(!t[s]){var u="function"==typeof n&&n;if(!l&&u)return n(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};t[s][0].call(d.exports,function(e){var r=t[s][1][e];return a(r||e)},d,d.exports,e,t,r,i)}return r[s].exports}for(var o="function"==typeof n&&n,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(o(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(a(r))for(s=Array.prototype.slice.call(arguments,1),u=r.slice(),n=u.length,l=0;l<n;l++)u[l].apply(this,s);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(r=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){!function(e){var n=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/;?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var a=this.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=i.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(d)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};"object"==typeof r&&"object"==typeof t?t.exports=s:"object"==typeof r?r.URLToolkit=s:e.URLToolkit=s}(this)},{}],3:[function(e,t,r){var n=arguments[3],i=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var r,s=Object.keys(a),l=0,u=s.length;l<u;l++){var c=s[l],d=a[c].exports;if(d===e||d&&d.default===e){r=c;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var f={},l=0,u=s.length;l<u;l++){var c=s[l];f[c]=c}i[r]=[Function(["require","module","exports"],"("+e+")(self)"),f]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[r]=r,i[h]=[Function(["require"],"var f = require("+o(r)+");(f.default ? f.default : f)(self);"),p];var v={};!function e(t){for(var r in v[t]=!0,i[t][1]){var n=i[t][1][r];v[n]||e(n)}}(h);var g="("+n+")({"+Object.keys(v).map(function(e){return o(e)+":["+i[e][0]+","+o(i[e][1])+"]"}).join(",")+"},{},["+o(h)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,m=new Blob([g],{type:"text/javascript"});if(t&&t.bare)return m;var b=y.createObjectURL(m),_=new Worker(b);return _.objectURL=b,_}},{}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hlsDefaultConfig=void 0;var n=e(5),i=S(n),a=e(8),o=S(a),s=e(9),l=S(s),u=e(10),c=S(u),d=e(59),f=S(d),h=e(7),p=S(h),v=e(6),g=S(v),y=e(50),m=S(y),b=e(16),_=S(b),E=e(15),k=S(E),w=e(14),T=S(w);function S(e){return e&&e.__esModule?e:{default:e}}r.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:f.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:i.default,bufferController:o.default,capLevelController:l.default,fpsController:c.default,audioStreamController:g.default,audioTrackController:p.default,subtitleStreamController:T.default,subtitleTrackController:k.default,timelineController:_.default,cueHandler:m.default,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},{10:10,14:14,15:15,16:16,5:5,50:50,59:59,6:6,7:7,8:8,9:9}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=p(i),o=e(34),s=p(o),l=e(37),u=p(l),c=e(33),d=e(54),f=e(52),h=p(f);function p(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FRAG_LOADING,a.default.FRAG_LOADED,a.default.FRAG_BUFFERED,a.default.ERROR));return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.clearTimer(),s.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var r=this.hls,n=e.frag.level,i=r.levels[n].details.live,a=r.config,o=void 0,s=void 0;i?(o=a.abrEwmaFastLive,s=a.abrEwmaSlowLive):(o=a.abrEwmaFastVoD,s=a.abrEwmaSlowVoD),this._bwEstimator=new h.default(r,s,o,a.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"_abandonRulesCheck",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent,n=r.loader,i=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return d.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var o=n.stats;if(t&&o&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var s=performance.now()-o.trequest,l=Math.abs(t.playbackRate);if(s>500*r.duration/l){var c=e.levels,f=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/s),h=c[r.level],p=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,v=o.total?o.total:Math.max(o.loaded,Math.round(r.duration*p/8)),g=t.currentTime,y=(v-o.loaded)/f,m=(u.default.bufferInfo(t,g,e.config.maxBufferHole).end-g)/l;if(m<2*r.duration/l&&y>m){var b=void 0,_=void 0;for(_=r.level-1;_>i;_--){var E=c[_].realBitrate?Math.max(c[_].realBitrate,c[_].bitrate):c[_].bitrate;if((b=r.duration*E/(6.4*f))<m)break}b<y&&(d.logger.warn("loading too slow, abort fragment loading and switch to level "+_+":fragLoadedDelay["+_+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+y.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=_,this._bwEstimator.sample(s,o.loaded),n.abort(),this.clearTimer(),e.trigger(a.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:o}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],n=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,i=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:n,duration:i},r.realBitrate=Math.round(8*n/i)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}}},{key:"onFragBuffered",value:function(e){var t=e.stats,r=e.frag;if(!(!0===t.aborted||1!==r.loadCounter||"main"!==r.type||isNaN(r.sn)||r.bitrateTest&&t.tload!==t.tbuffered)){var n=t.tparsed-t.trequest;d.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(e,t,r,n,i,a,o,s,l){for(var u=i;u>=n;u--){var c=l[u],f=c.details,h=f?f.totalduration/f.fragments.length:t,p=!!f&&f.live,v=void 0;v=u<=e?o*r:s*r;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,y=g*h/v;if(d.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(v)+"/"+g+"/"+h+"/"+a+"/"+y),v>g&&(!y||p&&!this.bitrateTestDelay||y<a))return u}return-1}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,i=e.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,c=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,f=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(u.default.bufferInfo(a,l,n.maxBufferHole).end-l)/c,p=this._findBestLevel(o,s,f,i,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(p>=0)return p;d.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var v=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,y=n.abrBandWidthUpFactor;if(0===h){var m=this.bitrateTestDelay;if(m){var b=s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay;v=b-m,d.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*v)+" ms"),g=y=1}}return p=this._findBestLevel(o,s,f,i,t,h+v,g,y,r),Math.max(p,0)}}]),t}(s.default);r.default=v},{33:33,34:34,35:35,37:37,52:52,54:54}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(48),a=E(i),o=e(37),s=E(o),l=e(25),u=E(l),c=e(35),d=E(c),f=e(34),h=E(f),p=e(38),v=E(p),g=e(55),y=E(g),m=e(33),b=e(54),_=e(51);function E(e){return e&&e.__esModule?e:{default:e}}var k={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS"},w=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.AUDIO_TRACKS_UPDATED,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_LOADED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED,d.default.INIT_PTS_FOUND));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r._state=k.STOPPED,r.ontick=r.tick.bind(r),r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),h.default.prototype.destroy.call(this),this.state=k.STOPPED}},{key:"onInitPtsFound",value:function(e){var t=e.id,r=e.frag.cc,n=e.initPTS;"main"===t&&(this.initPTS[r]=n,this.videoTrackCC=r,b.logger.log("InitPTS for cc:"+r+" found from video track:"+n),this.state===k.WAITING_INIT_PTS&&this.tick())}},{key:"startLoad",value:function(e){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.fragLoadError=0,t>0&&-1===e?(b.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=k.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:e,this.state=k.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=e,this.state=k.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=k.STOPPED}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){var e,t,r,n=this.hls,i=n.config;switch(this.state){case k.ERROR:case k.PAUSED:case k.BUFFER_FLUSHING:break;case k.STARTING:this.state=k.WAITING_TRACK,this.loadedmetadata=!1;break;case k.IDLE:var o=this.tracks;if(!o)break;if(!this.media&&(this.startFragRequested||!i.startFragPrefetch))break;if(this.loadedmetadata)e=this.media.currentTime;else if(void 0===(e=this.nextLoadPosition))break;var l=this.mediaBuffer?this.mediaBuffer:this.media,u=s.default.bufferInfo(l,e,i.maxBufferHole),c=u.len,f=u.end,h=this.fragPrevious,p=i.maxMaxBufferLength,v=this.audioSwitch,g=this.trackId;if((c<p||v)&&g<o.length){if(void 0===(r=o[g].details)){this.state=k.WAITING_TRACK;break}if(!v&&!r.live&&h&&h.sn===r.endSN&&(!this.media.seeking||this.media.duration-f<h.duration/2)){this.hls.trigger(d.default.BUFFER_EOS,{type:"audio"}),this.state=k.ENDED;break}var y=r.fragments,E=y.length,w=y[0].start,T=y[E-1].start+y[E-1].duration,S=void 0;if(v)if(r.live&&!r.PTSKnown)b.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),f=0;else if(f=e,r.PTSKnown&&e<w){if(!(u.end>w||u.nextStart))return;b.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=w+.05}if(r.initSegment&&!r.initSegment.data)S=r.initSegment;else if(f<=w){if(S=y[0],null!==this.videoTrackCC&&S.cc!==this.videoTrackCC&&(S=(0,_.findFragWithCC)(y,this.videoTrackCC)),r.live&&S.loadIdx&&S.loadIdx===this.fragLoadIdx){var A=u.nextStart?u.nextStart:w;return b.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var R=void 0,x=i.maxFragLookUpTolerance,L=h?y[h.sn-y[0].sn+1]:void 0,O=function(e){var t=Math.min(x,e.duration);return e.start+e.duration-t<=f?1:e.start-t>f&&e.start?-1:0};f<T?(f>T-x&&(x=0),R=L&&!O(L)?L:a.default.search(y,O)):R=y[E-1],R&&(S=R,w=R.start,h&&S.level===h.level&&S.sn===h.sn&&(S.sn<r.endSN?(S=y[S.sn+1-r.startSN],b.logger.log("SN just loaded, load next one: "+S.sn)):S=null))}if(S)if(S.decryptdata&&null!=S.decryptdata.uri&&null==S.decryptdata.key)b.logger.log("Loading key for "+S.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+g),this.state=k.KEY_LOADING,n.trigger(d.default.KEY_LOADING,{frag:S});else{if(b.logger.log("Loading "+S.sn+", cc: "+S.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+g+", currentTime:"+e+",bufferEnd:"+f.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,S.loadCounter){S.loadCounter++;var D=i.fragLoadingLoopThreshold;if(S.loadCounter>D&&Math.abs(this.fragLoadIdx-S.loadIdx)<D)return void n.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:S})}else S.loadCounter=1;S.loadIdx=this.fragLoadIdx,this.fragCurrent=S,this.startFragRequested=!0,isNaN(S.sn)||(this.nextLoadPosition=S.start+S.duration),n.trigger(d.default.FRAG_LOADING,{frag:S}),this.state=k.FRAG_LOADING}}break;case k.WAITING_TRACK:(t=this.tracks[this.trackId])&&t.details&&(this.state=k.IDLE);break;case k.FRAG_LOADING_WAITING_RETRY:var P=performance.now(),I=this.retryDate,C=(l=this.media)&&l.seeking;(!I||P>=I||C)&&(b.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=k.IDLE);break;case k.WAITING_INIT_PTS:var M=this.videoTrackCC;if(void 0===this.initPTS[M])break;var F=this.waitingFragment;if(F){var N=F.frag.cc;M!==N?(t=this.tracks[this.trackId]).details&&t.details.live&&(b.logger.warn("Waiting fragment CC ("+N+") does not match video track CC ("+M+")"),this.waitingFragment=null,this.state=k.IDLE):(this.state=k.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=k.IDLE;break;case k.STOPPED:case k.FRAG_LOADING:case k.PARSING:case k.PARSED:case k.ENDED:}}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(b.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.tracks;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){this.state===k.ENDED&&(this.state=k.IDLE),this.media&&(this.lastCurrentTime=this.media.currentTime),void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold),this.tick()}},{key:"onMediaEnded",value:function(){this.startPosition=this.lastCurrentTime=0}},{key:"onAudioTracksUpdated",value:function(e){b.logger.log("audio tracks updated"),this.tracks=e.audioTracks}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url;this.trackId=e.id,this.fragCurrent=null,this.state=k.PAUSED,this.waitingFragment=null,t?this.timer||(this.timer=setInterval(this.ontick,100)):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),t&&(this.audioSwitch=!0,this.state=k.IDLE,void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold)),this.tick()}},{key:"onAudioTrackLoaded",value:function(e){var t=e.details,r=e.id,n=this.tracks[r],i=t.totalduration,a=0;if(b.logger.log("track "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),t.live){var o=n.details;o&&t.fragments.length>0?(v.default.mergeDetails(o,t),a=t.fragments[0].start,t.PTSKnown?b.logger.log("live audio playlist sliding:"+a.toFixed(3)):b.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,b.logger.log("live audio playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,!this.startFragRequested){if(-1===this.startPosition){var s=t.startTimeOffset;isNaN(s)?this.startPosition=0:(b.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s)}this.nextLoadPosition=this.startPosition}this.state===k.WAITING_TRACK&&(this.state=k.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===k.KEY_LOADING&&(this.state=k.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,r=e.frag;if(this.state===k.FRAG_LOADING&&t&&"audio"===r.type&&r.level===t.level&&r.sn===t.sn){var n=this.tracks[this.trackId],i=n.details,a=i.totalduration,o=t.level,s=t.sn,l=t.cc,c=this.config.defaultAudioCodec||n.audioCodec||"mp4a.40.2",f=this.stats=e.stats;if("initSegment"===s)this.state=k.IDLE,f.tparsed=f.tbuffered=performance.now(),i.initSegment.data=e.payload,this.hls.trigger(d.default.FRAG_BUFFERED,{stats:f,frag:t,id:"audio"}),this.tick();else{this.state=k.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new u.default(this.hls,"audio"));var h=this.initPTS[l],p=i.initSegment?i.initSegment.data:[];i.initSegment||void 0!==h?(this.pendingBuffering=!0,b.logger.log("Demuxing "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+o),this.demuxer.push(e.payload,p,c,null,t,a,!1,h)):(b.logger.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+i.startSN+" ,"+i.endSN+"],track "+o),this.waitingFragment=e,this.state=k.WAITING_INIT_PTS)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,r=e.frag;if(t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===k.PARSING){var n=e.tracks,i=void 0;if(n.video&&delete n.video,i=n.audio){i.levelCodec=i.codec,i.id=e.id,this.hls.trigger(d.default.BUFFER_CODECS,n),b.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var a=i.initSegment;if(a){var o={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,o))}this.tick()}}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"audio"===e.id&&"audio"===e.type&&n.sn===r.sn&&n.level===r.level&&this.state===k.PARSING){var i=this.trackId,a=this.tracks[i],o=this.hls;isNaN(e.endPTS)&&(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),b.logger.log("parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb),v.default.updateFragPTSDTS(a.details,r,e.startPTS,e.endPTS);var s=this.audioSwitch,l=this.media,u=!1;if(s&&l)if(l.readyState){var c=l.currentTime;b.logger.log("switching audio track : currentTime:"+c),c>=e.startPTS&&(b.logger.log("switching audio track : flushing all audio"),this.state=k.BUFFER_FLUSHING,o.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),u=!0,this.audioSwitch=!1,o.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:i}))}else this.audioSwitch=!1,o.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:i});var f=this.pendingData;this.audioSwitch||([e.data1,e.data2].forEach(function(t){t&&t.length&&f.push({type:e.type,data:t,parent:"audio",content:"data"})}),!u&&f.length&&(f.forEach(function(e){t.state===k.PARSING&&(t.pendingBuffering=!0,t.hls.trigger(d.default.BUFFER_APPENDING,e))}),this.pendingData=[],this.appended=!0)),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,r=e.frag;t&&"audio"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===k.PARSING&&(this.stats.tparsed=performance.now(),this.state=k.PARSED,this._checkAppendedParsed())}},{key:"onBufferCreated",value:function(e){var t=e.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0)}},{key:"onBufferAppended",value:function(e){if("audio"===e.parent){var t=this.state;t!==k.PARSING&&t!==k.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==k.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent,t=this.stats,r=this.hls;if(e){this.fragPrevious=e,t.tbuffered=performance.now(),r.trigger(d.default.FRAG_BUFFERED,{stats:t,frag:e,id:"audio"});var n=this.mediaBuffer?this.mediaBuffer:this.media;b.logger.log("audio buffered : "+y.default.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=k.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag;if(!t||"audio"===t.type)switch(e.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:if(!e.fatal){var r=this.fragLoadError;r?r++:r=1;var n=this.config;if(r<=n.fragLoadingMaxRetry){this.fragLoadError=r,t.loadCounter=0;var i=Math.min(Math.pow(2,r-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);b.logger.warn("audioStreamController: frag loading failed, retry in "+i+" ms"),this.retryDate=performance.now()+i,this.state=k.FRAG_LOADING_WAITING_RETRY}else b.logger.error("audioStreamController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=k.ERROR}break;case m.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case m.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case m.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==k.ERROR&&(this.state=e.fatal?k.ERROR:k.IDLE,b.logger.warn("audioStreamController: "+e.details+" while loading frag,switch to "+this.state+" state ..."));break;case m.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===e.parent&&(this.state===k.PARSING||this.state===k.PARSED)){var a=this.mediaBuffer,o=this.media.currentTime,l=a&&s.default.isBuffered(a,o)&&s.default.isBuffered(a,o+.5);if(l){var u=this.config;u.maxMaxBufferLength>=u.maxBufferLength&&(u.maxMaxBufferLength/=2,b.logger.warn("audio:reduce max buffer length to "+u.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*u.fragLoadingLoopThreshold),this.state=k.IDLE}else b.logger.warn("buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=k.BUFFER_FLUSHING,this.hls.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}}},{key:"onBufferFlushed",value:function(){var e=this,t=this.pendingData;t&&t.length?(b.logger.log("appending pending audio data on Buffer Flushed"),t.forEach(function(t){e.hls.trigger(d.default.BUFFER_APPENDING,t)}),this.appended=!0,this.pendingData=[],this.state=k.PARSED):(this.state=k.IDLE,this.fragPrevious=null,this.tick())}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,b.logger.log("audio stream:"+t+"->"+e)}},get:function(){return this._state}}]),t}(h.default);r.default=w},{25:25,33:33,34:34,35:35,37:37,38:38,48:48,51:51,54:54,55:55}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=c(i),o=e(34),s=c(o),l=e(54),u=e(33);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.AUDIO_TRACK_LOADED,a.default.ERROR));return r.ticks=0,r.ontick=r.tick.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.cleanTimer(),s.default.prototype.destroy.call(this)}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){this.updateTrack(this.trackId)}},{key:"onError",value:function(e){e.fatal&&e.type===u.ErrorTypes.NETWORK_ERROR&&this.cleanTimer()}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,r=e.audioTracks||[],n=!1;this.tracks=r,this.hls.trigger(a.default.AUDIO_TRACKS_UPDATED,{audioTracks:r});var i=0;r.forEach(function(e){if(e.default&&!n)return t.audioTrack=i,void(n=!0);i++}),!1===n&&r.length&&(l.logger.log("no default audio track defined, use first audio track as default"),this.audioTrack=0)}},{key:"onAudioTrackLoaded",value:function(e){e.id<this.tracks.length&&(l.logger.log("audioTrack "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(this.ontick,1e3*e.details.targetduration)),!e.details.live&&this.timer&&this.cleanTimer())}},{key:"setAudioTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,l.logger.log("switching to audioTrack "+e);var t=this.tracks[e],r=this.hls,n=t.type,i=t.url,o={id:e,type:n,url:i};r.trigger(a.default.AUDIO_TRACK_SWITCH,o),r.trigger(a.default.AUDIO_TRACK_SWITCHING,o);var s=t.details;!i||void 0!==s&&!0!==s.live||(l.logger.log("(re)loading playlist for audioTrack "+e),r.trigger(a.default.AUDIO_TRACK_LOADING,{url:i,id:e}))}}},{key:"updateTrack",value:function(e){if(e>=0&&e<this.tracks.length){this.cleanTimer(),this.trackId=e,l.logger.log("updating audioTrack "+e);var t=this.tracks[e],r=t.url,n=t.details;!r||void 0!==n&&!0!==n.live||(l.logger.log("(re)loading playlist for audioTrack "+e),this.hls.trigger(a.default.AUDIO_TRACK_LOADING,{url:r,id:e}))}}},{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.trackId===e&&void 0!==this.tracks[e].details||this.setAudioTrackInternal(e)}}]),t}(s.default);r.default=d},{33:33,34:34,35:35,54:54}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=c(i),o=e(34),s=c(o),l=e(54),u=e(33);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_RESET,a.default.BUFFER_APPENDING,a.default.BUFFER_CODECS,a.default.BUFFER_EOS,a.default.BUFFER_FLUSHING,a.default.LEVEL_PTS_UPDATED,a.default.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio,i=Math.abs(n.timestampOffset-e.start);if(i>.1){var a=n.updating;try{n.abort()}catch(e){a=!0,l.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(l.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,r=e.video||e.levels.length&&e.audio,n=0;e.altAudio&&(t||r)&&(n=(t?1:0)+(r?1:0),l.logger.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(r)}}},{key:"onMediaDetaching",value:function(){l.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){l.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){l.logger.log("media source opened"),this.hls.trigger(a.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){l.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){l.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;l.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0);this.hls.trigger(a.default.BUFFER_APPENDED,{parent:t,pending:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){l.logger.error("sourceBuffer error:",e),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var n in e)if(!t[n]){var i=e[n],o=i.levelCodec||i.codec,s=i.container+";codecs="+o;l.logger.log("creating sourceBuffer("+s+")");try{var c=t[n]=r.addSourceBuffer(s);c.addEventListener("updateend",this.onsbue),c.addEventListener("error",this.onsbe),this.tracks[n]={codec:o,container:i.container},i.buffer=c}catch(e){l.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(a.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){l.logger.error("sourceBuffer error:",e.event),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,l.logger.log(n+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}l.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){l.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,r=this.sourceBuffer,n=this._levelDuration;if(null!==n&&e&&t&&r&&0!==e.readyState&&"open"===t.readyState){for(var i in r)if(r[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var a=e.duration;(n>this._msDuration&&n>a||a===1/0||isNaN(a))&&(l.logger.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=t.duration=n)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){l.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void l.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var n=r.shift();try{var i=n.type,o=t[i];o?o.updating?r.unshift(n):(o.ended=!1,this.parent=n.parent,o.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){l.logger.error("error while trying to append buffer:"+t.message),r.unshift(n);var s={type:u.ErrorTypes.MEDIA_ERROR,parent:n.parent};if(22===t.code)return this.segments=[],s.details=u.ErrorDetails.BUFFER_FULL_ERROR,s.fatal=!1,void e.trigger(a.default.ERROR,s);if(this.appendError?this.appendError++:this.appendError=1,s.details=u.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return l.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],s.fatal=!0,void e.trigger(a.default.ERROR,s);s.fatal=!1,e.trigger(a.default.ERROR,s)}}}}},{key:"flushBuffer",value:function(e,t,r){var n,i,a,o,s,u,c=this.sourceBuffer;if(Object.keys(c).length){if(l.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in c)if(!r||d===r){if((n=c[d]).ended=!1,n.updating)return l.logger.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<n.buffered.length;i++)if(a=n.buffered.start(i),o=n.buffered.end(i),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(s=e,u=t):(s=Math.max(a,e),u=Math.min(o,t)),Math.min(u,o)-s>.5)return this.flushBufferCounter++,l.logger.log("flush "+d+" ["+s+","+u+"], of ["+a+","+o+"], pos:"+this.media.currentTime),n.remove(s,u),!1}catch(e){l.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else l.logger.warn("abort flushing too many retries");l.logger.log("buffer flushed")}return!0}}]),t}(s.default);r.default=d},{33:33,34:34,35:35,54:54}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=l(i),o=e(34),s=l(o);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FPS_DROP_LEVEL_CAPPING,a.default.MEDIA_ATTACHING,a.default.MANIFEST_PARSED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var r=this;if(!this.levels)return-1;var n=this.levels.filter(function(n,i){return t.isLevelAllowed(i,r.restrictedLevels)&&i<=e});return t.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var e=void 0,r=this.media;return r&&(e=r.width||r.clientWidth||r.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,r=this.media;return r&&(e=r.height||r.clientHeight||r.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"isLevelAllowed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return-1===t.indexOf(e)}},{key:"getMaxLevelByMediaSize",value:function(e,t,r){if(!e||e&&!e.length)return-1;for(var n=function(e,t){return!t||e.width!==t.width||e.height!==t.height},i=e.length-1,a=0;a<e.length;a+=1){var o=e[a];if((o.width>=t||o.height>=r)&&n(o,e[a+1])){i=a;break}}return i}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(s.default);r.default=u},{34:34,35:35}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=u(i),o=e(34),s=u(o),l=e(54);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;if(t.capLevelOnFPSDrop){var r=this.video=e.media instanceof HTMLVideoElement?e.media:null;"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var i=n-this.lastTime,o=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,u=1e3*o/i,c=this.hls;if(c.trigger(a.default.FPS_DROP,{currentDropped:o,currentDecoded:s,totalDroppedFrames:r}),u>0&&o>c.config.fpsDroppedMonitoringThreshold*s){var d=c.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(a.default.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,c.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(s.default);r.default=c},{34:34,35:35,54:54}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=c(i),o=e(34),s=c(o),l=e(27),u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA));return r.id3Track=void 0,r.media=void 0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(e){for(var t=e.frag,r=e.samples,n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var a=u.default.getID3Frames(r[i].data);if(a){var o=r[i].pts,s=i<r.length-1?r[i+1].pts:t.endPTS;o===s&&(s+=1e-4);for(var l=0;l<a.length;l++){var c=a[l];if(!u.default.isTimeStampFrame(c)){var d=new n(o,s,"");d.value=c,this.id3Track.addCue(d)}}}}}}]),t}(s.default);r.default=d},{27:27,34:34,35:35}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=f(i),o=e(34),s=f(o),l=e(54),u=e(33),c=e(37),d=f(c);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MANIFEST_LOADED,a.default.LEVEL_LOADED,a.default.FRAG_LOADED,a.default.ERROR));return r.ontick=r.tick.bind(r),r._manualLevel=-1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.cleanTimer(),this._manualLevel=-1}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,r=[],n=[],i={},o=!1,s=!1,c=this.hls,d=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),f=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach(function(e){e.videoCodec&&(o=!0),d&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(s=!0);var t=i[e.bitrate];void 0===t?(i[e.bitrate]=r.length,e.url=[e.url],e.urlId=0,r.push(e)):r[t].url.push(e.url)}),o&&s?r.forEach(function(e){e.videoCodec&&n.push(e)}):n=r,(n=n.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||f("audio",t))&&(!r||f("video",r))})).length){t=n[0].bitrate,n.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=n;for(var h=0;h<n.length;h++)if(n[h].bitrate===t){this._firstLevel=h,l.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}c.trigger(a.default.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:o,altAudio:e.audioTracks.length>0})}else c.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:c.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this._level!==e){l.logger.log("switching to level "+e),this._level=e;var n=t[e];n.level=e,r.trigger(a.default.LEVEL_SWITCH,n),r.trigger(a.default.LEVEL_SWITCHING,n)}var i=t[e],o=i.details;if(!o||!0===o.live){var s=i.urlId;r.trigger(a.default.LEVEL_LOADING,{url:i.url[s],level:e,id:s})}}else r.trigger(a.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(e.fatal)e.type===u.ErrorTypes.NETWORK_ERROR&&this.cleanTimer();else{var t=e.details,r=this.hls,n=void 0,i=void 0,a=!1;switch(t){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:case u.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case u.ErrorDetails.LEVEL_LOAD_ERROR:case u.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.context.level,a=!0;break;case u.ErrorDetails.REMUX_ALLOC_ERROR:n=e.level}if(void 0!==n){(i=this._levels[n]).loadError?i.loadError++:i.loadError=1;var o=i.url.length;if(o>1&&i.loadError<o)i.urlId=(i.urlId+1)%o,i.details=void 0,l.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+i.urlId);else{var s=-1===this._manualLevel&&n;if(s)l.logger.warn("level controller,"+t+": switch-down for next fragment"),r.nextAutoLevel=Math.max(0,n-1);else if(i&&i.details&&i.details.live)l.logger.warn("level controller,"+t+" on live stream, discard"),a&&(this._level=void 0);else if(t===u.ErrorDetails.LEVEL_LOAD_ERROR||t===u.ErrorDetails.LEVEL_LOAD_TIMEOUT){var c=r.media,f=c&&d.default.isBuffered(c,c.currentTime)&&d.default.isBuffered(c,c.currentTime+.5);if(f){var h=r.config.levelLoadingRetryDelay;l.logger.warn("level controller,"+t+", but media buffered, retry in "+h+"ms"),this.timer=setTimeout(this.ontick,h),e.levelRetry=!0}else l.logger.error("cannot recover "+t+" error"),this._level=void 0,this.cleanTimer(),e.fatal=!0}}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var r=this._levels[t.level];r&&(r.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var r=this._levels[t];r.loadError=0;var n=e.details;if(n.live){var i=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),a=r.details;a&&n.endSN===a.endSN&&(i/=2,l.logger.log("same live playlist, reload twice faster")),i-=performance.now()-e.stats.trequest,i=Math.max(1e3,Math.round(i)),l.logger.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e];if(t&&t.url){var r=t.urlId;this.hls.trigger(a.default.LEVEL_LOADING,{url:t.url[r],level:e,id:r})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.nextAutoLevel=e)}}]),t}(s.default);r.default=h},{33:33,34:34,35:35,37:37,54:54}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(48),a=_(i),o=e(37),s=_(o),l=e(25),u=_(l),c=e(35),d=_(c),f=e(34),h=_(f),p=e(38),v=_(p),g=e(55),y=_(g),m=e(33),b=e(54);function _(e){return e&&e.__esModule?e:{default:e}}var E={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.LEVEL_LOADED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_LOAD_EMERGENCY_ABORTED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_SWITCHED,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r._state=E.STOPPED,r.ontick=r.tick.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),h.default.prototype.destroy.call(this),this.state=E.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(b.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=E.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=E.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=E.STOPPED,this.forceStartLoad=!1}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case E.ERROR:break;case E.BUFFER_FLUSHING:this.fragLoadError=0;break;case E.IDLE:this._doTickIdle();break;case E.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=E.IDLE);break;case E.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(b.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=E.IDLE);break;case E.ERROR:case E.STOPPED:case E.FRAG_LOADING:case E.PARSING:case E.PARSED:case E.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,r=this.media;if(void 0===this.levelLastLoaded||r||!this.startFragRequested&&t.startFragPrefetch){var n=void 0;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,a=this.levels[i];if(a){var o=a.bitrate,l=void 0;l=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,l=Math.min(l,t.maxMaxBufferLength);var u=s.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,t.maxBufferHole),c=u.len;if(!(c>=l)){b.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var f=a.details;if(void 0===f||f.live&&this.levelLastLoaded!==i)this.state=E.WAITING_LEVEL;else{var h=this.fragPrevious;if(!f.live&&h&&h.sn===f.endSN&&c&&!u.nextStart){var p=Math.min(r.duration,h.start+h.duration);if(p-Math.max(u.end,h.start)<=Math.max(.2,h.duration)){var v={};return this.altAudio&&(v.type="video"),this.hls.trigger(d.default.BUFFER_EOS,v),void(this.state=E.ENDED)}}this._fetchPayloadOrEos(n,u,f)}}}}}},{key:"_fetchPayloadOrEos",value:function(e,t,r){var n=this.fragPrevious,i=this.level,a=r.fragments,o=a.length;if(0!==o){var s=a[0].start,l=a[o-1].start+a[o-1].duration,u=t.end,c=void 0;if(r.initSegment&&!r.initSegment.data)c=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(o<d)return void b.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);if(null===(c=this._ensureFragmentAtLivePoint(r,u,s,l,n,a,o)))return}else u<s&&(c=a[0]);c||(c=this._findFragment(s,n,o,a,u,l,r)),c&&this._loadFragmentOrKey(c,i,r,e,u)}}},{key:"_ensureFragmentAtLivePoint",value:function(e,t,r,n,i,o,s){var l=this.hls.config,u=this.media,c=void 0,d=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-l.maxFragLookUpTolerance,n-d)){var f=this.liveSyncPosition=this.computeLivePosition(r,e);b.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),t=f,u&&u.readyState&&u.duration>f&&(u.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>n&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i){var h=i.sn+1;if(h>=e.startSN&&h<=e.endSN){var p=o[h-e.startSN];i.cc===p.cc&&(c=p,b.logger.log("live playlist, switching playlist, load frag with next SN: "+c.sn))}c||(c=a.default.search(o,function(e){return i.cc-e.cc}))&&b.logger.log("live playlist, switching playlist, load frag with same CC: "+c.sn)}c||(c=o[Math.min(s-1,Math.round(s/2))],b.logger.log("live playlist, switching playlist, unknown, load middle frag : "+c.sn))}return c}},{key:"_findFragment",value:function(e,t,r,n,i,o,s){var l=this.hls.config,u=void 0,c=void 0,d=l.maxFragLookUpTolerance,f=t?n[t.sn-n[0].sn+1]:void 0,h=function(e){var t=Math.min(d,e.duration);return e.start+e.duration-t<=i?1:e.start-t>i&&e.start?-1:0};if(i<o?(i>o-d&&(d=0),c=f&&!h(f)?f:a.default.search(n,h)):c=n[r-1],c){var p=(u=c).sn-s.startSN,v=t&&u.level===t.level,g=n[p-1],y=n[p+1];if(t&&u.sn===t.sn)if(v&&!u.backtracked)if(u.sn<s.endSN){var m=t.deltaPTS;m&&m>l.maxBufferHole&&t.dropped&&p?(u=g,b.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(u=y,b.logger.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(y&&y.backtracked?(b.logger.warn("Already backtracked from fragment "+y.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+y.sn),u=y):(b.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,g?(g.loadCounter&&g.loadCounter--,(u=g).backtracked=!0):p&&(u=null)))}return u}},{key:"_loadFragmentOrKey",value:function(e,t,r,n,i){var a=this.hls,o=a.config;if(!e.decryptdata||null==e.decryptdata.uri||null!=e.decryptdata.key){if(b.logger.log("Loading "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t+", currentTime:"+n.toFixed(3)+",bufferEnd:"+i.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var s=o.fragLoadingLoopThreshold;if(e.loadCounter>s&&Math.abs(this.fragLoadIdx-e.loadIdx)<s)return void a.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e})}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||(this.nextLoadPosition=e.start+e.duration),e.autoLevel=a.autoLevelEnabled,e.bitrateTest=this.bitrateTest,a.trigger(d.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new u.default(a,"main")),void(this.state=E.FRAG_LOADING)}b.logger.log("Loading key for "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t),this.state=E.KEY_LOADING,a.trigger(d.default.KEY_LOADING,{frag:e})}},{key:"getBufferedFrag",value:function(e){return a.default.search(this._bufferedFrags,function(t){return e<t.startPTS?-1:e>t.endPTS?1:0})}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),s.default.isBuffered(r,t)?e=this.getBufferedFrag(t):s.default.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(d.default.FRAG_CHANGED,{frag:n});var i=n.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(d.default.LEVEL_SWITCHED,{level:i}),this.fragPlaying=n}}}},{key:"immediateLevelSwitch",value:function(){if(b.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,s.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,r=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,(r=this.getBufferedFrag(e.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,a=this.levels[i],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if((n=this.getBufferedFrag(e.currentTime+t))&&(n=this.followingBufferedFrag(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=E.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(d.default.BUFFER_FLUSHING,r)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(b.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0,e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,r=this.config;isNaN(t)||b.logger.log("media seeking to "+t.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:e,i=s.default.bufferInfo(n,t,this.config.maxBufferHole);if(this.state===E.FRAG_LOADING){var a=this.fragCurrent;if(0===i.len&&a){var o=r.maxFragLookUpTolerance,l=a.start-o,u=a.start+a.duration+o;t<l||t>u?(a.loader&&(b.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=E.IDLE):b.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===E.ENDED&&(0===i.len&&(this.fragPrevious=0),this.state=E.IDLE);e&&(this.lastCurrentTime=t),this.state!==E.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*r.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||b.logger.log("media seeked to "+t.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){b.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){b.logger.log("trigger BUFFER_RESET"),this.hls.trigger(d.default.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,r=!1,n=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&b.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,r=e.level,n=this.levels[r],i=t.totalduration,a=0;if(b.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),this.levelLastLoaded=r,t.live){var o=n.details;o&&t.fragments.length>0?(v.default.mergeDetails(o,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),t.PTSKnown?b.logger.log("live playlist sliding:"+a.toFixed(3)):b.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,b.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(d.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(a,t),b.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(b.logger.log("negative start time offset "+s+", count from end of last fragment"),s=a+i+s),b.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===E.WAITING_LEVEL&&(this.state=E.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===E.KEY_LOADING&&(this.state=E.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,r=e.frag;if(this.state===E.FRAG_LOADING&&t&&"main"===r.type&&r.level===t.level&&r.sn===t.sn){var n=e.stats,i=this.levels[t.level],a=i.details;if(b.logger.log("Loaded  "+t.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=n,!0===r.bitrateTest&&this.hls.nextLoadLevel)this.state=E.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else if("initSegment"===r.sn)this.state=E.IDLE,n.tparsed=n.tbuffered=performance.now(),a.initSegment.data=e.payload,this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=E.PARSING;var o=a.totalduration,s=t.level,l=t.sn,c=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(b.logger.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,b.logger.log("Parsing "+l+" of ["+a.startSN+" ,"+a.endSN+"],level "+s+", cc "+t.cc);var f=this.demuxer;f||(f=this.demuxer=new u.default(this.hls,"main"));var h=this.media,p=h&&h.seeking,v=!p&&(a.PTSKnown||!a.live),g=a.initSegment?a.initSegment.data:[];f.push(e.payload,g,c,i.videoCodec,t,o,v,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E.PARSING){var n,i,a=e.tracks;if(a.audio&&this.altAudio&&delete a.audio,i=a.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(b.logger.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==i.container&&(o="mp4a.40.2",b.logger.log("Android: force audio codec to "+o)),i.levelCodec=o,i.id=e.id}for(n in(i=a.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=e.id),this.hls.trigger(d.default.BUFFER_CODECS,a),a){i=a[n],b.logger.log("main track:"+n+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var l=i.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"main"===e.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===E.PARSING){var i=this.levels[this.level],a=r;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),b.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped){if(!a.backtracked)return b.logger.warn("missing video frame(s), backtracking fragment"),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=E.IDLE,this.fragPrevious=a,void this.tick();b.logger.warn("Already backtracked on this fragment, appending with the gap")}else a.backtracked=!1;var o=v.default.updateFragPTSDTS(i.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),s=this.hls;s.trigger(d.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(r){r&&r.length&&t.state===E.PARSING&&(t.appended=!0,t.pendingBuffering=!0,s.trigger(d.default.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E.PARSING&&(this.stats.tparsed=performance.now(),this.state=E.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){b.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(b.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=E.IDLE}var i=this.hls;i.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(b.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,r=void 0,n=void 0,i=!1;for(var a in t){var o=t[a];"main"===o.id?(n=a,r=o,"video"===a&&(this.videoBuffer=t[a].buffer)):i=!0}i&&r?(b.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==E.PARSING&&t!==E.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==E.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;b.logger.log("main buffered : "+y.default.toString(t.buffered));var r=this._bufferedFrags.filter(function(e){return s.default.isBuffered(t,(e.startPTS+e.endPTS)/2)});r.push(e),this._bufferedFrags=r.sort(function(e,t){return e.startPTS-t.startPTS}),this.fragPrevious=e;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=E.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=this.media,n=r&&s.default.isBuffered(r,r.currentTime)&&s.default.isBuffered(r,r.currentTime+.5);switch(e.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry||n||t.autoLevel&&t.level){this.fragLoadError=i,t.loadCounter=0;var o=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);b.logger.warn("mediaController: frag loading failed, retry in "+o+" ms"),this.retryDate=performance.now()+o,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=E.FRAG_LOADING_WAITING_RETRY}else b.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=E.ERROR}break;case m.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(n?(this._reduceMaxBufferLength(t.duration),this.state=E.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.state=E.ERROR));break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==E.ERROR&&(e.fatal?(this.state=E.ERROR,b.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==E.WAITING_LEVEL||(this.state=E.IDLE));break;case m.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==E.PARSING&&this.state!==E.PARSED||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=E.IDLE):(b.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,b.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media,t=this.config;if(e&&e.readyState){var r=e.currentTime,n=this.mediaBuffer?this.mediaBuffer:e,i=n.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=!0;var a=e.seeking?r:this.startPosition,o=s.default.isBuffered(n,a),l=i.start(0);(r!==a||!o&&Math.abs(a-l)<t.maxSeekHole)&&(b.logger.log("target start position:"+a),o||(a=l,b.logger.log("target start position not buffered, seek to buffered.start(0) "+a)),b.logger.log("adjust currentTime from "+r+" to "+a),e.currentTime=a)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var u=s.default.bufferInfo(e,r,0),c=!(e.paused||e.ended||0===e.buffered.length),f=r!==this.lastCurrentTime;if(f)this.stallReported&&(b.logger.warn("playback not stuck anymore @"+r+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(c){var h=performance.now(),p=this.hls;if(this.stalled){var v=h-this.stalled,g=u.len,y=this.nudgeRetry||0;if(g<=.5&&v>1e3*t.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,b.logger.warn("playback stalling in low buffer @"+r),p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:g}));var _=u.nextStart,E=_-r;if(_&&E<t.maxSeekHole&&E>0){this.nudgeRetry=++y;var k=y*t.nudgeOffset;b.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+_+" + nudge "+k),e.currentTime=_+k,this.stalled=void 0,p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:_+k-r})}}else if(g>.5&&v>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,b.logger.warn("playback stalling in high buffer @"+r),p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:g})),this.stalled=void 0,this.nudgeRetry=++y,y<t.nudgeMaxRetry){var w=e.currentTime,T=w+y*t.nudgeOffset;b.logger.log("adjust currentTime from "+w+" to "+T),e.currentTime=T,p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else b.logger.error("still stuck in high buffer @"+r+" after "+t.nudgeMaxRetry+", raise fatal error"),p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=h,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=E.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(t){return s.default.isBuffered(e,(t.startPTS+t.endPTS)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=E.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,b.logger.log("main stream:"+t+"->"+e),this.hls.trigger(d.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(h.default);r.default=k},{25:25,33:33,34:34,35:35,37:37,38:38,48:48,54:54,55:55}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=u(i),o=e(34),s=u(o),l=e(54);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.ERROR,a.default.SUBTITLE_TRACKS_UPDATED,a.default.SUBTITLE_TRACK_SWITCH,a.default.SUBTITLE_TRACK_LOADED,a.default.SUBTITLE_FRAG_PROCESSED));return r.config=e.config,r.vttFragSNsProcessed={},r.vttFragQueues=void 0,r.currentlyProcessing=null,r.currentTrackId=-1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"clearVttFragQueues",value:function(){var e=this;this.vttFragQueues={},this.tracks.forEach(function(t){e.vttFragQueues[t.id]=[]})}},{key:"nextFrag",value:function(){if(null===this.currentlyProcessing&&this.currentTrackId>-1&&this.vttFragQueues[this.currentTrackId].length){var e=this.currentlyProcessing=this.vttFragQueues[this.currentTrackId].shift();this.hls.trigger(a.default.FRAG_LOADING,{frag:e})}}},{key:"onSubtitleFragProcessed",value:function(e){e.success&&this.vttFragSNsProcessed[e.frag.trackId].push(e.frag.sn),this.currentlyProcessing=null,this.nextFrag()}},{key:"onError",value:function(e){var t=e.frag;t&&"subtitle"!==t.type||this.currentlyProcessing&&(this.currentlyProcessing=null,this.nextFrag())}},{key:"onSubtitleTracksUpdated",value:function(e){var t=this;l.logger.log("subtitle tracks updated"),this.tracks=e.subtitleTracks,this.clearVttFragQueues(),this.vttFragSNsProcessed={},this.tracks.forEach(function(e){t.vttFragSNsProcessed[e.id]=[]})}},{key:"onSubtitleTrackSwitch",value:function(e){this.currentTrackId=e.id,this.clearVttFragQueues()}},{key:"onSubtitleTrackLoaded",value:function(e){var t=this.vttFragSNsProcessed[e.id],r=this.vttFragQueues[e.id],n=this.currentlyProcessing?this.currentlyProcessing.sn:-1;e.details.fragments.forEach(function(i){(function(e){return t.indexOf(e.sn)>-1})(i)||i.sn===n||function(e){return r.some(function(t){return t.sn===e.sn})}(i)||(i.trackId=e.id,r.push(i))}),this.nextFrag()}}]),t}(s.default);r.default=c},{34:34,35:35,54:54}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=u(i),o=e(34),s=u(o),l=e(54);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.SUBTITLE_TRACK_LOADED));return r.tracks=[],r.trackId=-1,r.media=void 0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"_onTextTracksChanged",value:function(){if(this.media){for(var e=-1,t=function(e){for(var t=[],r=0;r<e.length;r++)"subtitles"===e[r].kind&&t.push(e[r]);return t}(this.media.textTracks),r=0;r<t.length;r++)"showing"===t[r].mode&&(e=r);this.subtitleTrack=e}}},{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.trackChangeListener=this._onTextTracksChanged.bind(this),this.media.textTracks.addEventListener("change",this.trackChangeListener))}},{key:"onMediaDetaching",value:function(){this.media&&(this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=void 0)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.trackId=-1}},{key:"onManifestLoaded",value:function(e){var t=this,r=e.subtitles||[];this.tracks=r,this.trackId=-1,this.hls.trigger(a.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(e){e.default&&(t.subtitleTrack=e.id)})}},{key:"onTick",value:function(){var e=this.trackId,t=this.tracks[e];if(t){var r=t.details;void 0!==r&&!0!==r.live||(l.logger.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}}},{key:"onSubtitleTrackLoaded",value:function(e){var t=this;e.id<this.tracks.length&&(l.logger.log("subtitle track "+e.id+" loaded"),this.tracks[e.id].details=e.details,e.details.live&&!this.timer&&(this.timer=setInterval(function(){t.onTick()},1e3*e.details.targetduration,this)),!e.details.live&&this.timer&&(clearInterval(this.timer),this.timer=null))}},{key:"setSubtitleTrackInternal",value:function(e){if(e>=0&&e<this.tracks.length){this.timer&&(clearInterval(this.timer),this.timer=null),this.trackId=e,l.logger.log("switching to subtitle track "+e);var t=this.tracks[e];this.hls.trigger(a.default.SUBTITLE_TRACK_SWITCH,{id:e});var r=t.details;void 0!==r&&!0!==r.live||(l.logger.log("(re)loading playlist for subtitle track "+e),this.hls.trigger(a.default.SUBTITLE_TRACK_LOADING,{url:t.url,id:e}))}}},{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.trackId!==e&&this.setSubtitleTrackInternal(e)}}]),t}(s.default);r.default=c},{34:34,35:35,54:54}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=h(i),o=e(34),s=h(o),l=e(49),u=h(l),c=e(58),d=h(c),f=e(54);function h(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.cues)for(;e.cues.length>0;)e.removeCue(e.cues[0])}function v(e,t,r,n){return Math.min(t,n)-Math.max(e,r)}var g=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_USERDATA,a.default.MANIFEST_LOADING,a.default.MANIFEST_LOADED,a.default.FRAG_LOADED,a.default.LEVEL_SWITCHING,a.default.INIT_PTS_FOUND));if(r.hls=e,r.config=e.config,r.enabled=!0,r.Cues=e.config.cueHandler,r.textTracks=[],r.tracks=[],r.unparsedVttFrags=[],r.initPTS=void 0,r.cueRanges=[],r.config.enableCEA708Captions){var n=r,i=function(e,t){var r=null;try{r=new window.Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)},o={newCue:function(e,t,r){if(!n.textTrack1){var a=n.getExistingTrack("1");if(a)n.textTrack1=a,p(n.textTrack1),i(n.textTrack1,n.media);else{var o=n.createTextTrack("captions",n.config.captionsTextTrack1Label,n.config.captionsTextTrack1LanguageCode);o&&(o.textTrack1=!0,n.textTrack1=o)}}n.addCues("textTrack1",e,t,r)}},s={newCue:function(e,t,r){if(!n.textTrack2){var a=n.getExistingTrack("2");if(a)n.textTrack2=a,p(n.textTrack2),i(n.textTrack2,n.media);else{var o=n.createTextTrack("captions",n.config.captionsTextTrack2Label,n.config.captionsTextTrack1LanguageCode);o&&(o.textTrack2=!0,n.textTrack2=o)}}n.addCues("textTrack2",e,t,r)}};r.cea608Parser=new u.default(0,o,s)}return r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"addCues",value:function(e,t,r,n){for(var i=this.cueRanges,a=!1,o=i.length;o--;){var s=i[o],l=v(s[0],s[1],t,r);if(l>=0&&(s[0]=Math.min(s[0],t),s[1]=Math.max(s[1],r),a=!0,l/(r-t)>.5))return}a||i.push([t,r]),this.Cues.newCue(this[e],t,r,n)}},{key:"onInitPtsFound",value:function(e){var t=this;void 0===this.initPTS&&(this.initPTS=e.initPTS),this.unparsedVttFrags.length&&(this.unparsedVttFrags.forEach(function(e){t.onFragLoaded(e)}),this.unparsedVttFrags=[])}},{key:"getExistingTrack",value:function(e){var t=this.media;if(t)for(var r=0;r<t.textTracks.length;r++){var n=t.textTracks[r],i="textTrack"+e;if(!0===n[i])return n}return null}},{key:"createTextTrack",value:function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)}},{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"onMediaAttaching",value:function(e){this.media=e.media}},{key:"onMediaDetaching",value:function(){p(this.textTrack1),p(this.textTrack2)}},{key:"onManifestLoading",value:function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0};var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)p(t[r])}}},{key:"onManifestLoaded",value:function(e){var t=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=void 0,this.cueRanges=[],this.config.enableWebVTT){this.tracks=e.subtitles||[];var r=this.media?this.media.textTracks:[];this.tracks.forEach(function(e,n){var i=void 0;if(n<r.length){var a=r[n];(function(e,t){return e&&e.label===t.name&&!(e.textTrack1||e.textTrack2)})(a,e)&&(i=a)}i||(i=t.createTextTrack("subtitles",e.name,e.lang)),i.mode=e.default?"showing":"hidden",t.textTracks.push(i)})}}},{key:"onLevelSwitching",value:function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions}},{key:"onFragLoaded",value:function(e){var t=e.frag,r=e.payload;if("main"===t.type){var n=t.sn;if(n!==this.lastSn+1){var i=this.cea608Parser;i&&i.reset()}this.lastSn=n}else if("subtitle"===t.type)if(r.byteLength){if(void 0===this.initPTS)return void this.unparsedVttFrags.push(e);var o=this.vttCCs;o[t.cc]||(o[t.cc]={start:t.start,prevCC:this.prevCC,new:!0},this.prevCC=t.cc);var s=this.textTracks,l=this.hls;d.default.parse(r,this.initPTS,o,t.cc,function(e){var r=s[t.trackId];e.forEach(function(e){if(!r.cues.getCueById(e.id))try{r.addCue(e)}catch(n){var t=new window.TextTrackCue(e.startTime,e.endTime,e.text);t.id=e.id,r.addCue(t)}}),l.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){f.logger.log("Failed to parse VTT cue: "+e),l.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})}else this.hls.trigger(a.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})}},{key:"onFragParsingUserdata",value:function(e){if(this.enabled&&this.config.enableCEA708Captions)for(var t=0;t<e.samples.length;t++){var r=this.extractCea608Data(e.samples[t].bytes);this.cea608Parser.addData(e.samples[t].pts,r)}}},{key:"extractCea608Data",value:function(e){for(var t,r,n,i=31&e[0],a=2,o=[],s=0;s<i;s++)t=e[a++],r=127&e[a++],n=127&e[a++],0===r&&0===n||0!=(4&t)&&0==(3&t)&&(o.push(r),o.push(n));return o}}]),t}(s.default);r.default=g},{34:34,35:35,49:49,54:54,58:58}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.aesIV=r}return n(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();r.default=i},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return n(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],f=new Uint32Array(256),h=0,p=0,v=0;for(v=0;v<256;v++)f[v]=v<128?v<<1:v<<1^283;for(v=0;v<256;v++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var y=f[h],m=f[y],b=f[m],_=257*f[g]^16843008*g;n[h]=_<<24|_>>>8,i[h]=_<<16|_>>>16,a[h]=_<<8|_>>>24,o[h]=_,_=16843009*b^65537*m^257*y^16843008*h,l[g]=_<<24|_>>>8,u[g]=_<<16|_>>>16,c[g]=_<<8|_>>>24,d[g]=_,h?(h=y^f[f[f[b^y]]],p^=f[f[p]]):h=p=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a=this.ksRows=4*(i+6+1),o=void 0,s=void 0,l=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),c=this.sBox,d=this.rcon,f=this.invSubMix,h=f[0],p=f[1],v=f[2],g=f[3],y=void 0,m=void 0;for(o=0;o<a;o++)o<i?y=l[o]=t[o]:(m=y,o%i==0?(m=c[(m=m<<8|m>>>24)>>>24]<<24|c[m>>>16&255]<<16|c[m>>>8&255]<<8|c[255&m],m^=d[o/i|0]<<24):i>6&&o%i==4&&(m=c[m>>>24]<<24|c[m>>>16&255]<<16|c[m>>>8&255]<<8|c[255&m]),l[o]=y=(l[o-i]^m)>>>0);for(s=0;s<a;s++)o=a-s,m=3&s?l[o]:l[o-4],u[s]=s<4||o<=4?m:h[c[m>>>24]]^p[c[m>>>16&255]]^v[c[m>>>8&255]]^g[c[255&m]],u[s]=u[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,r){for(var n,i,a=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,l=this.invSubMix,u=l[0],c=l[1],d=l[2],f=l[3],h=this.uint8ArrayToUint32Array_(r),p=h[0],v=h[1],g=h[2],y=h[3],m=new Int32Array(e),b=new Int32Array(m.length),_=void 0,E=void 0,k=void 0,w=void 0,T=void 0,S=void 0,A=void 0,R=void 0,x=void 0,L=void 0,O=void 0,D=void 0,P=this.networkToHostOrderSwap;t<m.length;){for(x=P(m[t]),L=P(m[t+1]),O=P(m[t+2]),D=P(m[t+3]),T=x^o[0],S=D^o[1],A=O^o[2],R=L^o[3],n=4,i=1;i<a;i++)_=u[T>>>24]^c[S>>16&255]^d[A>>8&255]^f[255&R]^o[n],E=u[S>>>24]^c[A>>16&255]^d[R>>8&255]^f[255&T]^o[n+1],k=u[A>>>24]^c[R>>16&255]^d[T>>8&255]^f[255&S]^o[n+2],w=u[R>>>24]^c[T>>16&255]^d[S>>8&255]^f[255&A]^o[n+3],T=_,S=E,A=k,R=w,n+=4;_=s[T>>>24]<<24^s[S>>16&255]<<16^s[A>>8&255]<<8^s[255&R]^o[n],E=s[S>>>24]<<24^s[A>>16&255]<<16^s[R>>8&255]<<8^s[255&T]^o[n+1],k=s[A>>>24]<<24^s[R>>16&255]<<16^s[T>>8&255]<<8^s[255&S]^o[n+2],w=s[R>>>24]<<24^s[T>>16&255]<<16^s[S>>8&255]<<8^s[255&A]^o[n+3],n+=3,b[t]=P(_^p),b[t+1]=P(w^v),b[t+2]=P(k^g),b[t+3]=P(E^y),p=x,v=L,g=O,y=D,t+=4}return b.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();r.default=i},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(17),a=f(i),o=e(20),s=f(o),l=e(18),u=f(l),c=e(33),d=e(54);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.logEnabled=!0;try{var n=crypto||self.crypto;this.subtle=n.subtle||n.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return n(e,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(e,t,r,n){var i=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(d.logger.log("JS AES decrypt"),this.logEnabled=!1);var o=this.decryptor;o||(this.decryptor=o=new u.default),o.expandKey(t),n(o.decrypt(e,0,r))}else{this.logEnabled&&(d.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var l=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new s.default(l,t)),this.fastAesKey.expandKey().then(function(o){var s=new a.default(l,r);s.decrypt(e,o).catch(function(a){i.onWebCryptoError(a,e,t,r,n)}).then(function(e){n(e)})}).catch(function(a){i.onWebCryptoError(a,e,t,r,n)})}}},{key:"onWebCryptoError",value:function(e,t,r,n,i){this.config.enableSoftwareAES?(d.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,i)):(d.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();r.default=h},{17:17,18:18,20:20,33:33,54:54}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.key=r}return n(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();r.default=i},{}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(22),a=u(i),o=e(54),s=e(27),l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.remuxer=r}return n(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var i=this._audioTrack,s=l.default.getID3Data(e,0),u=90*l.default.getTimeStamp(s),c=0,d=u,f=e.length,h=s.length,p=[{pts:d,dts:d,data:s}];h<f-1;)if(a.default.isHeader(e,h)&&h+5<f){a.default.initTrackConfig(i,this.observer,e,h,i.manifestCodec);var v=a.default.appendFrame(i,e,h,u,c);if(!v){o.logger.log("Unable to parse AAC frame");break}h+=v.length,d=v.sample.pts,c++}else l.default.isHeader(e,h)?(s=l.default.getID3Data(e,h),p.push({pts:d,dts:d,data:s}),h+=s.length):h++;this.remuxer.remux(i,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=l.default.getID3Data(e,0);if(n&&void 0!==l.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(a.default.probe(e,t))return o.logger.log("ADTS sync word found !"),!0;return!1}}]),e}();r.default=c},{22:22,27:27,54:54}],22:[function(e,t,r){"use strict";var n=e(54),i=e(33),a={getAudioConfig:function(e,t,r,a){var o,s,l,u,c,d=navigator.userAgent.toLowerCase(),f=a,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((s=(60&t[r+2])>>>2)>h.length-1))return u=(1&t[r+2])<<2,u|=(192&t[r+3])>>>6,n.logger.log("manifest codec:"+a+",ADTS data:type:"+o+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+u),/firefox/i.test(d)?s>=6?(o=5,c=new Array(4),l=s-3):(o=2,c=new Array(2),l=s):-1!==d.indexOf("android")?(o=2,c=new Array(2),l=s):(o=5,c=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&s>=6?l=s-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(s>=6&&1===u||/vivaldi/i.test(d))||!a&&1===u)&&(o=2,c=new Array(2)),l=s)),c[0]=o<<3,c[0]|=(14&s)>>1,c[1]|=(1&s)<<7,c[1]|=u<<3,5===o&&(c[1]|=(14&l)>>1,c[2]=(1&l)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:h[s],channelCount:u,codec:"mp4a.40."+o,manifestCodec:f};e.trigger(Event.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s})},isHeaderPattern:function(e,t){return 255===e[t]&&240==(246&e[t+1])},getHeaderLength:function(e,t){return 1&e[t+1]?7:9},getFullFrameLength:function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.getHeaderLength(e,t),n=r;t+5<e.length&&(n=this.getFullFrameLength(e,t));var i=t+n;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1},initTrackConfig:function(e,t,r,i,a){if(!e.samplerate){var o=this.getAudioConfig(t,r,i,a);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,n.logger.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}},getFrameDuration:function(e){return 9216e4/e},appendFrame:function(e,t,r,n,i){var a=this.getFrameDuration(e.samplerate),o=this.parseFrameHeader(t,r,n,i,a);if(o){var s=o.stamp,l=o.headerLength,u=o.frameLength,c={unit:t.subarray(r+l,r+l+u),pts:s,dts:s};return e.samples.push(c),e.len+=u,{sample:c,length:u+l}}},parseFrameHeader:function(e,t,r,n,i){var a,o,s=e.length;if(a=this.getHeaderLength(e,t),o=this.getFullFrameLength(e,t),(o-=a)>0&&t+a+o<=s)return{headerLength:a,frameLength:o,stamp:r+n*i}}};t.exports=a},{33:33,54:54}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=E(i),o=e(33),s=e(19),l=E(s),u=e(21),c=E(u),d=e(29),f=E(d),h=e(32),p=E(h),v=e(28),g=E(v),y=e(45),m=E(y),b=e(46),_=E(b);function E(e){return e&&e.__esModule?e:{default:e}}var k=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.typeSupported=r,this.config=n,this.vendor=i}return n(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,r,n,i,o,s,u,c,d,f,h){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new l.default(this.observer,this.config));var v,g=this;try{v=performance.now()}catch(e){v=Date.now()}p.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var l;try{l=performance.now()}catch(e){l=Date.now()}g.observer.trigger(a.default.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:l}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,i,o,s,u,c,d,f,h)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,i,o,s,u,c,d,f,h)}},{key:"pushDecrypted",value:function(e,t,r,n,i,s,l,u,d,h,v,y){var b=this.demuxer;if(!b||l&&!this.probe(e)){for(var E=this.observer,k=this.typeSupported,w=this.config,T=[{demux:c.default,remux:m.default},{demux:g.default,remux:m.default},{demux:p.default,remux:m.default},{demux:f.default,remux:_.default}],S=0,A=T.length;S<A;S++){var R=T[S],x=R.demux.probe;if(x(e)){var L=this.remuxer=new R.remux(E,w,k,this.vendor);b=new R.demux(E,L,w,k),this.probe=x;break}}if(!b)return void E.trigger(a.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=b}var O=this.remuxer;(l||u)&&(b.resetInitSegment(r,n,i,h),O.resetInitSegment()),l&&(b.resetTimeStamp(y),O.resetTimeStamp(y)),"function"==typeof b.setDecryptData&&b.setDecryptData(t),b.append(e,s,d,v)}}]),e}();r.default=k},{19:19,21:21,28:28,29:29,32:32,33:33,35:35,45:45,46:46}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e(23),i=c(n),a=e(35),o=c(a),s=e(54),l=e(1),u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}r.default=function(e){var t=new u.default;t.trigger=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(n))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(n){var a=n.data;switch(a.cmd){case"init":var o=JSON.parse(a.config);e.demuxer=new i.default(t,a.typeSupported,o,a.vendor);try{(0,s.enableLogs)(!0===o.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}r("init",null);break;case"demux":e.demuxer.push(a.data,a.decryptdata,a.initSegment,a.audioCodec,a.videoCodec,a.timeOffset,a.discontinuity,a.trackSwitch,a.contiguous,a.duration,a.accurateTimeOffset,a.defaultInitPTS)}}),t.on(o.default.FRAG_DECRYPTED,r),t.on(o.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(o.default.FRAG_PARSED,r),t.on(o.default.ERROR,r),t.on(o.default.FRAG_PARSING_METADATA,r),t.on(o.default.FRAG_PARSING_USERDATA,r),t.on(o.default.INIT_PTS_FOUND,r),t.on(o.default.FRAG_PARSING_DATA,function(t,r){var n=[],i={event:t,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(i,n)})}},{1:1,23:23,35:35,54:54}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=p(i),o=e(23),s=p(o),l=e(24),u=p(l),c=e(54),d=e(33),f=e(1),h=p(f);function p(e){return e&&e.__esModule?e:{default:e}}var v=function(){function t(r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.hls=r,this.id=n;var i=this.observer=new h.default,o=r.config;i.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.emit.apply(i,[e,e].concat(r))},i.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.removeListener.apply(i,[e].concat(r))};var l=function(e,t){(t=t||{}).frag=this.frag,t.id=this.id,r.trigger(e,t)}.bind(this);i.on(a.default.FRAG_DECRYPTED,l),i.on(a.default.FRAG_PARSING_INIT_SEGMENT,l),i.on(a.default.FRAG_PARSING_DATA,l),i.on(a.default.FRAG_PARSED,l),i.on(a.default.ERROR,l),i.on(a.default.FRAG_PARSING_METADATA,l),i.on(a.default.FRAG_PARSING_USERDATA,l),i.on(a.default.INIT_PTS_FOUND,l);var f={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(o.enableWorker&&"undefined"!=typeof Worker){c.logger.log("demuxing in webworker");var v=void 0;try{var g=e(3);v=this.w=g(u.default),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(e){r.trigger(a.default.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},v.postMessage({cmd:"init",typeSupported:f,vendor:p,id:n,config:JSON.stringify(o)})}catch(e){c.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),v&&URL.revokeObjectURL(v.objectURL),this.demuxer=new s.default(i,f,o,p),this.w=void 0}}else this.demuxer=new s.default(i,f,o,p)}return n(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)}},{key:"push",value:function(e,t,r,n,i,a,o,s){var l=this.w,u=isNaN(i.startDTS)?i.start:i.startDTS,d=i.decryptdata,f=this.frag,h=!(f&&i.cc===f.cc),p=!(f&&i.level===f.level),v=f&&i.sn===f.sn+1,g=!p&&v;if(h&&c.logger.log(this.id+":discontinuity detected"),p&&c.logger.log(this.id+":switch detected"),this.frag=i,l)l.postMessage({cmd:"demux",data:e,decryptdata:d,initSegment:t,audioCodec:r,videoCodec:n,timeOffset:u,discontinuity:h,trackSwitch:p,contiguous:g,duration:a,accurateTimeOffset:o,defaultInitPTS:s},[e]);else{var y=this.demuxer;y&&y.push(e,d,t,r,n,u,h,p,g,a,o,s)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,r=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case a.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}}}]),t}();r.default=v},{1:1,23:23,24:24,3:3,33:33,35:35,54:54}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(54),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return n(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,r,n=8,i=8;for(t=0;t<e;t++)0!==i&&(r=this.readEG(),i=(n+r+256)%256),n=0===i?n:i}},{key:"readSPS",value:function(){var e,t,r,n,i,a,o,s=0,l=0,u=0,c=0,d=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(d(),e=d(),f(5),v(3),d(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=h();if(3===b&&v(1),y(),y(),v(1),p())for(a=3!==b?8:12,o=0;o<a;o++)p()&&m(o<6?16:64)}y();var _=h();if(0===_)h();else if(1===_)for(v(1),g(),g(),t=h(),o=0;o<t;o++)g();y(),v(1),r=h(),n=h(),0===(i=f(1))&&v(1),v(1),p()&&(s=h(),l=h(),u=h(),c=h());var E=[1,1];if(p()&&p()){var k=d();switch(k){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[d()<<8|d(),d()<<8|d()]}}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-i)*(n+1)*16-(i?2:4)*(u+c),pixelRatio:E}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();r.default=a},{54:54}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"isHeader",value:function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"isFooter",value:function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"getID3Data",value:function(t,r){for(var n=r,i=0;e.isHeader(t,r);){i+=10;var a=e._readSize(t,r+6);i+=a,e.isFooter(t,r+10)&&(i+=10),r+=i}if(i>0)return t.subarray(n,n+i)}},{key:"_readSize",value:function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]}},{key:"getTimeStamp",value:function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var i=r[n];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}}},{key:"isTimeStampFrame",value:function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}},{key:"_getFrameData",value:function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}}},{key:"getID3Frames",value:function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var i=e._readSize(t,r+6),a=(r+=10)+i;r+8<a;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&n.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return n}},{key:"_decodeFrame",value:function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0}},{key:"_readTimeStamp",value:function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}},{key:"_decodePrivFrame",value:function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}}},{key:"_decodeTextFrame",value:function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}}},{key:"_decodeURLFrame",value:function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}}},{key:"_utf8ArrayToStr",value:function(e){for(var t=void 0,r=void 0,n="",i=0,a=e.length;i<a;){var o=e[i++];switch(o>>4){case 0:return n;case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(o);break;case 12:case 13:t=e[i++],n+=String.fromCharCode((31&o)<<6|63&t);break;case 14:t=e[i++],r=e[i++],n+=String.fromCharCode((15&o)<<12|(63&t)<<6|(63&r)<<0)}}return n}}]),e}();r.default=i},{}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(27),a=u(i),o=e(54),s=e(30),l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.remuxer=r}return n(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var i=a.default.getID3Data(e,0),o=90*a.default.getTimeStamp(i),s=i.length,u=e.length,c=0,d=0,f=this._audioTrack,h=[{pts:o,dts:o,data:i}];s<u;)if(l.default.isHeader(e,s)){var p=l.default.appendFrame(f,e,s,o,c);if(!p)break;s+=p.length,d=p.sample.pts,c++}else a.default.isHeader(e,s)?(i=a.default.getID3Data(e,s),h.push({pts:d,dts:d,data:i}),s+=i.length):s++;this.remuxer.remux(f,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=a.default.getID3Data(e,0);if(n&&void 0!==a.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(l.default.probe(e,t))return o.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),e}();r.default=c},{27:27,30:30,54:54}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=Math.pow(2,32)-1,s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.remuxer=r}return n(e,[{key:"resetTimeStamp",value:function(e){this.initPTS=e}},{key:"resetInitSegment",value:function(t,r,n,i){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t),s={};o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:i?t:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:i?t:null}),this.observer.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)}},{key:"append",value:function(t,r,n,i){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec),o=this.initData);var s=void 0,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(o,t);this.initPTS=l=u-r,this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,t,l),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,n,i,t)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(t){if(t.length>=8){var r=e.bin2str(t.subarray(4,8));return["moof","ftyp","styp"].indexOf(r)>=0}return!1}},{key:"bin2str",value:function(e){return String.fromCharCode.apply(null,e)}},{key:"readUint32",value:function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r}},{key:"writeUint32",value:function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}},{key:"findBox",value:function(t,r){var n,i,a,o,s,l,u,c=[];if(t.data?(l=t.start,o=t.end,t=t.data):(l=0,o=t.byteLength),!r.length)return null;for(n=l;n<o;)i=e.readUint32(t,n),a=e.bin2str(t.subarray(n+4,n+8)),u=i>1?n+i:o,a===r[0]&&(1===r.length?c.push({data:t,start:n+8,end:u}):(s=e.findBox({data:t,start:n+8,end:u},r.slice(1))).length&&(c=c.concat(s))),n=u;return c}},{key:"parseInitSegment",value:function(t){var r=[],n=e.findBox(t,["moov","trak"]);return n.forEach(function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var i=n.data[n.start],a=0===i?12:20,o=e.readUint32(n,a),s=e.findBox(t,["mdia","mdhd"])[0];if(s){i=s.data[s.start],a=0===i?12:20;var l=e.readUint32(s,a),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var c=e.bin2str(u.data.subarray(u.start+8,u.start+12)),d={soun:"audio",vide:"video"}[c];d&&(r[o]={timescale:l,type:d},r[d]={timescale:l,id:o})}}}}),r}},{key:"getStartDTS",value:function(t,r){var n,i,a;return n=e.findBox(r,["moof","traf"]),i=[].concat.apply([],n.map(function(r){return e.findBox(r,["tfhd"]).map(function(n){var i,a;return i=e.readUint32(n,4),a=t[i].timescale||9e4,(e.findBox(r,["tfdt"]).map(function(t){var r,n;return r=t.data[t.start],n=e.readUint32(t,4),1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n})[0]||1/0)/a})})),a=Math.min.apply(null,i),isFinite(a)?a:0}},{key:"offsetStartDTS",value:function(t,r,n){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var a=e.readUint32(i,4),s=t[a].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],i=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,i-n*s);else{i*=Math.pow(2,32),i+=e.readUint32(t,8),i-=n*s;var a=Math.floor(i/(o+1)),l=Math.floor(i%(o+1));e.writeUint32(t,4,a),e.writeUint32(t,8,l)}})})})}}]),e}();r.default=s},{35:35}],30:[function(e,t,r){"use strict";var n={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(e,t,r,n,i){if(!(r+24>t.length)){var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var o=10368e4/a.sampleRate,s=n+i*o,l={unit:t.subarray(r,r+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(l),e.len+=a.frameLength,{sample:l,length:a.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,a=e[t+2]>>4&15,o=e[t+2]>>2&3,s=!!(2&e[t+2]);if(1!==r&&0!==a&&15!==a&&3!==o){var l=3===r?3-i:3===i?3:4,u=1e3*n.BitratesMap[14*l+a-1],c=3===r?0:2===r?1:2,d=n.SamplingRateMap[3*c+o],f=s?1:0,h=e[t+3]>>6==3?1:2,p=3===i?(3===r?12:6)*u/d+f<<2:(3===r?144:72)*u/d+f|0;return{sampleRate:d,channelCount:h,frameLength:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var i=t+n;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}};t.exports=n},{}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(19),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.decryptdata=n,this.discardEPB=i,this.decrypter=new a.default(t,r)}return n(e,[{key:"decryptBuffer",value:function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)}},{key:"decryptAacSample",value:function(e,t,r,n){var i=e[t].unit,a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,function(a){a=new Uint8Array(a),i.set(a,16),n||s.decryptAacSamples(e,t+1,r)})}},{key:"decryptAacSamples",value:function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,i=32;i<=e.length-16;i+=160,n+=16)r.set(e.subarray(i,i+16),n);return r}},{key:"getAvcDecryptedUnit",value:function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e}},{key:"decryptAvcSample",value:function(e,t,r,n,i,a){var o=this.discardEPB(i.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,function(s){i.data=l.getAvcDecryptedUnit(o,s),a||l.decryptAvcSamples(e,t,r+1,n)})}},{key:"decryptAvcSamples",value:function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var i=e[t].units;!(r>=i.length);r++){var a=i[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,a,o),!o)return}}}}}]),e}();r.default=o},{19:19}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(22),a=g(i),o=e(30),s=g(o),l=e(35),u=g(l),c=e(26),d=g(c),f=e(31),h=g(f),p=e(54),v=e(33);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.typeSupported=i,this.remuxer=r,this.sampleAes=null}return n(e,[{key:"setDecryptData",value:function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new h.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:n,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=r,this._duration=n}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){var i,a,o,s,l,c=e.length,d=!1;this.contiguous=r;var f=this.pmtParsed,h=this._avcTrack,g=this._audioTrack,y=this._id3Track,m=h.id,b=g.id,_=y.id,E=this._pmtId,k=h.pesData,w=g.pesData,T=y.pesData,S=this._parsePAT,A=this._parsePMT,R=this._parsePES,x=this._parseAVCPES.bind(this),L=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),D=this._parseID3PES.bind(this);for(c-=c%188,i=0;i<c;i+=188)if(71===e[i]){if(a=!!(64&e[i+1]),o=((31&e[i+1])<<8)+e[i+2],(48&e[i+3])>>4>1){if((s=i+5+e[i+4])===i+188)continue}else s=i+4;switch(o){case m:a&&(k&&(l=R(k))&&x(l,!1),k={data:[],size:0}),k&&(k.data.push(e.subarray(s,i+188)),k.size+=i+188-s);break;case b:a&&(w&&(l=R(w))&&(g.isAAC?L(l):O(l)),w={data:[],size:0}),w&&(w.data.push(e.subarray(s,i+188)),w.size+=i+188-s);break;case _:a&&(T&&(l=R(T))&&D(l),T={data:[],size:0}),T&&(T.data.push(e.subarray(s,i+188)),T.size+=i+188-s);break;case 0:a&&(s+=e[s]+1),E=this._pmtId=S(e,s);break;case E:a&&(s+=e[s]+1);var P=A(e,s,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(m=P.avc)>0&&(h.id=m),(b=P.audio)>0&&(g.id=b,g.isAAC=P.isAAC),(_=P.id3)>0&&(y.id=_),d&&!f&&(p.logger.log("reparse from beginning"),d=!1,i=-188),f=this.pmtParsed=!0;break;case 17:case 8191:break;default:d=!0}}else this.observer.trigger(u.default.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});k&&(l=R(k))?(x(l,!0),h.pesData=null):h.pesData=k,w&&(l=R(w))?(g.isAAC?L(l):O(l),g.pesData=null):(w&&w.size&&p.logger.log("last AAC PES packet truncated,might overlap between fragments"),g.pesData=w),T&&(l=R(T))?(D(l),y.pesData=null):y.pesData=T,null==this.sampleAes?this.remuxer.remux(g,h,y,this._txtTrack,t,r,n):this.decryptAndRemux(g,h,y,this._txtTrack,t,r,n)}},{key:"decryptAndRemux",value:function(e,t,r,n,i,a,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,r,n,i,a,o)})}else this.decryptAndRemuxAvc(e,t,r,n,i,a,o)}},{key:"decryptAndRemuxAvc",value:function(e,t,r,n,i,a,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,r,n,i,a,o)})}else this.remuxer.remux(e,t,r,n,i,a,o)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,r,n){var i,a,o,s,l={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=(15&e[t+1])<<8|e[t+2],a=t+3+i-4,o=(15&e[t+10])<<8|e[t+11],t+=12+o;t<a;){switch(s=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){p.logger.log("unkown stream type:"+e[t]);break}case 15:-1===l.audio&&(l.audio=s);break;case 21:-1===l.id3&&(l.id3=s);break;case 219:if(!n){p.logger.log("unkown stream type:"+e[t]);break}case 27:-1===l.avc&&(l.avc=s);break;case 3:case 4:r?-1===l.audio&&(l.audio=s,l.isAAC=!1):p.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:p.logger.warn("HEVC stream type found, not supported for now");break;default:p.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return l}},{key:"_parsePES",value:function(e){var t,r,n,i,a,o,s,l,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var d=new Uint8Array(c[0].length+c[1].length);d.set(c[0]),d.set(c[1],c[0].length),c[0]=d,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(r=t[7])&&((o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(o-=8589934592),64&r?((s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(s-=8589934592),o-s>54e5&&(p.logger.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),i=t[8],l=i+9,e.size-=l,a=new Uint8Array(e.size);for(var f=0,h=c.length;f<h;f++){var v=(t=c[f]).byteLength;if(l){if(l>v){l-=v;continue}t=t.subarray(l),v-=l,l=0}a.set(t,u),u+=v}return n&&(n-=i+3),{data:a,pts:o,dts:s,len:n}}return null}},{key:"pushAccesUnit",value:function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&p.logger.log(e.pts+"/"+e.dts+":"+e.debug)}},{key:"_parseAVCPES",value:function(e,t){var r,n,i,a=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),l=this.avcSample,u=!1,c=this.pushAccesUnit.bind(this),f=function(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}};e.data=null,l&&s.length&&(c(l,o),l=this.avcSample=f(!1,e.pts,e.dts,"")),s.forEach(function(t){switch(t.type){case 1:n=!0,l.frame=!0;var s=t.data;if(u&&s.length>4){var h=new d.default(s).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=a.avcSample=f(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(r=new d.default(a.discardEPB(t.data))).readUByte();for(var p=0,v=0,g=!1,y=0;!g&&r.bytesAvailable>1;){p=0;do{y=r.readUByte(),p+=y}while(255===y);v=0;do{y=r.readUByte(),v+=y}while(255===y);if(4===p&&0!==r.bytesAvailable){g=!0;var m=r.readUByte();if(181===m){var b=r.readUShort();if(49===b){var _=r.readUInt();if(1195456820===_){var E=r.readUByte();if(3===E){var k=r.readUByte(),w=r.readUByte(),T=31&k,S=[k,w];for(i=0;i<T;i++)S.push(r.readUByte()),S.push(r.readUByte()),S.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:S})}}}}}else if(v<r.bytesAvailable)for(i=0;i<v;i++)r.readUByte()}break;case 7:if(n=!0,u=!0,!o.sps){var A=(r=new d.default(t.data)).readSPS();o.width=A.width,o.height=A.height,o.pixelRatio=A.pixelRatio,o.sps=[t.data],o.duration=a._duration;var R=t.data.subarray(1,4),x="avc1.";for(i=0;i<3;i++){var L=R[i].toString(16);L.length<2&&(L="0"+L),x+=L}o.codec=x}break;case 8:n=!0,o.pps||(o.pps=[t.data]);break;case 9:n=!1,l&&c(l,o),l=a.avcSample=f(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}if(l&&n){var O=l.units;O.push(t)}}),t&&l&&(c(l,o),this.avcSample=null)}},{key:"_insertSampleInOrder",value:function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var r=this._avcTrack,n=r.samples;e=n[n.length-1]}if(e){var i=e.units;t=i[i.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,r,n,i,a,o=0,s=e.byteLength,l=this._avcTrack,u=l.naluState||0,c=u,d=[],f=-1;for(-1===u&&(f=0,a=31&e[0],u=0,o=1);o<s;)if(t=e[o++],u)if(1!==u)if(t)if(1===t){if(f>=0)n={data:e.subarray(f,o-u-1),type:a},d.push(n);else{var h=this._getLastNalUnit();if(h&&(c&&o<=4-c&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-c)),(r=o-u-1)>0)){var p=new Uint8Array(h.data.byteLength+r);p.set(h.data,0),p.set(e.subarray(0,r),h.data.byteLength),h.data=p}}o<s?(i=31&e[o],f=o,a=i,u=0):u=-1}else u=0;else u=3;else u=t?0:2;else u=t?0:1;if(f>=0&&u>=0&&(n={data:e.subarray(f,s),type:a,state:u},d.push(n)),0===d.length){var v=this._getLastNalUnit();if(v){var g=new Uint8Array(v.data.byteLength+e.byteLength);g.set(v.data,0),g.set(e,v.data.byteLength),v.data=g}}return l.naluState=u,d}},{key:"discardEPB",value:function(e){for(var t,r,n=e.byteLength,i=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=n-i.length,r=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),r[a]=e[o];return r}},{key:"_parseAACPES",value:function(e){var t,r,n,i,o,s,l,c=this._audioTrack,d=e.data,f=e.pts,h=this.aacOverFlow,g=this.aacLastPTS;if(h){var y=new Uint8Array(h.byteLength+d.byteLength);y.set(h,0),y.set(d,h.byteLength),d=y}for(n=0,o=d.length;n<o-1&&!a.default.isHeader(d,n);n++);if(!n||(n<o-1?(s="AAC PES did not start with ADTS header,offset:"+n,l=!1):(s="no ADTS header found in AAC PES",l=!0),p.logger.warn("parsing error:"+s),this.observer.trigger(u.default.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:l,reason:s}),!l)){if(a.default.initTrackConfig(c,this.observer,d,n,this.audioCodec),r=0,t=a.default.getFrameDuration(c.samplerate),h&&g){var m=g+t;Math.abs(m-f)>1&&(p.logger.log("AAC: align PTS for overlapping frames by "+Math.round((m-f)/90)),f=m)}for(;n<o;)if(a.default.isHeader(d,n)&&n+5<o){var b=a.default.appendFrame(c,d,n,f,r);if(!b)break;n+=b.length,i=b.sample.pts,r++}else n++;h=n<o?d.subarray(n,o):null,this.aacOverFlow=h,this.aacLastPTS=i}}},{key:"_parseMPEGPES",value:function(e){for(var t=e.data,r=t.length,n=0,i=0,a=e.pts;i<r;)if(s.default.isHeader(t,i)){var o=s.default.appendFrame(this._audioTrack,t,i,a,n);if(!o)break;i+=o.length,n++}else i++}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();r.default=y},{22:22,26:26,30:30,31:31,33:33,35:35,54:54}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e(54),o=e(33),s=e(35),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return i(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===n(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)},this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){a.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();r.default=u},{33:33,35:35,54:54}],35:[function(e,t,r){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();r.default=i},{}],37:[function(e,t,r){"use strict";var n={isBuffered:function(e,t){if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0;return!1},bufferInfo:function(e,t,r){if(e){var n,i=e.buffered,a=[];for(n=0;n<i.length;n++)a.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(a,t,r)}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,r){var n,i,a,o,s,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),s=0;s<e.length;s++){var u=l.length;if(u){var c=l[u-1].end;e[s].start-c<r?e[s].end>c&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,n=0,i=a=t;s<l.length;s++){var d=l[s].start,f=l[s].end;if(t+r>=d&&t<f)i=d,n=(a=f)-t;else if(t+r<d){o=d;break}}return{len:n,start:i,end:a,nextStart:o}}};t.exports=n},{}],38:[function(e,t,r){"use strict";var n=e(54),i={mergeDetails:function(e,t){var r,a=Math.max(e.startSN,t.startSN)-t.startSN,o=Math.min(e.endSN,t.endSN)-t.startSN,s=t.startSN-e.startSN,l=e.fragments,u=t.fragments,c=0;if(o<a)t.PTSKnown=!1;else{for(var d=a;d<=o;d++){var f=l[s+d],h=u[d];h&&f&&(c=f.cc-h.cc,isNaN(f.startPTS)||(h.start=h.startPTS=f.startPTS,h.endPTS=f.endPTS,h.duration=f.duration,h.backtracked=f.backtracked,h.dropped=f.dropped,r=h))}if(c)for(n.logger.log("discontinuity sliding from playlist, take drift into account"),d=0;d<u.length;d++)u[d].cc+=c;if(r)i.updateFragPTSDTS(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(s>=0&&s<l.length){var p=l[s].start;for(d=0;d<u.length;d++)u[d].start+=p}t.PTSKnown=e.PTSKnown}},updateFragPTSDTS:function(e,t,r,n,a,o){var s=r;if(!isNaN(t.startPTS)){var l=Math.abs(t.startPTS-r);isNaN(t.deltaPTS)?t.deltaPTS=l:t.deltaPTS=Math.max(l,t.deltaPTS),s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),n=Math.max(n,t.endPTS),a=Math.min(a,t.startDTS),o=Math.max(o,t.endDTS)}var u=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=n,t.startDTS=a,t.endDTS=o,t.duration=n-r;var c,d,f,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;for(c=h-e.startSN,(d=e.fragments)[c]=t,f=c;f>0;f--)i.updatePTS(d,f,f-1);for(f=c;f<d.length-1;f++)i.updatePTS(d,f,f+1);return e.PTSKnown=!0,u},updatePTS:function(e,t,r){var i=e[t],a=e[r],o=a.startPTS;isNaN(o)?a.start=r>t?i.start+i.duration:Math.max(i.start-a.duration,0):r>t?(i.duration=o-i.start,i.duration<0&&n.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(a.duration=i.start-o,a.duration<0&&n.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!"))}};t.exports=i},{54:54}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(2),a=S(i),o=e(35),s=S(o),l=e(33),u=e(43),c=S(u),d=e(41),f=S(d),h=e(42),p=S(h),v=e(13),g=S(v),y=e(12),m=S(y),b=e(11),_=S(b),E=e(54),k=e(1),w=S(k),T=e(4);function S(e){return e&&e.__esModule?e:{default:e}}var A=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=e.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var i in n)i in r||(r[i]=n[i]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,E.enableLogs)(r.debug),this.config=r,this._autoLevelCapping=-1;var a=this.observer=new w.default;a.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.emit.apply(a,[e,e].concat(r))},a.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.removeListener.apply(a,[e].concat(r))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.trigger=a.trigger.bind(a);var o=this.abrController=new r.abrController(this),s=new r.bufferController(this),l=new r.capLevelController(this),u=new r.fpsController(this),d=new c.default(this),h=new f.default(this),v=new p.default(this),y=new _.default(this),b=this.levelController=new m.default(this),k=this.streamController=new g.default(this),T=[b,k],S=r.audioStreamController;S&&T.push(new S(this)),this.networkControllers=T;var A=[d,h,v,o,s,l,u,y];if(S=r.audioTrackController){var R=new S(this);this.audioTrackController=R,A.push(R)}if(S=r.subtitleTrackController){var x=new S(this);this.subtitleTrackController=x,A.push(x)}[r.subtitleStreamController,r.timelineController].forEach(function(e){e&&A.push(new e(t))}),this.coreComponents=A}return n(e,null,[{key:"isSupported",value:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return r&&n}},{key:"version",get:function(){return"0.7.11"}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:T.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}]),n(e,[{key:"destroy",value:function(){E.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(e){E.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){E.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){e=a.default.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),E.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;E.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})}},{key:"stopLoad",value:function(){E.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})}},{key:"swapAudioCodec",value:function(){E.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){E.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){E.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){E.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){E.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){E.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){E.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){E.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,n=0;n<r;n++){var i=e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate;if(i>t)return n}return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}}]),e}();r.default=A},{1:1,11:11,12:12,13:13,2:2,33:33,35:35,4:4,41:41,42:42,43:43,54:54}],40:[function(e,t,r){"use strict";t.exports=e(39).default},{39:39}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=c(i),o=e(34),s=c(o),l=e(33),u=e(54);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FRAG_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},s.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=this.hls.config;t.loaded=0,n&&(u.logger.warn("abort previous fragment loader for type:"+r),n.abort()),n=this.loaders[r]=t.loader=void 0!==i.fLoader?new i.fLoader(i):new i.loader(i);var a=void 0,o=void 0,s=void 0;a={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,c=t.byteRangeEndOffset;isNaN(l)||isNaN(c)||(a.rangeStart=l,a.rangeEnd=c),o={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(a,o,s)}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,o=r.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(a.default.FRAG_LOADED,{payload:i,frag:o,stats:t,networkDetails:n})}},{key:"loaderror",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})}},{key:"loadtimeout",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})}},{key:"loadprogress",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.frag;i.loaded=e.loaded,this.hls.trigger(a.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:n})}}]),t}(s.default);r.default=d},{33:33,34:34,35:35,54:54}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=c(i),o=e(34),s=c(o),l=e(33),u=e(54);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.KEY_LOADING));return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},s.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=t.decryptdata,o=i.uri;if(o!==this.decrypturl||null===this.decryptkey){var s=this.hls.config;n&&(u.logger.warn("abort previous key loader for type:"+r),n.abort()),t.loader=this.loaders[r]=new s.loader(s),this.decrypturl=o,this.decryptkey=null;var l=void 0,c=void 0,d=void 0;l={url:o,frag:t,responseType:"arraybuffer"},c={timeout:s.fragLoadingTimeOut,maxRetry:s.fragLoadingMaxRetry,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(l,c,d)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(a.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(a.default.KEY_LOADED,{frag:n})}},{key:"loaderror",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})}},{key:"loadtimeout",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})}}]),t}(s.default);r.default=d},{33:33,34:34,35:35,54:54}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(2),a=p(i),o=e(35),s=p(o),l=e(34),u=p(l),c=e(33),d=e(47),f=p(d),h=e(54);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var g=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,y=/#EXT-X-MEDIA:(.*)/g,m=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),b=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,_=function(){function e(){v(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return n(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=a.default.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),E=function(){function e(){v(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return n(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new _).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=a.default.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),k=function(e){function t(e){v(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s.default.MANIFEST_LOADING,s.default.LEVEL_LOADING,s.default.AUDIO_TRACK_LOADING,s.default.SUBTITLE_TRACK_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},u.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"onSubtitleTrackLoading",value:function(e){this.load(e.url,{type:"subtitleTrack",id:e.id})}},{key:"load",value:function(e,t){var r=this.loaders[t.type];if(r){var n=r.context;if(n&&n.url===e)return void h.logger.trace("playlist request ongoing");h.logger.warn("abort previous loader for type:"+t.type),r.abort()}var i=this.hls.config,a=void 0,o=void 0,s=void 0,l=void 0;"manifest"===t.type?(a=i.manifestLoadingMaxRetry,o=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,l=i.manifestLoadingMaxRetryTimeout):(a=i.levelLoadingMaxRetry,o=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,l=i.levelLoadingMaxRetryTimeout,h.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),r=this.loaders[t.type]=t.loader=void 0!==i.pLoader?new i.pLoader(i):new i.loader(i),t.url=e,t.responseType="";var u=void 0,c=void 0;u={timeout:o,maxRetry:a,retryDelay:s,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(t,u,c)}},{key:"resolve",value:function(e,t){return a.default.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(e,t){var r=[],n=void 0;for(g.lastIndex=0;null!=(n=g.exec(e));){var i={},a=i.attrs=new f.default(n[1]);i.url=this.resolve(n[2],t);var o=a.decimalResolution("RESOLUTION");o&&(i.width=o.width,i.height=o.height),i.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),i.name=a.NAME;var s=a.CODECS;if(s){s=s.split(/[ ,]+/);for(var l=0;l<s.length;l++){var u=s[l];-1!==u.indexOf("avc1")?i.videoCodec=this.avc1toavcoti(u):-1!==u.indexOf("hvc1")?i.videoCodec=u:i.audioCodec=u}}r.push(i)}return r}},{key:"parseMasterPlaylistMedia",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=void 0,a=[],o=0;for(y.lastIndex=0;null!=(i=y.exec(e));){var s={},l=new f.default(i[1]);l.TYPE===r&&(s.groupId=l["GROUP-ID"],s.name=l.NAME,s.type=r,s.default="YES"===l.DEFAULT,s.autoselect="YES"===l.AUTOSELECT,s.forced="YES"===l.FORCED,l.URI&&(s.url=this.resolve(l.URI,t)),s.lang=l.LANGUAGE,s.name||(s.name=s.lang),n&&(s.audioCodec=n),s.id=o++,a.push(s))}return a}},{key:"avc1toavcoti",value:function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,r,n){var i,a,o=0,s=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},u=new _,c=0,d=null,p=new E;for(m.lastIndex=0;null!==(i=m.exec(e));){var v=i[1];if(v){p.duration=parseFloat(v);var g=(" "+i[2]).slice(1);p.title=g||null,p.tagList.push(g?["INF",v,g]:["INF",v])}else if(i[3]){if(!isNaN(p.duration)){var y=o++;p.type=n,p.start=s,p.levelkey=u,p.sn=y,p.level=r,p.cc=c,p.baseurl=t,p.relurl=(" "+i[3]).slice(1),l.fragments.push(p),d=p,s+=p.duration,p=new E}}else if(i[4]){if(p.rawByteRange=(" "+i[4]).slice(1),d){var k=d.byteRangeEndOffset;k&&(p.lastByteRangeEndOffset=k)}}else if(i[5])p.rawProgramDateTime=(" "+i[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]);else{for(i=i[0].match(b),a=1;a<i.length&&void 0===i[a];a++);var w=(" "+i[a+1]).slice(1),T=(" "+i[a+2]).slice(1);switch(i[a]){case"#":p.tagList.push(T?[w,T]:[w]);break;case"PLAYLIST-TYPE":l.type=w.toUpperCase();break;case"MEDIA-SEQUENCE":o=l.startSN=parseInt(w);break;case"TARGETDURATION":l.targetduration=parseFloat(w);break;case"VERSION":l.version=parseInt(w);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":c++,p.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(w);break;case"KEY":var S=w,A=new f.default(S),R=A.enumeratedString("METHOD"),x=A.URI,L=A.hexadecimalInteger("IV");R&&(u=new _,x&&["AES-128","SAMPLE-AES"].indexOf(R)>=0&&(u.method=R,u.baseuri=t,u.reluri=x,u.key=null,u.iv=L));break;case"START":var O=w,D=new f.default(O),P=D.decimalFloatingPoint("TIME-OFFSET");isNaN(P)||(l.startTimeOffset=P);break;case"MAP":var I=new f.default(w);p.relurl=I.URI,p.rawByteRange=I.BYTERANGE,p.baseurl=t,p.level=r,p.type=n,p.sn="initSegment",l.initSegment=p,p=new E;break;default:h.logger.warn("line parsed but not handled: "+i)}}}return(p=d)&&!p.relurl&&(l.fragments.pop(),s-=p.duration),l.totalduration=s,l.averagetargetduration=s/l.fragments.length,l.endSN=o-1,l}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,a=e.url,o=r.type,l=r.id,u=r.level,d=this.hls;if(this.loaders[o]=void 0,void 0!==a&&0!==a.indexOf("data:")||(a=r.url),t.tload=performance.now(),0===i.indexOf("#EXTM3U"))if(i.indexOf("#EXTINF:")>0){var f="audioTrack"!==o&&"subtitleTrack"!==o,p=isNaN(u)?isNaN(l)?0:l:u,v=this.parseLevelPlaylist(i,a,p,"audioTrack"===o?"audio":"subtitleTrack"===o?"subtitle":"main");v.tload=t.tload,"manifest"===o&&d.trigger(s.default.MANIFEST_LOADED,{levels:[{url:a,details:v}],audioTracks:[],url:a,stats:t,networkDetails:n}),t.tparsed=performance.now(),v.targetduration?f?d.trigger(s.default.LEVEL_LOADED,{details:v,level:u||0,id:l||0,stats:t,networkDetails:n}):"audioTrack"===o?d.trigger(s.default.AUDIO_TRACK_LOADED,{details:v,id:l,stats:t,networkDetails:n}):"subtitleTrack"===o&&d.trigger(s.default.SUBTITLE_TRACK_LOADED,{details:v,id:l,stats:t,networkDetails:n}):d.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a,reason:"invalid targetduration",networkDetails:n})}else{var g=this.parseMasterPlaylist(i,a);if(g.length){var y=this.parseMasterPlaylistMedia(i,a,"AUDIO",g[0].audioCodec),m=this.parseMasterPlaylistMedia(i,a,"SUBTITLES");if(y.length){var b=!1;y.forEach(function(e){e.url||(b=!0)}),!1===b&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(h.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main"}))}d.trigger(s.default.MANIFEST_LOADED,{levels:g,audioTracks:y,subtitles:m,url:a,stats:t,networkDetails:n})}else d.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a,reason:"no level found in manifest",networkDetails:n})}else d.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a,reason:"no EXTM3U delimiter",networkDetails:n})}},{key:"loaderror",value:function(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.loader;switch(t.type){case"manifest":r=c.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case"level":r=c.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":r=c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1}a&&(a.abort(),this.loaders[t.type]=void 0),this.hls.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:a.url,loader:a,response:e,context:t,networkDetails:i})}},{key:"loadtimeout",value:function(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.loader;switch(t.type){case"manifest":r=c.ErrorDetails.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":r=c.ErrorDetails.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":r=c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}a&&(a.abort(),this.loaders[t.type]=void 0),this.hls.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:a.url,loader:a,context:t,networkDetails:i})}}]),t}(u.default);r.default=k},{2:2,33:33,34:34,35:35,47:47,54:54}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=Math.pow(2,32)-1,a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i;i--;)n+=r[i].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),i=0,n=8;i<a;i++)t.set(r[i],n),n+=r[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){r*=t;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))}},{key:"moov",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,r){r*=t;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)}},{key:"sdtp",value:function(t){var r,n,i=t.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,a[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,n,i,a=[],o=[];for(r=0;r<t.sps.length;r++)n=t.sps[r],i=n.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)n=t.pps[r],i=n.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var r=t.id,n=t.duration*t.timescale,a=t.width,o=t.height,s=Math.floor(n/(i+1)),l=Math.floor(n%(i+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,r){var n=e.sdtp(t),a=t.id,o=Math.floor(r/(i+1)),s=Math.floor(r%(i+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var n,i,a,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,f=new Uint8Array(d);for(r+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)i=u[n],a=i.duration,o=i.size,s=i.flags,l=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var r,n=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),r.set(n,e.FTYP.byteLength),r}}]),e}();r.default=a},{}],45:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(36),a=f(i),o=e(35),s=f(o),l=e(54),u=e(44),c=f(u),d=e(33);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.typeSupported=n;var a=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return n(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this._initPTS=this._initDTS=e}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,n,i,a,o){if(this.ISGenerated){if(o){var u=this._initPTS,c=this._PTSNormalize,d=e.inputTimeScale||t.inputTimeScale,f=1/0,h=1/0,p=e.samples;if(p.length&&(f=h=c(p[0].pts-d*i,u)),(p=t.samples).length){var v=p[0];f=Math.min(f,c(v.pts-d*i,u)),h=Math.min(h,c(v.dts-d*i,u))}if(f!==1/0){var g=u-f;Math.abs(g)>10*d&&(l.logger.warn("timestamp inconsistency, "+(g/d).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=f,this._initDTS=h,this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:f}))}}}else this.generateIS(e,t,i);if(this.ISGenerated)if(e.samples.length){e.timescale||(l.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,i));var y=this.remuxAudio(e,i,a,o);if(t.samples.length){var m=void 0;y&&(m=y.endPTS-y.startPTS),t.timescale||(l.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,i)),this.remuxVideo(t,i,a,m,o)}}else{var b=void 0;t.samples.length&&(b=this.remuxVideo(t,i,a,o)),b&&e.codec&&this.remuxEmptyAudio(e,i,a,b)}r.samples.length&&this.remuxID3(r,i),n.samples.length&&this.remuxText(n,i),this.observer.trigger(s.default.FRAG_PARSED)}},{key:"generateIS",value:function(e,t,r){var n,i,a=this.observer,o=e.samples,u=t.samples,f=this.typeSupported,h="audio/mp4",p={},v={tracks:p},g=void 0===this._initPTS;if(g&&(n=i=1/0),e.config&&o.length&&(e.timescale=e.samplerate,l.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(f.mpeg?(h="audio/mpeg",e.codec=""):f.mp3&&(e.codec="mp3")),p.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&f.mpeg?new Uint8Array:c.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(n=i=o[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&u.length){var y=t.inputTimeScale;t.timescale=y,p.video={container:"video/mp4",codec:t.codec,initSegment:c.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(n=Math.min(n,u[0].pts-y*r),i=Math.min(i,u[0].dts-y*r),this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(p).length?(a.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,v),this.ISGenerated=!0,g&&(this._initPTS=n,this._initDTS=i)):a.trigger(s.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,r,n,i){var a,o,u,f,h,p,v,g=8,y=e.timescale,m=e.samples,b=[],_=m.length,E=this._PTSNormalize,k=this._initDTS,w=this.nextAvcDts,T=this.isSafari;T&&(r|=m.length&&w&&(i&&Math.abs(t-w/y)<.1||Math.abs(m[0].pts-w-k)<y/5)),r||(w=t*y),m.forEach(function(e){e.pts=E(e.pts-k,w),e.dts=E(e.dts-k,w)}),m.sort(function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id});var S=m.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(S<0){l.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(S/90)+" ms to overcome this issue");for(var A=0;A<m.length;A++)m[A].dts+=S}var R=m[0];h=Math.max(R.dts,0),f=Math.max(R.pts,0);var x=Math.round((h-w)/90);r&&x&&(x>1?l.logger.log("AVC:"+x+" ms hole between fragments detected,filling it"):x<-1&&l.logger.log("AVC:"+-x+" ms overlapping between fragments detected"),h=w,m[0].dts=h,f=Math.max(f-x,w),m[0].pts=f,l.logger.log("Video/PTS/DTS adjusted: "+Math.round(f/90)+"/"+Math.round(h/90)+",delta:"+x+" ms")),R=m[m.length-1],v=Math.max(R.dts,0),p=Math.max(R.pts,0,v),T&&(a=Math.round((v-h)/(m.length-1)));for(var L=0,O=0,D=0;D<_;D++){for(var P=m[D],I=P.units,C=I.length,M=0,F=0;F<C;F++)M+=I[F].data.length;O+=M,L+=C,P.length=M,P.dts=T?h+D*a:Math.max(P.dts,h),P.pts=Math.max(P.pts,P.dts)}var N=O+4*L+8;try{o=new Uint8Array(N)}catch(e){return void this.observer.trigger(s.default.ERROR,{type:d.ErrorTypes.MUX_ERROR,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var U=new DataView(o.buffer);U.setUint32(0,N),o.set(c.default.types.mdat,4);for(var B=0;B<_;B++){for(var j=m[B],G=j.units,H=0,W=void 0,K=0,V=G.length;K<V;K++){var z=G[K],q=z.data,Y=z.data.byteLength;U.setUint32(g,Y),g+=4,o.set(q,g),g+=Y,H+=4+Y}if(T)W=Math.max(0,a*Math.round((j.pts-j.dts)/a));else{if(B<_-1)a=m[B+1].dts-j.dts;else{var X=this.config,$=j.dts-m[B>0?B-1:B].dts;if(X.stretchShortVideoTrack){var J=X.maxBufferHole,Q=X.maxSeekHole,Z=Math.floor(Math.min(J,Q)*y),ee=(n?f+n*y:this.nextAudioPts)-j.pts;ee>Z?((a=ee-$)<0&&(a=$),l.logger.log("It is approximately "+ee/90+" ms to the next segment; using duration "+a/90+" ms for the last video frame.")):a=$}else a=$}W=Math.round(j.pts-j.dts)}b.push({size:H,duration:a,cts:W,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:j.key?2:1,isNonSync:j.key?0:1}})}this.nextAvcDts=v+a;var te=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var re=b[0].flags;re.dependsOn=2,re.isNonSync=0}e.samples=b,u=c.default.moof(e.sequenceNumber++,h,e),e.samples=[];var ne={data1:u,data2:o,startPTS:f/y,endPTS:(p+a)/y,startDTS:h/y,endDTS:this.nextAvcDts/y,type:"video",nb:b.length,dropped:te};return this.observer.trigger(s.default.FRAG_PARSING_DATA,ne),ne}},{key:"remuxAudio",value:function(e,t,r,n){var i,o,u,f,h,p,v,g=e.inputTimeScale,y=e.timescale,m=g/y,b=e.isAAC?1024:1152,_=b*m,E=this._PTSNormalize,k=this._initDTS,w=!e.isAAC&&this.typeSupported.mpeg,T=e.samples,S=[],A=this.nextAudioPts;if((r|=T.length&&A&&(n&&Math.abs(t-A/g)<.1||Math.abs(T[0].pts-A-k)<20*_))||(A=t*g),T.forEach(function(e){e.pts=e.dts=E(e.pts-k,A)}),T.sort(function(e,t){return e.pts-t.pts}),n&&e.isAAC)for(var R=0,x=A;R<T.length;){var L,O=T[R],D=O.pts;L=D-x;var P=Math.abs(1e3*L/g);if(L<=-_)l.logger.warn("Dropping 1 audio frame @ "+(x/g).toFixed(3)+"s due to "+P+" ms overlap."),T.splice(R,1),e.len-=O.unit.length;else if(L>=_&&P<1e4&&x){var I=Math.round(L/_);l.logger.warn("Injecting "+I+" audio frame @ "+(x/g).toFixed(3)+"s due to "+Math.round(1e3*L/g)+" ms gap.");for(var C=0;C<I;C++){var M=Math.max(x,0);(u=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),u=O.unit.subarray()),T.splice(R,0,{unit:u,pts:M,dts:M}),e.len+=u.length,x+=_,R++}O.pts=O.dts=x,x+=_,R++}else Math.abs(L),O.pts=O.dts=x,x+=_,R++}for(var F=0,N=T.length;F<N;F++){var U=T[F],B=U.unit,j=U.pts;if(void 0!==v)o.duration=Math.round((j-v)/m);else{var G=Math.round(1e3*(j-A)/g),H=0;if(r&&e.isAAC&&G){if(G>0&&G<1e4)H=Math.round((j-A)/_),l.logger.log(G+" ms hole between AAC samples detected,filling it"),H>0&&((u=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(u=B.subarray()),e.len+=H*u.length);else if(G<-12){l.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(A/g).toFixed(3)+"s/"+(j/g).toFixed(3)+"s/"+-G+"ms"),e.len-=B.byteLength;continue}j=A}if(p=Math.max(0,j),!(e.len>0))return;var W=w?e.len:e.len+8;i=w?0:8;try{f=new Uint8Array(W)}catch(e){return void this.observer.trigger(s.default.ERROR,{type:d.ErrorTypes.MUX_ERROR,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:W,reason:"fail allocating audio mdat "+W})}if(!w){var K=new DataView(f.buffer);K.setUint32(0,W),f.set(c.default.types.mdat,4)}for(var V=0;V<H;V++)(u=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),u=B.subarray()),f.set(u,i),i+=u.byteLength,o={size:u.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(o)}f.set(B,i);var z=B.byteLength;i+=z,o={size:z,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(o),v=j}var q=0,Y=S.length;if(Y>=2&&(q=S[Y-2].duration,o.duration=q),Y){this.nextAudioPts=A=v+m*q,e.len=0,e.samples=S,h=w?new Uint8Array:c.default.moof(e.sequenceNumber++,p/m,e),e.samples=[];var X=p/g,$=A/g,J={data1:h,data2:f,startPTS:X,endPTS:$,startDTS:X,endDTS:$,type:"audio",nb:Y};return this.observer.trigger(s.default.FRAG_PARSING_DATA,J),J}return null}},{key:"remuxEmptyAudio",value:function(e,t,r,n){var i=e.inputTimeScale,o=e.samplerate?e.samplerate:i,s=i/o,u=this.nextAudioPts,c=(void 0!==u?u:n.startDTS*i)+this._initDTS,d=n.endDTS*i+this._initDTS,f=1024*s,h=Math.ceil((d-c)/f),p=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(l.logger.warn("remux empty Audio"),p){for(var v=[],g=0;g<h;g++){var y=c+g*f;v.push({unit:p,pts:y,dts:y}),e.len+=p.length}e.samples=v,this.remuxAudio(e,t,r)}else l.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")}},{key:"remuxID3",value:function(e,t){var r,n=e.samples.length,i=e.inputTimeScale,a=this._initPTS,o=this._initDTS;if(n){for(var l=0;l<n;l++)(r=e.samples[l]).pts=(r.pts-a)/i,r.dts=(r.dts-o)/i;this.observer.trigger(s.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var r,n=e.samples.length,i=e.inputTimeScale,a=this._initPTS;if(n){for(var o=0;o<n;o++)(r=e.samples[o]).pts=(r.pts-a)/i;this.observer.trigger(s.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}}]),e}();r.default=h},{33:33,35:35,36:36,44:44,54:54}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(35),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t}return n(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(e,t,r,n,i,o,s,l){var u=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),u.trigger(a.default.FRAG_PARSING_DATA,{data1:l,startPTS:i,startDTS:i,type:c,nb:1,dropped:0}),u.trigger(a.default.FRAG_PARSED)}}]),e}();r.default=o},{35:35}],47:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}return n(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=i.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,r={};for(a.lastIndex=0;null!==(t=a.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r}}]),e}();r.default=o},{}],48:[function(e,t,r){"use strict";t.exports={search:function(e,t){for(var r=0,n=e.length-1,i=null,a=null;r<=n;){a=e[i=(r+n)/2|0];var o=t(a);if(o>0)r=i+1;else{if(!(o<0))return a;n=i-1}}return null}}},{}],49:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(e){var t=e;return a.hasOwnProperty(e)&&(t=a[e]),String.fromCharCode(t)},s=15,l=100,u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},c={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},h=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],p={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(e){this.time=e},log:function(e,t){var r=this.verboseFilter[e];this.verboseLevel>=r&&console.log(this.time+" ["+e+"] "+t)}},v=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},g=function(){function e(t,r,n,a,o){i(this,e),this.foreground=t||"white",this.underline=r||!1,this.italics=n||!1,this.background=a||"black",this.flash=o||!1}return n(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),y=function(){function e(t,r,n,a,o,s){i(this,e),this.uchar=t||" ",this.penState=new g(r,n,a,o,s)}return n(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),m=function(){function e(){i(this,e),this.chars=[];for(var t=0;t<l;t++)this.chars.push(new y);this.pos=0,this.currPenState=new g}return n(e,[{key:"equals",value:function(e){for(var t=!0,r=0;r<l;r++)if(!this.chars[r].equals(e.chars[r])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<l;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<l;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(p.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>l&&(p.log("ERROR","Too large cursor position "+this.pos),this.pos=l)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){e>=144&&this.backSpace();var t=o(e);this.pos>=l?p.log("ERROR","Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<l;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,r=0;r<l;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e);var t=this.chars[this.pos];t.setPenState(this.currPenState)}}]),e}(),b=function(){function e(){i(this,e),this.rows=[];for(var t=0;t<s;t++)this.rows.push(new m);this.currRow=s-1,this.nrRollUpRows=null,this.reset()}return n(e,[{key:"reset",value:function(){for(var e=0;e<s;e++)this.rows[e].clear();this.currRow=s-1}},{key:"equals",value:function(e){for(var t=!0,r=0;r<s;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<s;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<s;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){var e=this.rows[this.currRow];e.backSpace()}},{key:"clearToEndOfRow",value:function(){var e=this.rows[this.currRow];e.clearToEndOfRow()}},{key:"insertChar",value:function(e){var t=this.rows[this.currRow];t.insertChar(e)}},{key:"setPen",value:function(e){var t=this.rows[this.currRow];t.setPenStyles(e)}},{key:"moveCursor",value:function(e){var t=this.rows[this.currRow];t.moveCursor(e)}},{key:"setCursor",value:function(e){p.log("INFO","setCursor: "+e);var t=this.rows[this.currRow];t.setCursor(e)}},{key:"setPAC",value:function(e){p.log("INFO","pacData = "+JSON.stringify(e));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<s;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var a=i.rows[n].cueStartTime;if(a&&a<p.time)for(var o=0;o<this.nrRollUpRows;o++)this.rows[t-this.nrRollUpRows+o+1].copy(i.rows[n+o])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var d={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(d)}},{key:"setBkgData",value:function(e){p.log("INFO","bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){if(null!==this.nrRollUpRows){p.log("TEXT",this.getDisplayText());var e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),p.log("INFO","Rolling up")}else p.log("DEBUG","roll_up but nrRollUpRows not set yet")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],r="",n=-1,i=0;i<s;i++){var a=this.rows[i].getTextString();a&&(n=i+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),_=function(){function e(t,r){i(this,e),this.chNr=t,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new b,this.nonDisplayedMemory=new b,this.lastOutputScreen=new b,this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}return n(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[s-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,p.log("INFO","MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";p.log("INFO",r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(p.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}},{key:"ccRCL",value:function(){p.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){p.log("INFO","BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){p.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){p.log("INFO","RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){p.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){p.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){p.log("INFO","TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){p.log("INFO","RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){p.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()}},{key:"ccCR",value:function(){p.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()}},{key:"ccENM",value:function(){p.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){if(p.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,p.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()}},{key:"ccTO",value:function(e){p.log("INFO","TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}p.log("INFO","MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=p.time;null!==e&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(e,this.displayedMemory),null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),E=function(){function e(t,r,n){i(this,e),this.field=t||1,this.outputs=[r,n],this.channels=[new _(1,r),new _(2,n)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}}return n(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var r,n,i,a=!1;this.lastTime=e,p.setTime(e);for(var o=0;o<t.length;o+=2)if(n=127&t[o],i=127&t[o+1],0!==n||0!==i){if(p.log("DATA","["+v([t[o],t[o+1]])+"] -> ("+v([n,i])+")"),(r=this.parseCmd(n,i))||(r=this.parseMidrow(n,i)),r||(r=this.parsePAC(n,i)),r||(r=this.parseBackgroundAttributes(n,i)),!r&&(a=this.parseChars(n,i)))if(this.currChNr&&this.currChNr>=0){var s=this.channels[this.currChNr-1];s.insertChars(a)}else p.log("WARNING","No channel found yet. TEXT-MODE?");r?this.dataCounters.cmd+=2:a?this.dataCounters.char+=2:(this.dataCounters.other+=2,p.log("WARNING","Couldn't parse cleaned data "+v([n,i])+" orig: "+v([t[o],t[o+1]])))}else this.dataCounters.padding+=2}},{key:"parseCmd",value:function(e,t){var r=null,n=(20===e||28===e)&&32<=t&&t<=47,i=(23===e||31===e)&&33<=t&&t<=35;if(!n&&!i)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,p.log("DEBUG","Repeated command ("+v([e,t])+") is dropped"),!0;r=20===e||23===e?1:2;var a=this.channels[r-1];return 20===e||28===e?32===t?a.ccRCL():33===t?a.ccBS():34===t?a.ccAOF():35===t?a.ccAON():36===t?a.ccDER():37===t?a.ccRU(2):38===t?a.ccRU(3):39===t?a.ccRU(4):40===t?a.ccFON():41===t?a.ccRDC():42===t?a.ccTR():43===t?a.ccRTD():44===t?a.ccEDM():45===t?a.ccCR():46===t?a.ccENM():47===t&&a.ccEOC():a.ccTO(t-32),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0}},{key:"parseMidrow",value:function(e,t){var r=null;if((17===e||25===e)&&32<=t&&t<=47){if((r=17===e?1:2)!==this.currChNr)return p.log("ERROR","Mismatch channel in midrow parsing"),!1;var n=this.channels[r-1];return n.ccMIDROW(t),p.log("DEBUG","MIDROW ("+v([e,t])+")"),!0}return!1}},{key:"parsePAC",value:function(e,t){var r=null,n=null,i=(17<=e&&e<=23||25<=e&&e<=31)&&64<=t&&t<=127,a=(16===e||24===e)&&64<=t&&t<=95;if(!i&&!a)return!1;if(e===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,this.lastCmdB=null,!0;r=e<=23?1:2,n=64<=t&&t<=95?1===r?u[e]:d[e]:1===r?c[e]:f[e];var o=this.interpretPAC(n,t),s=this.channels[r-1];return s.setPAC(o),this.lastCmdA=e,this.lastCmdB=t,this.currChNr=r,!0}},{key:"interpretPAC",value:function(e,t){var r=t,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n}},{key:"parseChars",value:function(e,t){var r=null,n=null,i=null;if(e>=25?(r=2,i=e-8):(r=1,i=e),17<=i&&i<=19){var a=t;a=17===i?t+80:18===i?t+112:t+144,p.log("INFO","Special char '"+o(a)+"' in channel "+r),n=[a]}else 32<=e&&e<=127&&(n=0===t?[e]:[e,t]);if(n){var s=v(n);p.log("DEBUG","Char codes =  "+s.join(",")),this.lastCmdA=null,this.lastCmdB=null}return n}},{key:"parseBackgroundAttributes",value:function(e,t){var r,n,i,a=(16===e||24===e)&&32<=t&&t<=47,o=(23===e||31===e)&&45<=t&&t<=47;return!(!a&&!o||(r={},16===e||24===e?(n=Math.floor((t-32)/2),r.background=h[n],t%2==1&&(r.background=r.background+"_semi")):45===t?r.background="transparent":(r.foreground="black",47===t&&(r.underline=!0)),i=e<24?1:2,this.channels[i-1].setBkgData(r),this.lastCmdA=null,this.lastCmdB=null,0))}},{key:"reset",value:function(){for(var e=0;e<this.channels.length;e++)this.channels[e]&&this.channels[e].reset();this.lastCmdA=null,this.lastCmdB=null}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(e)}}]),e}();r.default=E},{}],50:[function(e,t,r){"use strict";var n=e(57),i={newCue:function(e,t,r,i){for(var a,o,s,l,u,c=window.VTTCue||window.TextTrackCue,d=0;d<i.rows.length;d++)if(a=i.rows[d],s=!0,l=0,u="",!a.isEmpty()){for(var f=0;f<a.chars.length;f++)a.chars[f].uchar.match(/\s/)&&s?l++:(u+=a.chars[f].uchar,s=!1);a.cueStartTime=t,t===r&&(r+=1e-4),o=new c(t,r,(0,n.fixLineBreaks)(u.trim())),l>=16?l--:l++,navigator.userAgent.match(/Firefox\//)?o.line=d+1:o.line=d>7?d-2:d+1,o.align="left",o.position=Math.max(0,Math.min(100,l/32*100+(navigator.userAgent.match(/Firefox\//)?50:0))),e.addCue(o)}}};t.exports=i},{57:57}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.findFragWithCC=function(e,t){return i.default.search(e,function(e){return e.cc<t?1:e.cc>t?-1:0})};var n=e(48),i=function(e){return e&&e.__esModule?e:{default:e}}(n)},{48:48}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(53),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new a.default(r),this.fast_=new a.default(n)}return n(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var r=8e3*t/e,n=e/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();r.default=o},{53:53}],53:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return n(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();r.default=i},{}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(){}var a={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=a;function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach(function(t){o[t]=e[t]?e[t].bind(e):function(e){var t=self.console[e];return t?function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n[0]&&(n[0]=function(e,t){return t="["+e+"] > "+t}(e,n[0])),t.apply(self.console,n)}:i}(t)})}r.enableLogs=function(e){if(!0===e||"object"===(void 0===e?"undefined":n(e))){s(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=a}}else o=a},r.logger=o},{}],55:[function(e,t,r){"use strict";t.exports={toString:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}}},{}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var e="auto",t={"":!0,lr:!0,rl:!0},r={start:!0,middle:!0,end:!0,left:!0,right:!0};function n(e){if("string"!=typeof e)return!1;var t=r[e.toLowerCase()];return!!t&&e.toLowerCase()}function i(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}function a(r,a,o){var s=this,l=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),u={};l?s=document.createElement("custom"):u.enumerable=!0,s.hasBeenReset=!1;var c="",d=!1,f=r,h=a,p=o,v=null,g="",y=!0,m="auto",b="start",_=50,E="middle",k=50,w="middle";if(Object.defineProperty(s,"id",i({},u,{get:function(){return c},set:function(e){c=""+e}})),Object.defineProperty(s,"pauseOnExit",i({},u,{get:function(){return d},set:function(e){d=!!e}})),Object.defineProperty(s,"startTime",i({},u,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",i({},u,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",i({},u,{get:function(){return p},set:function(e){p=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",i({},u,{get:function(){return v},set:function(e){v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",i({},u,{get:function(){return g},set:function(e){var r=function(e){return"string"==typeof e&&!!t[e.toLowerCase()]&&e.toLowerCase()}(e);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");g=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",i({},u,{get:function(){return y},set:function(e){y=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",i({},u,{get:function(){return m},set:function(t){if("number"!=typeof t&&t!==e)throw new SyntaxError("An invalid number or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",i({},u,{get:function(){return b},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",i({},u,{get:function(){return _},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",i({},u,{get:function(){return E},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",i({},u,{get:function(){return k},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");k=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",i({},u,{get:function(){return w},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),s.displayState=void 0,l)return s}return a.prototype.getCueAsHTML=function(){var e=window.WebVTT;return e.convertCueToDOMTree(window,this.text)},a}()},{}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fixLineBreaks=void 0;var n=e(56),i=function(e){return e&&e.__esModule?e:{default:e}}(n),a=function(){return{decode:function(e){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}};function o(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[]}function s(){this.values=Object.create(null)}function l(e,t,r,n){var i=n?e.split(n):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(r);if(2===o.length){var s=o[0],l=o[1];t(s,l)}}}s.prototype={set:function(e,t){this.get(e)||""===t||(this.values[e]=t)},get:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t},has:function(e){return e in this.values},alt:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}},integer:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))},percent:function(e,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(e,t),!0)}};var u=new i.default(0,0,0),c="middle"===u.align?"middle":"center";function d(e,t,r){var n=e;function i(){var t=function(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+(0|n)/1e3}var r=e.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?t(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?t(r[1],r[2],0,r[4]):t(0,r[1],r[2],r[4]):null}(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=i(),a(),"--\x3e"!==e.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.substr(3),a(),t.endTime=i(),a(),function(e,t){var n=new s;l(e,function(e,t){switch(e){case"region":for(var i=r.length-1;i>=0;i--)if(r[i].id===t){n.set(e,r[i].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":var a=t.split(","),o=a[0];n.integer(e,o),n.percent(e,o)&&n.set("snapToLines",!1),n.alt(e,o,["auto"]),2===a.length&&n.alt("lineAlign",a[1],["start",c,"end"]);break;case"position":a=t.split(","),n.percent(e,a[0]),2===a.length&&n.alt("positionAlign",a[1],["start",c,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",c,"end","left","right"])}},/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===u.line&&(i=-1),t.line=i,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",c);var a=n.get("position","auto");"auto"===a&&50===u.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function f(e){return e.replace(/<br(?: \/)?>/gi,"\n")}o.prototype={parse:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=f(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.substr(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.substr(r),n}function n(e){l(e,function(e,t){switch(e){case"Region":console.log("parse region",t)}},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var a;if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var o=(a=r()).match(/^WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:a=r(),t.state){case"HEADER":/:/.test(a)?n(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new i.default(0,0,""),t.state="CUE",-1===a.indexOf("--\x3e")){t.cue.id=a;continue}case"CUE":try{d(a,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var u=-1!==a.indexOf("--\x3e");if(!a||u&&(s=!0)){t.oncue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}t.cue.text&&(t.cue.text+="\n"),t.cue.text+=a;continue;case"BADCUE":a||(t.state="ID");continue}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(e){throw e}return this.onflush&&this.onflush(),this}},r.fixLineBreaks=f,r.default=o},{56:56}],58:[function(e,t,r){"use strict";var n=e(57),i=function(e){return e&&e.__esModule?e:{default:e}}(n),a=function(e,t,r){return e.substr(r||0,t.length)===t},o=function(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()},s={parse:function(e,t,r,n,s,l){var u=String.fromCharCode.apply(null,new Uint8Array(e)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),c="00:00.000",d=0,f=0,h=0,p=[],v=void 0,g=!0,y=new i.default;y.oncue=function(e){var t=r[n],i=r.ccOffset;t&&t.new&&(void 0!==f?i=r.ccOffset=t.start:function(e,t,r){var n=e[t],i=e[n.prevCC];if(!i||!i.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;i&&i.new;)e.ccOffset+=n.start-i.start,n.new=!1,i=e[(n=i).prevCC];e.presentationOffset=r}(r,n,h)),h&&(i=h+r.ccOffset-r.presentationOffset),e.startTime+=i-f,e.endTime+=i-f,e.id=o(e.startTime)+o(e.endTime)+o(e.text),e.text=decodeURIComponent(escape(e.text)),e.endTime>0&&p.push(e)},y.onparsingerror=function(e){v=e},y.onflush=function(){v&&l?l(v):s(p)},u.forEach(function(e){if(g){if(a(e,"X-TIMESTAMP-MAP=")){g=!1,e.substr(16).split(",").forEach(function(e){a(e,"LOCAL:")?c=e.substr(6):a(e,"MPEGTS:")&&(d=parseInt(e.substr(7)))});try{d-=t=t<0?t+8589934592:t,f=function(e){var t=parseInt(e.substr(-3)),r=parseInt(e.substr(-6,2)),n=parseInt(e.substr(-9,2)),i=e.length>9?parseInt(e.substr(0,e.indexOf(":"))):0;return isNaN(t)||isNaN(r)||isNaN(n)||isNaN(i)?-1:(t+=1e3*r,t+=6e4*n,t+=36e5*i)}(c)/1e3,h=d/9e4,-1===f&&(v=new Error("Malformed X-TIMESTAMP-MAP: "+e))}catch(t){v=new Error("Malformed X-TIMESTAMP-MAP: "+e)}return}""===e&&(g=!1)}y.parse(e+"\n")}),y.flush()}};t.exports=s},{57:57}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(54),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return n(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(r){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,a=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===r){var s=t.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var l=void 0,u=void 0;"arraybuffer"===a.responseType?(l=t.response,u=l.byteLength):(l=t.responseText,u=l.length),n.loaded=n.total=u;var c={url:t.responseURL,data:l};this.callbacks.onSuccess(c,n,a,t)}else n.retry>=o.maxRetry||s>=400&&s<499?(i.logger.error(s+" while loading "+a.url),this.callbacks.onError({code:s,text:t.statusText},a,t)):(i.logger.warn(s+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:"loadtimeout",value:function(){i.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)}}]),e}();r.default=a},{54:54}]},{},[40])(40)},function(e,t,r){(function(n){var i;!function(){var a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){if(r.get||r.set)throw new TypeError("ES3 does not support getters and setters.");e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value)},o="undefined"!=typeof window&&window===this?this:void 0!==n&&null!=n?n:this;function s(e,t){if(t){for(var r=o,n=e.split("."),i=0;i<n.length-1;i++){var s=n[i];s in r||(r[s]={}),r=r[s]}(s=t(i=r[n=n[n.length-1]]))!=i&&null!=s&&a(r,n,{configurable:!0,writable:!0,value:s})}}function l(e,t,r){return e.call.apply(e.bind,arguments)}function u(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function c(e,t,r){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:u).apply(null,arguments)}function d(e){var t=[];return function e(t,r,n){if(null==r)n.push("null");else{if("object"==typeof r){if("array"==function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var r=Object.prototype.toString.call(e);if("[object Window]"==r)return"object";if("[object Array]"==r||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==r||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}(r)){var i=r;r=i.length,n.push("[");for(var a="",o=0;o<r;o++)n.push(a),a=i[o],e(t,a,n),a=",";return void n.push("]")}if(!(r instanceof String||r instanceof Number||r instanceof Boolean)){for(i in n.push("{"),o="",r)Object.prototype.hasOwnProperty.call(r,i)&&("function"!=typeof(a=r[i])&&(n.push(o),p(i,n),n.push(":"),e(t,a,n),o=","));return void n.push("}")}r=r.valueOf()}switch(typeof r){case"string":p(r,n);break;case"number":n.push(isFinite(r)&&!isNaN(r)?String(r):"null");break;case"boolean":n.push(String(r));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof r)}}}(new function(){},e,t),t.join("")}s("String.prototype.includes",function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==(this+"").indexOf(e,t||0)}}),s("Number.isFinite",function(e){return e||function(e){return"number"==typeof e&&(!isNaN(e)&&1/0!==e&&-1/0!==e)}}),s("Number.isInteger",function(e){return e||function(e){return!!Number.isFinite(e)&&e===Math.floor(e)}});var f={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},h=/\uffff/.test("")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function p(e,t){t.push('"',e.replace(h,function(e){var t=f[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),f[e]=t),t}),'"')}function v(e){e=String(e);try{return JSON.parse(e)}catch(e){}throw Error("Invalid JSON string: "+e)}function g(e){try{return"object"==typeof JSON&&"function"==typeof JSON.stringify?JSON.stringify(e):d(e)}catch(e){}throw Error("Could not stringify object")}function y(){var e=[];return function(t){e.push(t),1===e.length&&function t(){e.length&&e[0](function(){e.shift(),t()})}()}}var m=2,b=200,_=5e3,E="",k={};function w(){return!!(window.performance&&window.performance.timing&&window.performance.timing.navigationStart)}var T="";function S(e){return e&&"number"==typeof e?(Date.now()-e).toString():null}var A=!1,R={"/v1/open":{link_identifier:"\\d+"},"/v1/pageview":{event:"pageview"},"/v1/dismiss":{event:"dismiss"}},x=!1;function L(e,t){if(e||t){for(var r="https://bnc.lt/a/"+e+"?",n="tags alias channel feature stage campaign type duration sdk source data".split(" "),i=0;i<n.length;i++){var a=n[i],o=t[a];if(o)if("tags"===a&&Array.isArray(o))for(var s=0;s<o.length;s++)r=("?"===r[r.length-1]?r+a:r+"&"+a)+"="+encodeURIComponent(o[s]);else("string"==typeof o&&0<o.length||"number"==typeof o)&&("data"===a&&"string"==typeof o&&(o=B(o)),r=("?"===r[r.length-1]?r+a:r+"&"+a)+"="+encodeURIComponent(o))}return r}}function O(e){e&&(e.ga=null,e.M=null,e.G=null,e.v=null,e.C=null,e.B=null,e.o&&delete e.o,e.s&&delete e.s,e.c.remove("branch_view_enabled"),Be(e.c,{},!0))}function D(e,t,r){return e=e.replace(/\$(\d)/g,function(e,r){return t[parseInt(r,10)-1]}),r&&(e+="\n Failure Code:"+r),e}function P(e){return{data:e.data||"",data_parsed:e.data_parsed||{},has_app:e.has_app||null,identity:e.identity||null,referring_identity:e.referring_identity||null,referring_link:e.referring_link||null}}function I(){return te()?document.referrer:String(window.location)}function C(e){e.source="web-sdk";var t=e.data;switch(typeof t){case"string":try{t=v(t)}catch(e){t={_bncNoEval:!0}}break;case"object":break;default:t={}}t.$canonical_url||(t.$canonical_url=I()),t.$og_title||(t.$og_title=H("title")),t.$og_description||(t.$og_description=H("description")),t.$og_image_url||(t.$og_image_url=H("image")),t.$og_video||(t.$og_video=H("video")),"string"==typeof t.$desktop_url&&(t.$desktop_url=t.$desktop_url.replace(/#r:[a-z0-9-_]+$/i,"").replace(/([\?\&]_branch_match_id=\d+)/,""));try{v(t)}catch(e){t=d(t)}return e.data=t,e}function M(e){if(!e||"string"!=typeof e)return"";var t=document.createElement("a");return t.href=e,e=t.pathname&&t.pathname.split("/").filter(function(e){return""!==e}),Array.isArray(e)&&e.length?e[e.length-1]+t.search:t.search}function F(e,t){if(e&&"object"==typeof e||(e={}),!t||"object"!=typeof t)return e;for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}function N(){var e=navigator.userAgent;return e.match(/android/i)?"android":e.match(/ipad/i)?"ipad":e.match(/i(os|p(hone|od))/i)?"ios":e.match(/\(BB[1-9][0-9]*\;/i)?"blackberry":e.match(/Windows Phone/i)?"windows_phone":!!(e.match(/Kindle/i)||e.match(/Silk/i)||e.match(/KFTT/i)||e.match(/KFOT/i)||e.match(/KFJWA/i)||e.match(/KFJWI/i)||e.match(/KFSOWI/i)||e.match(/KFTHWA/i)||e.match(/KFTHWI/i)||e.match(/KFAPWA/i)||e.match(/KFAPWI/i))&&"kindle"}function U(){var e,t=navigator.userAgent;if(/^((?!chrome|android|crios|fxios).)*safari/i.test(t))e:{if(11,(t=/version\/([^ ]*)/i.exec(t))&&t[1])try{if(parseFloat(t[1])>=11){e=!0;break e}}catch(e){}e=!1}else e=!1;return e}function B(e){var t,r,n,i,a,o,s="",l=0;for(e=e.replace(/\r\n/g,"\n"),r="",n=0;n<e.length;n++)128>(i=e.charCodeAt(n))?r+=String.fromCharCode(i):(127<i&&2048>i?r+=String.fromCharCode(i>>6|192):(r+=String.fromCharCode(i>>12|224),r+=String.fromCharCode(i>>6&63|128)),r+=String.fromCharCode(63&i|128));for(e=r;l<e.length;)i=(t=e.charCodeAt(l++))>>2,t=(3&t)<<4|(r=e.charCodeAt(l++))>>4,a=(15&r)<<2|(n=e.charCodeAt(l++))>>6,o=63&n,isNaN(r)?o=a=64:isNaN(n)&&(o=64),s=s+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(i)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(o);return s}function j(e,t,r){"function"==typeof e.addEventListener?e.addEventListener(t,r,void 0):"function"==typeof e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}function G(e){return e?(-1<e.indexOf("://")?e=e.split("://")[1]:"/"===e.charAt(0)&&(e=e.slice(1)),e):null}function H(e){var t;return e=String(e),t=t||null,(e=document.querySelector('meta[property="og:'+e+'"]'))&&e.content&&(t=e.content),t}function W(){var e=document.getElementsByTagName("meta"),t={};if(!e||0===e.length)return t;for(var r={hostedIOS:null,hostedAndroid:null,applinksIOS:null,applinksAndroid:null,twitterIOS:null,twitterAndroid:null},n=0;n<e.length;n++)if((e[n].getAttribute("name")||e[n].getAttribute("property"))&&e[n].getAttribute("content")){var i=e[n].getAttribute("name"),a=e[n].getAttribute("property");3===(a=(i=i||a).split(":")).length&&"branch"===a[0]&&"deeplink"===a[1]&&("$ios_deeplink_path"===a[2]?r.hostedIOS=G(e[n].getAttribute("content")):"$android_deeplink_path"===a[2]?r.hostedAndroid=G(e[n].getAttribute("content")):t[a[2]]=e[n].getAttribute("content")),"al:ios:url"===i&&(r.applinksIOS=G(e[n].getAttribute("content"))),"twitter:app:url:iphone"===i&&(r.twitterIOS=G(e[n].getAttribute("content"))),"al:android:url"===i&&(r.applinksAndroid=G(e[n].getAttribute("content"))),"twitter:app:url:googleplay"===i&&(r.twitterAndroid=G(e[n].getAttribute("content")))}return r&&"object"==typeof r&&Object.keys(r).length&&(r.hostedIOS?t.$ios_deeplink_path=r.hostedIOS:r.applinksIOS?t.$ios_deeplink_path=r.applinksIOS:r.twitterIOS&&(t.$ios_deeplink_path=r.twitterIOS),r.hostedAndroid?t.$android_deeplink_path=r.hostedAndroid:r.applinksAndroid?t.$android_deeplink_path=r.applinksAndroid:r.twitterAndroid&&(t.$android_deeplink_path=r.twitterAndroid),t.hasOwnProperty("$ios_deeplink_path")&&t.hasOwnProperty("$android_deeplink_path")&&t.$ios_deeplink_path===t.$android_deeplink_path&&(t.$deeplink_path=t.$ios_deeplink_path)),t}function K(){var e;try{navigator.languages&&0<navigator.languages.length?e=navigator.languages[0]:navigator.language&&(e=navigator.language),e=e.substring(0,2).toUpperCase()}catch(t){e=null}return e}function V(e,t){var r=[];return t.forEach(function(t){-1===e.indexOf(t)&&r.push(t)}),r}var z=["purchase"],q={missingPurchaseEvent:"event name is either missing, of the wrong type or not valid. Please specify 'purchase' as the event name.",missingCommerceData:"commerce_data is either missing, of the wrong type or empty. Please ensure that commerce_data is constructed correctly.",invalidKeysForRoot:"Please remove the following keys from the root of commerce_data: ",invalidKeysForProducts:"Please remove the following keys from commerce_data.products: ",invalidProductListType:"commerce_data.products must be an array of objects",invalidProductType:"Each product in the products list must be an object"};function Y(e,t){if(!e||"string"!=typeof e||-1===z.indexOf(e.toLowerCase()))return q.missingPurchaseEvent;if(!t||"object"!=typeof t||!Object.keys(t).length)return q.missingCommerceData;var r=function(e){var t="sku name price quantity brand category variant".split(" "),r=V("common type transaction_id currency revenue revenue_in_usd exchange_rate shipping tax coupon affiliation persona products".split(" "),Object.keys(e));if(r.length)return q.invalidKeysForRoot+r.join(", ");var n,i=[];if(e.hasOwnProperty("products")){if(!Array.isArray(e.products))return q.invalidProductListType;if(e.products.forEach(function(e){"object"!=typeof e&&(n=q.invalidProductType),i=i.concat(V(t,Object.keys(e)))}),n)return n;if(i.length)return q.invalidKeysForProducts+i.join(", ")}return null}(t);return r||null}function X(e){return"string"!=typeof e?null:e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function $(e,t,r){if(r){if("object"==typeof r&&!Object.keys(r).length)return e;e[t]=r}return e}var J="ADD_TO_CART ADD_TO_WISHLIST VIEW_CART INITIATE_PURCHASE ADD_PAYMENT_INFO PURCHASE SPEND_CREDITS SEARCH VIEW_ITEM VIEW_ITEMS RATE SHARE COMPLETE_REGISTRATION COMPLETE_TUTORIAL ACHIEVE_LEVEL UNLOCK_ACHIEVEMENT".split(" "),Q="transaction_id revenue currency shipping tax coupon affiliation search_query description".split(" ");function Z(e,t){return!(!e||!t)&&("array"===t?Array.isArray(e):typeof e===t&&!Array.isArray(e))}function ee(e){return $($($($($($($($($($({},"http_origin",document.URL),"user_agent",navigator.userAgent),"language",K()),"screen_width",screen.width),"screen_height",screen.height),"http_referrer",document.referrer),"browser_fingerprint_id",e.B),"developer_identity",e.C),"sdk","web"),"sdk_version","2.45.0")}function te(){return window.self!==window.top}function re(){var e="true";try{window.top.location.search&&(e="true")}catch(e){return!1}return"true"===e}function ne(e){return e||(te()?re()?window.top.document.referrer:"":document.referrer)}function ie(e){if(Z(e,"object")&&Object.keys(e).length){for(var t in e)e.hasOwnProperty(t)&&(e[t]=Z(e[t],"object")||Z(e[t],"array")?g(e[t]):e[t].toString());return e}}function ae(e,t){var r=e?F({},e):{};return t&&0<Object.keys(t).length?0<Object.keys(r).length?F(r,t):F({},t):r}function oe(e){""!==E&&e.setAttribute("nonce",E)}function se(e,t){return function(r,n,i){if(A)return!1;if("number"==typeof i||i)if(0===t){if("object"!=typeof i)return D("API request $1, parameter $2 is not $3",[r,n,"an object"])}else if(3===t){if(!(i instanceof Array))return D("API request $1, parameter $2 is not $3",[r,n,"an array"])}else if(2===t){if("number"!=typeof i)return D("API request $1, parameter $2 is not $3",[r,n,"a number"])}else if(4===t){if("boolean"!=typeof i)return D("API request $1, parameter $2 is not $3",[r,n,"a boolean"])}else{if("string"!=typeof i)return D("API request $1, parameter $2 is not $3",[r,n,"a string"]);if(1!==t&&!t.test(i))return D("API request $1, parameter $2 is not $3",[r,n,"in the proper format"])}else if(e)return D("API request $1 missing parameter $2",[r,n]);return!1}}var le=/^[0-9]{15,20}$/;function ue(e){return F(e,{browser_fingerprint_id:se(!0,le),identity_id:se(!0,le),sdk:se(!0,1),session_id:se(!0,le)})}var ce={destination:"https://api.branch.io",endpoint:"/v1/open",method:"POST",a:{browser_fingerprint_id:se(!1,le),alternative_browser_fingerprint_id:se(!1,le),identity_id:se(!1,le),link_identifier:se(!1,1),sdk:se(!1,1),options:se(!1,0),initial_referrer:se(!1,1),tracking_disabled:se(!1,4)}},de={destination:"https://app.link",endpoint:"/_r",method:"GET",Y:!0,a:{sdk:se(!0,1),_t:se(!1,le),branch_key:se(!0,1)}},fe={destination:"",endpoint:"",method:"GET",f:{link_url:se(!0,1)},a:{click:se(!0,1)}},he={destination:"https://bnc.lt",endpoint:"/c",method:"POST",f:{link_url:se(!0,1)},a:{sdk:se(!1,1),phone:se(!0,1)}},pe={destination:"https://api.branch.io",endpoint:"/v1/referralcode",method:"POST",a:ue({amount:se(!0,2),bucket:se(!1,1),calculation_type:se(!0,2),creation_source:se(!0,2),expiration:se(!1,1),location:se(!0,2),prefix:se(!1,1),type:se(!0,1)})},ve={destination:"https://api.branch.io",endpoint:"/v1/referralcode",method:"POST",f:{code:se(!0,1)},a:ue({})},ge={destination:"https://api.branch.io",endpoint:"/v1/applycode",method:"POST",f:{code:se(!0,1)},a:ue({})},ye={destination:"https://api.branch.io",endpoint:"/v1/logout",method:"POST",a:ue({session_id:se(!0,le)})},me={destination:"https://api.branch.io",endpoint:"/v1/profile",method:"POST",a:ue({identity_id:se(!0,le),identity:se(!0,1)})},be={destination:"https://api.branch.io",endpoint:"/v1/referrals",method:"GET",f:{identity_id:se(!0,le)},a:ue({})},_e={destination:"https://api.branch.io",endpoint:"/v1/credithistory",method:"GET",a:ue({begin_after_id:se(!1,le),bucket:se(!1,1),direction:se(!1,2),length:se(!1,2),link_click_id:se(!1,le)})},Ee={destination:"https://api.branch.io",endpoint:"/v1/credits",method:"GET",a:ue({branch_key:se(!0,1),identity:se(!0,1)})},ke={destination:"https://api.branch.io",endpoint:"/v1/redeem",method:"POST",a:ue({amount:se(!0,2),bucket:se(!0,1),identity_id:se(!0,le)})},we={destination:"https://api.branch.io",endpoint:"/v1/url",method:"POST",Aa:"obj",a:ue({alias:se(!1,1),campaign:se(!1,1),channel:se(!1,1),data:se(!1,1),feature:se(!1,1),identity_id:se(!0,le),stage:se(!1,1),tags:se(!1,3),type:se(!1,2),source:se(!1,1),instrumentation:se(!1,1)})},Te={destination:"https://api.branch.io",endpoint:"/v1/deepview",Y:!0,method:"POST",a:ue({campaign:se(!1,1),_t:se(!1,le),channel:se(!1,1),data:se(!0,1),feature:se(!1,1),link_click_id:se(!1,1),open_app:se(!1,4),append_deeplink_path:se(!1,4),stage:se(!1,1),tags:se(!1,3),deepview_type:se(!0,1),source:se(!0,1)})},Se={destination:"https://api.branch.io",endpoint:"/v1/has-app",method:"GET",a:{browser_fingerprint_id:se(!0,le),instrumentation:se(!1,1)}},Ae={destination:"https://api.branch.io",endpoint:"/v1/event",method:"POST",a:ue({event:se(!0,1),metadata:se(!0,0),initial_referrer:se(!1,1),tracking_disabled:se(!1,4)})},Re={destination:"https://api.branch.io",endpoint:"/v1/event",method:"POST",a:ue({event:se(!0,1),metadata:se(!1,0),initial_referrer:se(!1,1),commerce_data:se(!0,0)})},xe={destination:"https://api.branch.io",endpoint:"/v2/event/standard",method:"POST",a:{name:se(!0,1),user_data:se(!0,1),custom_data:se(!1,1),event_data:se(!1,1),content_items:se(!1,1)}},Le={destination:"https://api.branch.io",endpoint:"/v2/event/custom",method:"POST",a:{name:se(!0,1),user_data:se(!0,1),custom_data:se(!1,1)}},Oe={destination:"https://api.branch.io",endpoint:"/v1/pageview",method:"POST",a:ue({event:se(!0,1),metadata:se(!1,0),initial_referrer:se(!1,1),tracking_disabled:se(!1,4),branch_view_id:se(!1,1),no_journeys:se(!1,4),user_language:se(!1,1),open_app:se(!1,4),has_app_websdk:se(!1,4),source:se(!1,1),feature:se(!1,1),is_iframe:se(!1,4),data:se(!1,0),callback_string:se(!1,1),journey_displayed:se(!1,4),audience_rule_id:se(!1,1),journey_dismissals:se(!1,0)})},De={destination:"https://api.branch.io",endpoint:"/v1/dismiss",method:"POST",a:ue({event:se(!0,1),metadata:se(!1,0),initial_referrer:se(!1,1),tracking_disabled:se(!1,4),branch_view_id:se(!1,1),no_journeys:se(!1,4),user_language:se(!1,1),open_app:se(!1,4),has_app_websdk:se(!1,4),source:se(!1,1),feature:se(!1,1),is_iframe:se(!1,4),data:se(!1,0),callback_string:se(!1,1),journey_displayed:se(!1,4),audience_rule_id:se(!1,1),journey_dismissals:se(!1,0)})};function Pe(e){for(var t=0;t<e.length;t++){var r;if((r="function"==typeof(r=this[e[t]])?r():r).isEnabled())return r.u={},r}}function Ie(e){return"branch_session"===e||"branch_session_first"===e?e:"BRANCH_WEBSDK_KEY"+e}function Ce(e){return"true"===e||"false"!==e&&e}function Me(e){return"branch_session"===e||"branch_session_first"===e||0===e.indexOf("BRANCH_WEBSDK_KEY")}function Fe(e){var t=(e=e.trim()).indexOf("=");return{name:e.substring(0,t),value:Ce(e.substring(t+1,e.length))}}function Ne(e){var t;try{t=e&&localStorage?localStorage:sessionStorage}catch(e){return{isEnabled:function(){return!1}}}return{getAll:function(){if(void 0===t)return null;var e,r=null;for(e in t)e.indexOf("BRANCH_WEBSDK_KEY")||(null===r&&(r={}),r[e.replace("BRANCH_WEBSDK_KEY","")]=Ce(t.getItem(e)));return r},get:function(e,r){return Ce(r&&localStorage?localStorage.getItem(Ie(e)):t.getItem(Ie(e)))},set:function(e,r,n){n&&localStorage?localStorage.setItem(Ie(e),r):t.setItem(Ie(e),r)},remove:function(e,r){r&&localStorage?localStorage.removeItem(Ie(e)):t.removeItem(Ie(e))},clear:function(){Object.keys(t).forEach(function(e){e.indexOf("BRANCH_WEBSDK_KEY")||t.removeItem(e)})},isEnabled:function(){try{return t.setItem("test",""),t.removeItem("test"),!0}catch(e){return!1}}}}function Ue(e,t){try{return v(e.get(t?"branch_session_first":"branch_session",t))||null}catch(e){return null}}function Be(e,t,r){e.set("branch_session",d(t)),r&&e.set("branch_session_first",d(t),!0)}function je(e,t){if(t){var r=F(r=Ue(e)||{},t);e.set("branch_session",d(r))}}function Ge(){}function He(e,t,r){function n(e,r){if(void 0===r&&(r={}),e.branch_key&&l.test(e.branch_key))return r.branch_key=e.branch_key,r;if(e.app_id&&s.test(e.app_id))return r.app_id=e.app_id,r;if(!e.instrumentation)throw Error(D("API request $1 missing parameter $2",[t.endpoint,"branch_key or app_id"]));r.instrumentation=e.instrumentation}var i,a,o=t.destination+t.endpoint,s=/^[0-9]{15,20}$/,l=/key_(live|test)_[A-Za-z0-9]{32}/;if("/v1/has-app"===t.endpoint)try{t.f=n(r,t.f)}catch(e){return{error:e.message}}if(void 0!==t.f)for(i in t.f)if(t.f.hasOwnProperty(i)){if(a="function"==typeof t.f[i]?t.f[i](t.endpoint,i,r[i]):a)return{error:a};o+="/"+r[i]}var u={};if(void 0!==t.a&&"/v1/pageview"!==t.endpoint&&"/v1/dismiss"!==t.endpoint){for(i in t.a)if(t.a.hasOwnProperty(i)){if(a=t.a[i](t.endpoint,i,r[i]))return{error:a};void 0!==(a=r[i])&&""!==a&&null!==a&&(u[i]=a)}}else"/v1/pageview"!==t.endpoint&&"/v1/dismiss"!==t.endpoint||F(u,r);if("POST"===t.method||"/v1/credithistory"===t.endpoint)try{r=n(r,u)}catch(e){return{error:e.message}}return"/v1/event"===t.endpoint&&(u.metadata=g(u.metadata||{}),u.hasOwnProperty("commerce_data")&&(u.commerce_data=g(u.commerce_data||{}))),("/v1/pageview"===t.endpoint||"/v1/dismiss"===t.endpoint)&&u.metadata&&(u.metadata=g(u.metadata||{})),"/v1/open"===t.endpoint&&(u.options=g(u.options||{})),{data:function e(t,r,n){if(void 0===r)return"";var i=[];if(r instanceof Array){for(t=0;t<r.length;t++)i.push(encodeURIComponent(n)+"="+encodeURIComponent(r[t]));return i.join("&")}for(var a in r)r.hasOwnProperty(a)&&(r[a]instanceof Array||"object"==typeof r[a]?i.push(e(t,r[a],n?n+"."+a:a)):i.push(encodeURIComponent(n?n+"."+a:a)+"="+encodeURIComponent(r[a])));return i.join("&")}(e,u,""),url:o.replace(/^\//,"")}}function We(e,t,r,n,i){var a=Date.now(),o=T;!e.g&&U()&&e.g++;var s="branch_callback__"+e.g++;e=0<=t.indexOf("branch.io")?"&data=":"&post_data=",r="POST"===n?encodeURIComponent(B(d(r))):"";var l=window.setTimeout(function(){window[s]=function(){},$(k,o,S(a)),i(Error("Request timed out"),null,504)},_);window[s]=function(e){window.clearTimeout(l),i(null,e)},function(e,t,r){var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,oe(n),!(e=document.getElementsByTagName("head"))||1>e.length?"function"==typeof t&&t():(e[0].appendChild(n),"function"==typeof t&&j(n,"error",t),"function"==typeof r&&j(n,"load",r))}(t+(0>t.indexOf("?")?"?":"")+(r?e+r:"")+(0<=t.indexOf("/c/")?"&click=1":"")+"&callback="+s,function(){i(Error("Request blocked by client, probably adblock"),null)},function(){$(k,o,S(a));try{"function"==typeof this.remove?this.remove():this.parentNode.removeChild(this)}catch(e){}delete window[s]})}function Ke(e,t,r,n,i){function a(){n.get("use_jsonp")||t.Y?We(e,u,r,t.method,o):function(e,t,r,n,i,a){var o=Date.now(),s=T,l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");l.ontimeout=function(){$(k,s,S(o)),a(Error("Request timed out"),null,504)},l.onerror=function(e){a(Error(e.error||"Error in API: "+l.status),null,l.status)},l.onreadystatechange=function(){var e;if(4===l.readyState)if($(k,s,S(o)),200===l.status){try{e=v(l.responseText)}catch(t){e={}}a(null,e,l.status)}else 402===l.status?a(Error("Not enough credits to redeem."),null,l.status):"4"!==l.status.toString().substring(0,1)&&"5"!==l.status.toString().substring(0,1)||(l.responseURL&&l.responseURL.includes("v2/event")?a(l.responseText,null,l.status):a(Error("Error in API: "+l.status),null,l.status))};try{l.open(n,t,!0),l.timeout=_,l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.send(r)}catch(o){i.set("use_jsonp",!0),We(e,t,r,n,a)}}(e,u,c,t.method,n,o)}function o(e,t,r){e&&0<d&&"5"===(r||"").toString().substring(0,1)?(d--,window.setTimeout(function(){a()},b)):i(e,t)}if(T="/v1/pageview"===t.endpoint&&r&&r.journey_displayed?t.endpoint+"-1-brtt":t.endpoint+"-brtt",("/v1/url"===t.endpoint||"/v1/has-app"===t.endpoint)&&1<Object.keys(k).length&&(delete k["-brtt"],r.instrumentation=g(F({},k)),k={}),A)for(var s=["browser_fingerprint_id","alternative_browser_fingerprint_id","identity_id","session_id"],l=0;l<s.length;l++)r.hasOwnProperty(s[l])&&delete r[s[l]];if((s=He(e,t,r)).error)return i(Error(g({message:s.error,endpoint:t.endpoint,data:r})));var u,c="";"GET"===t.method?u=s.url+"?"+s.data:(u=s.url,c=s.data);var d=m;if(A&&function(e,t){var r=document.createElement("a");if(r.href=e,"/"!=(r=r.pathname)[0]&&(r="/"+r),!(r=R[r]))return!0;if(0<Object.keys(r).length){if(!t)return!0;for(var n in r){var i=new RegExp(r[n]);if(!t.hasOwnProperty(n)||!i.test(t[n]))return!0}}return!1}(u,r))return x?o(Error("Requested operation cannot be completed since tracking is disabled"),null,300):o(null,{},200);a()}function Ve(e){e&&e.parentNode.removeChild(e)}function ze(e,t){e&&!e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))&&(e.className+=" "+t)}function qe(e){var t=document.body;t&&t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," "))}function Ye(e){return document.body.currentStyle?document.body.currentStyle[function(e){return e.replace(/(\-\w)/g,function(e){return e[1].toUpperCase()})}(e)]:window.getComputedStyle(document.body).getPropertyValue(e)}function Xe(e){function t(e){function r(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)/100}function n(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)/100}if(!e)return 0;var i=e.replace(/[0-9,\.]/g,"");e=e.match(/\d+/g);var a=parseInt(0<e.length?e[0]:"0",10);return parseInt({px:function(e){return e},em:function(e){return document.body.currentStyle?e*t(document.body.currentStyle.fontSize):e*parseFloat(window.getComputedStyle(document.body).fontSize)},rem:function(e){return document.documentElement.currentStyle?e*t(document.documentElement.currentStyle.fontSize):e*parseFloat(window.getComputedStyle(document.documentElement).fontSize)},vw:function(e){return e*n()},vh:function(e){return e*r()},vmin:function(e){return e*Math.min(r(),n())},vmax:function(e){return e*Math.max(r(),n())},"%":function(){return document.body.clientWidth/100*a}}[i](a),10)}return(t("76px")+t(e)).toString()+"px"}function $e(e,t){return"#branch-banner-iframe { position: "+("top"!==t||e?"fixed":"absolute")+"; }\n"}function Je(e,t){var r;if(e.w||e.L){if(e.w){r="";for(var n=0;5>n;n++)r+='<span class="star"><svg class="star" fill="#555555" height="12" viewBox="3 2 20 19" width="12"><path d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"/><path d="M0 0h24v24H0z" fill="none"/><foreignObject display="none"><span class="star"></span></foreignObject></svg>',e.w>n&&(r+=n+1>e.w&&e.w%1?'<span class="half"><svg fill="#555555" height="12" viewBox="3 2 20 19" width="12"><defs><path d="M0 0h24v24H0V0z" id="a"/></defs><clipPath id="b"><use overflow="visible" xlink:href="#a"/></clipPath><path clip-path="url(#b)" d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"/></svg><foreignObject display="none"><span class="half"></span></foreignObject></span>':'<span class="full"><svg fill="#555555" height="12" viewBox="3 2 20 19" width="12"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/><path d="M0 0h24v24H0z" fill="none"/><foreignObject display="none"><span class="full"></span></foreignObject></svg> </span>'),r+="</span>";r='<span class="stars">'+r+"</span>"}else r="";r='<div class="reviews">'+r+(e.L?'<span class="review-count">'+e.L+"</span>":"")+"</div>"}else r="";return'<div class="content'+(e.theme?" theme-"+e.theme:"")+'"><div class="right">'+t+'</div><div class="left">'+(e.ha?"":'<div id="branch-banner-close" class="branch-animation" aria-label="Close">&times;</div>')+'<div class="icon"><img src="'+e.icon+'" alt="Application icon"></div><div class="details vertically-align-middle"><div class="title">'+e.title+"</div>"+r+'<div class="description">'+e.description+"</div></div></div></div>"}function Qe(e,t,r,n){function i(){o(),u.style.background="#FFD4D4",l.className="error",setTimeout(function(){u.style.background="#FFFFFF",l.className=""},2e3)}function a(){(s=e.createElement("div")).className="branch-icon-wrapper",s.id="branch-checkmark",s.style="opacity: 0;",s.innerHTML=window.ActiveXObject?'<span class="checkmark">&#x2713;</span>':'<svg version="1.1" id="Layer_1" x="0px" y="0px" viewBox="0 0 98.5 98.5" enable-background="new 0 0 98.5 98.5" xml:space="preserve"><path class="checkmark" fill="none" stroke-width="8" stroke-miterlimit="10" d="M81.7,17.8C73.5,9.3,62,4,49.2,4C24.3,4,4,24.3,4,49.2s20.3,45.2,45.2,45.2s45.2-20.3,45.2-45.2c0-8.6-2.4-16.6-6.5-23.4l0,0L45.6,68.2L24.7,47.3"/></svg>',d.appendChild(s),u.style.opacity="0",l.style.opacity="0",c.style.opacity="0",setTimeout(function(){s.style.opacity="1"},20),l.value=""}function o(){u.removeAttribute("disabled"),l.removeAttribute("disabled"),u.style.opacity="1",l.style.opacity="1",c.style.opacity="0"}var s,l=e.getElementById("branch-sms-phone"),u=e.getElementById("branch-sms-send"),c=e.getElementById("branch-loader-wrapper"),d=e.getElementById("branch-sms-form-container");if(l){var f=l.value;/^\d{7,}$/.test(f.replace(/[\s()+\-\.]|ext/gi,""))?(qt(t,"willSendBannerSMS"),u.setAttribute("disabled",""),l.setAttribute("disabled",""),u.style.opacity=".4",l.style.opacity=".4",c.style.opacity="1",l.className="",t.sendSMS(f,n,r,function(e){e?(qt(t,"sendBannerSMSError"),i()):(qt(t,"didSendBannerSMS"),a(),setTimeout(function(){d.removeChild(s),o()},3e3))})):i()}}function Ze(e,t,r,n){function i(e,r){"function"==typeof e&&(r=e,e={}),e=e||{},"top"===t.position?o.style.top="-76px":"bottom"===t.position&&(o.style.bottom="-76px"),"number"==typeof t.K?n.set("hideBanner",function(e){var t=new Date;return t.setDate(t.getDate()+e)}(t.K),!0):n.set("hideBanner",!0,!0),e.X?("top"===t.position?document.body.style.marginTop=u:"bottom"===t.position&&(document.body.style.marginBottom=d),qe("branch-banner-is-active"),Ve(o),Ve(document.getElementById("branch-css")),r()):(setTimeout(function(){Ve(o),Ve(document.getElementById("branch-css")),r()},270),setTimeout(function(){"top"===t.position?document.body.style.marginTop=u:"bottom"===t.position&&(document.body.style.marginBottom=d),qe("branch-banner-is-active")},20))}function a(){"top"===t.position?o.style.top="0":"bottom"===t.position&&(o.style.bottom="0"),qt(e,"didShowBanner")}if(!function(e,t){var r=e.get("hideBanner",!0);if(t.pa&&navigator&&Number(navigator.doNotTrack))return!1;try{"string"==typeof r&&(r=v(r))}catch(e){r=!1}r="number"==typeof r?new Date>=new Date(r):!r;var n=t.K;return"number"==typeof n&&(n=!1),!document.getElementById("branch-banner")&&!document.getElementById("branch-banner-iframe")&&(r||n)&&(t.ra&&!N()||t.O&&"android"===N()||t.sa&&"ipad"===N()||t.T&&"ios"===N()||t.P&&"blackberry"===N()||t.S&&"windows_phone"===N()||t.R&&"kindle"===N())}(n,t))return qt(e,"willNotShowBanner"),null;qt(e,"willShowBanner");var o=function(e,t){var r='<div id="branch-sms-form-container">'+(N()?'<a id="branch-mobile-action" class="button" href="#" target="_parent">'+((Ue(t)||{}).has_app?e.ma:e.ia)+"</a>":'<div class="branch-icon-wrapper" id="branch-loader-wrapper" style="opacity: 0;"><div id="branch-spinner"></div></div><div id="branch-sms-block"><form id="sms-form"><input type="phone" aria-label="Enter phone number" class="branch-animation" name="branch-sms-phone" id="branch-sms-phone" placeholder="'+e.oa+'"><button type="submit" id="branch-sms-send" class="branch-animation button">'+e.qa+"</button></form></div>")+"</div>";if(e.D){var n=document.createElement("iframe");n.src="about:blank",n.style.overflow="hidden",n.scrolling="no",n.id="branch-banner-iframe",n.className="branch-animation",oe(n),document.body.appendChild(n);var i=N();r='<html><head></head><body class="'+("ios"===i||"ipad"===i?"branch-banner-ios":"android"===i?"branch-banner-android":"branch-banner-desktop")+'"><div id="branch-banner" class="branch-animation">'+Je(e,r)+"</body></html>",n.contentWindow.document.open(),n.contentWindow.document.write(r),n.contentWindow.document.close()}else(n=document.createElement("div")).id="branch-banner",n.className="branch-animation",n.innerHTML=Je(e,r),document.body.appendChild(n);return n}(t,n);!function(e,t){var r=".branch-banner-is-active { -webkit-transition: all 0.375s ease; transition: all 00.375s ease; }\n#branch-banner { width:100%; z-index: 99999; font-family: Helvetica Neue, Sans-serif; -webkit-font-smoothing: antialiased; -webkit-user-select: none; -moz-user-select: none; user-select: none; -webkit-transition: all 0.25s ease; transition: all 00.25s ease; }\n#branch-banner .button{ border: 1px solid "+(e.buttonBorderColor||("dark"===e.theme?"transparent":"#ccc"))+"; background: "+(e.buttonBackgroundColor||"#fff")+"; color: "+(e.buttonFontColor||"#000")+"; cursor: pointer; margin-top: 0px; font-size: 14px; display: inline-block; margin-left: 5px; font-weight: 400; text-decoration: none;  border-radius: 4px; padding: 6px 12px; transition: all .2s ease;}\n#branch-banner .button:hover {  border: 1px solid "+(e.buttonBorderColorHover||("dark"===e.theme?"transparent":"#BABABA"))+"; background: "+(e.buttonBackgroundColorHover||"#E0E0E0")+"; color: "+(e.buttonFontColorHover||"#000")+";}\n#branch-banner .button:focus { outline: none; }\n#branch-banner * { margin-right: 4px; position: relative; line-height: 1.2em; }\n#branch-banner-close { font-weight: 400; cursor: pointer; float: left; z-index: 2;padding: 0 5px 0 5px; margin-right: 0; }\n#branch-banner .content { width:100%; overflow: hidden; height: 76px; background: rgba(255, 255, 255, 0.95); color: #333; "+("top"===e.position?"border-bottom":"border-top")+': 1px solid #ddd; }\n#branch-banner-close { color: #000; font-size: 24px; top: 14px; opacity: .5; transition: opacity .3s ease; }\n#branch-banner-close:hover { opacity: 1; }\n#branch-banner .title { font-size: 18px; font-weight:bold; color: #555; }\n#branch-banner .description { font-size: 12px; font-weight: normal; color: #777; max-height: 30px; overflow: hidden; }\n#branch-banner .icon { float: left; padding-bottom: 40px; margin-right: 10px; margin-left: 5px; }\n#branch-banner .icon img { width: 63px; height: 63px; margin-right: 0; }\n#branch-banner .reviews { font-size:13px; margin: 1px 0 3px 0; color: #777; }\n#branch-banner .reviews .star { display:inline-block; position: relative; margin-right:0; }\n#branch-banner .reviews .star span { display: inline-block; margin-right: 0; color: #555; position: absolute; top: 0; left: 0; }\n#branch-banner .reviews .review-count { font-size:10px; }\n#branch-banner .reviews .star .half { width: 50%; overflow: hidden; display: block; }\n#branch-banner .content .left { padding: 6px 5px 6px 5px; }\n#branch-banner .vertically-align-middle { top: 50%; transform: translateY(-50%); -webkit-transform: translateY(-50%); -ms-transform: translateY(-50%); }\n#branch-banner .details > * { display: block; }\n#branch-banner .content .left { height: 63px; }\n#branch-banner .content .right { float: right; height: 63px; margin-bottom: 50px; padding-top: 22px; z-index: 1; }\n#branch-banner .right > div { float: left; }\n#branch-banner-action { top: 17px; }\n#branch-banner .content:after { content: ""; position: absolute; left: 0; right: 0; top: 100%; height: 1px; background: rgba(0, 0, 0, 0.2); }\n#branch-banner .theme-dark.content { background: rgba(51, 51, 51, 0.95); }\n#branch-banner .theme-dark #branch-banner-close{ color: #fff; text-shadow: 0 1px 1px rgba(0, 0, 0, .15); }\n#branch-banner .theme-dark .details { text-shadow: 0 1px 1px rgba(0, 0, 0, .15); }\n#branch-banner .theme-dark .title { color: #fff; }\n#branch-banner .theme-dark .description { color: #fff; }\n#branch-banner .theme-dark .reviews { color: #888; }\n#branch-banner .theme-dark .reviews .star span{ color: #fff; }\n#branch-banner .theme-dark .reviews .review-count{ color: #fff; }\n',n=N();"ios"!==n&&"ipad"!==n||!e.T?"android"===n&&e.O?r+="#branch-banner { position: absolute; }\n#branch-banner .content .left .details .title { font-size: 12px; }\n#branch-mobile-action { white-space: nowrap; }\n#branch-banner .content .left .details .description { font-size: 11px; font-weight: normal; }\n@media only screen and (min-device-width: 320px) and (max-device-width: 350px) { #branch-banner .content .right { max-width: 120px; } }\n@media only screen and (min-device-width: 351px) and (max-device-width: 400px) and (orientation: landscape) { #branch-banner .content .right { max-width: 150px; } }\n@media only screen and (min-device-width: 401px) and (max-device-width: 480px) and (orientation: landscape) { #branch-banner .content .right { max-width: 180px; } }\n#branch-banner #branch-banner-close,#branch-banner .theme-dark #branch-banner-close { height:17px; width: 17px; text-align: center; font-size: 15px; top: 24px;  border-radius:14px; border:0; line-height:14px; color:#b1b1b3; background:#efefef; padding: 0; opacity: 1; }\n#branch-banner .button { top: 0; text-decoration:none; border-bottom: 3px solid #A4C639; padding: 0 10px; height: 24px; line-height: 24px; text-align: center; color: #fff; margin-top: 2px;  font-weight: bold; background-color: #A4C639; border-radius: 5px; }\n#branch-banner .button:hover { border-bottom:3px solid #8c9c29; background-color: #c1d739; }\n":"blackberry"===n&&e.P?r+="#branch-banner { position: absolute; }\n#branch-banner .content .left .details .title { font-size: 12px; }\n#branch-mobile-action { white-space: nowrap; }\n#branch-banner .content .left .details .description { font-size: 11px; font-weight: normal; }\n@media only screen and (min-device-width: 320px) and (max-device-width: 350px) { #branch-banner .content .right { max-width: 120px; } }\n@media only screen and (min-device-width: 351px) and (max-device-width: 400px) and (orientation: landscape) { #branch-banner .content .right { max-width: 150px; } }\n@media only screen and (min-device-width: 401px) and (max-device-width: 480px) and (orientation: landscape) { #branch-banner .content .right { max-width: 180px; } }\n":"windows_phone"===n&&e.S?r+="#branch-banner { position: absolute; }\n#branch-banner .content .left .details .title { font-size: 12px; }\n#branch-mobile-action { white-space: nowrap; }\n#branch-banner .content .left .details .description { font-size: 11px; font-weight: normal; }\n@media only screen and (min-device-width: 320px) and (max-device-width: 350px) { #branch-banner .content .right { max-width: 120px; } }\n@media only screen and (min-device-width: 351px) and (max-device-width: 400px) and (orientation: landscape) { #branch-banner .content .right { max-width: 150px; } }\n@media only screen and (min-device-width: 401px) and (max-device-width: 480px) and (orientation: landscape) { #branch-banner .content .right { max-width: 180px; } }\n":"kindle"===n&&e.R?r+="#branch-banner { position: absolute; }\n#branch-banner .content .left .details .title { font-size: 12px; }\n#branch-mobile-action { white-space: nowrap; }\n#branch-banner .content .left .details .description { font-size: 11px; font-weight: normal; }\n@media only screen and (min-device-width: 320px) and (max-device-width: 350px) { #branch-banner .content .right { max-width: 120px; } }\n@media only screen and (min-device-width: 351px) and (max-device-width: 400px) and (orientation: landscape) { #branch-banner .content .right { max-width: 150px; } }\n@media only screen and (min-device-width: 401px) and (max-device-width: 480px) and (orientation: landscape) { #branch-banner .content .right { max-width: 180px; } }\n":(r+="#branch-banner { position: fixed; min-width: 600px; }\n#branch-sms-block * { vertical-align: bottom; font-size: 15px; }\n#branch-sms-block { display: inline-block; }\n#branch-banner input{ border: 1px solid #ccc;  font-weight: 400;  border-radius: 4px; height: 30px; padding: 5px 7px 4px; width: 145px; font-size: 14px;}\n#branch-banner input:focus { outline: none; }\n#branch-banner input.error { color: rgb(194, 0, 0); border-color: rgb(194, 0, 0); }\n#branch-banner .branch-icon-wrapper { width:25px; height: 25px; vertical-align: middle; display: inline-block; margin-top: -18px; }\n@keyframes branch-spinner { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); -ms-transform: rotate(0deg); } 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg); -ms-transform: rotate(360deg); } }\n@-webkit-keyframes branch-spinner { 0% { transform: rotate(0deg); -webkit-transform: rotate(0deg); -ms-transform: rotate(0deg); } 100% { transform: rotate(360deg); -webkit-transform: rotate(360deg); -ms-transform: rotate(360deg); } }\n#branch-spinner { -webkit-animation: branch-spinner 1s ease-in-out infinite; animation: branch-spinner 1s ease-in-out infinite; transition: all 0.7s ease-in-out; border:2px solid #ddd; border-bottom-color:#428bca; width:80%; height:80%; border-radius:50%; -webkit-font-smoothing: antialiased !important; }\n#branch-banner .theme-dark input { border-color: transparent; }\n",r=window.ActiveXObject?r+"#branch-banner .checkmark { color: #428bca; font-size: 22px; }\n":r+"#branch-banner .checkmark { stroke: #428bca; stroke-dashoffset: 745.74853515625; stroke-dasharray: 745.74853515625; -webkit-animation: dash 2s ease-out forwards; animation: dash 2s ease-out forwards; }\n@-webkit-keyframes dash { 0% { stroke-dashoffset: 745.748535 15625; } 100% { stroke-dashoffset: 0; } }\n@keyframes dash { 0% { stroke-dashoffset: 745.74853515625; } 100% { stroke-dashoffset: 0; } }\n"):r+="#branch-banner { position: absolute; }\n#branch-banner .content .left .details .title { font-size: 12px; }\n#branch-mobile-action { white-space: nowrap; }\n#branch-banner .content .left .details .description { font-size: 11px; font-weight: normal; }\n@media only screen and (min-device-width: 320px) and (max-device-width: 350px) { #branch-banner .content .right { max-width: 120px; } }\n@media only screen and (min-device-width: 351px) and (max-device-width: 400px) and (orientation: landscape) { #branch-banner .content .right { max-width: 150px; } }\n@media only screen and (min-device-width: 401px) and (max-device-width: 480px) and (orientation: landscape) { #branch-banner .content .right { max-width: 180px; } }\n",r+=e.ea,e.D&&(r+="body { margin: 0; }\n",(n=document.createElement("style")).type="text/css",n.id="branch-iframe-css",oe(n),n.innerHTML="body { -webkit-transition: all 0.375s ease; transition: all 00.375s ease; }\n#branch-banner-iframe { box-shadow: 0 0 5px rgba(0, 0, 0, .35); width: 1px; min-width:100%; left: 0; right: 0; border: 0; height: 76px; z-index: 99999; -webkit-transition: all 0.25s ease; transition: all 00.25s ease; }\n"+(N()?$e(e.la,e.position):$e(e.fa,e.position)),(document.head||document.getElementsByTagName("head")[0]).appendChild(n)),(n=document.createElement("style")).type="text/css",n.id="branch-css",n.innerHTML=r,oe(n),(r=(r=e.D?t.contentWindow.document:document).head||r.getElementsByTagName("head")[0])&&"function"==typeof r.appendChild&&r.appendChild(n),"top"===e.position?t.style.top="-76px":"bottom"===e.position&&(t.style.bottom="-76px")}(t,o),r.channel=r.channel||"app banner";var s=t.D?o.contentWindow.document:document;N()?(t.open_app=t.na,t.append_deeplink_path=t.ba,t.make_new_link=t.ka,t.deepview_type="banner",e.deepview(r,t),(l=s.getElementById("branch-mobile-action"))&&(l.onclick=function(t){t.preventDefault(),e.deepviewCta()})):s.getElementById("sms-form")?s.getElementById("sms-form").addEventListener("submit",function(n){n.preventDefault(),Qe(s,e,t,r)}):o.onload=function(){(s=o.contentWindow.document).getElementById("sms-form")&&s.getElementById("sms-form").addEventListener("submit",function(n){n.preventDefault(),Qe(s,e,t,r)})};var l=Ye("margin-top"),u=document.body.style.marginTop,c=Ye("margin-bottom"),d=document.body.style.marginBottom,f=s.getElementById("branch-banner-close");return f&&(f.onclick=function(t){t.preventDefault(),qt(e,"willCloseBanner"),i({},function(){qt(e,"didCloseBanner")})}),ze(document.body,"branch-banner-is-active"),"top"===t.position?document.body.style.marginTop=Xe(l):"bottom"===t.position&&(document.body.style.marginBottom=Xe(c)),t.X?a():setTimeout(a,20),i}Pe.prototype.local=function(){return Ne(!0)},Pe.prototype.session=function(){return Ne(!1)},Pe.prototype.cookie=function(){return function(){function e(e,t){t&&(e=Ie(e)),document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"}return{getAll:function(){for(var e={},t=document.cookie.split(";"),r=0;r<t.length;r++){var n=Fe(t[r]);n&&n.hasOwnProperty("name")&&n.hasOwnProperty("value")&&Me(n.name)&&(e[n.name.replace("BRANCH_WEBSDK_KEY","")]=n.value)}return e},get:function(e){e=Ie(e);for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var n=Fe(t[r]);if(n&&n.hasOwnProperty("name")&&n.hasOwnProperty("value")&&n.name===e)return n.value}return null},set:function(e,t){document.cookie=Ie(e)+"="+t+"; path=/"},remove:function(t){e(t,!0)},clear:function(){for(var t=document.cookie.split(";"),r=0;r<t.length;r++){var n=Fe(t[r]);n&&n.hasOwnProperty("name")&&Me(n.name)&&e(n.name,!1)}},isEnabled:function(){return navigator.cookieEnabled}}}()},Pe.prototype.pojo={getAll:function(){return this.u},get:function(e){return this.u[e]||null},set:function(e,t){this.u[e]=t},remove:function(e){delete this.u[e]},clear:function(){this.u={}},isEnabled:function(){return!0}},Ge.prototype.g=0;var et,tt=1,rt="top",nt="absolute",it="76px",at=!1,ot=!1,st=[],lt=window.innerHeight,ut=window.innerWidth;window.innerHeight<window.innerWidth&&(lt=window.innerWidth,ut=window.innerHeight);var ct=0,dt=0,ft=/<script type="application\/json">((.|\s)*?)<\/script>/,ht=/<script type="text\/javascript">((.|\s)*?)<\/script>/,pt=/<style type="text\/css" id="branch-css">((.|\s)*?)<\/style>/,vt=/#branch-banner-spacer {((.|\s)*?)}/,gt=/margin-bottom: (.*?);/,yt=/<script id="journeyLinkData" type="application\/json">((.|\s)*?)<\/script>/,mt=null,bt=null,_t=!1,Et=!1,kt=!1,wt=!1,Tt=!1,St="",At=[],Rt=null;function xt(e){if(e=e.match(ft))return v(e[1])}function Lt(){var e=document.createElement("style");e.type="text/css",e.id="branch-iframe-css";var t=+(ct=Ye("margin-top")).slice(0,-2),r=+(dt=Ye("margin-bottom")).slice(0,-2),n=+it.slice(0,-2);"top"===rt?document.body.style.marginTop=(+n+t).toString()+"px":"bottom"===rt&&(document.body.style.marginBottom=(+n+r).toString()+"px"),0<st.length&&st.forEach(function(e){var t,r=window.getComputedStyle(e);r&&(t=at&&"fixed"===r.getPropertyValue("position")),t||(e.style.marginTop=it)}),"top"===St&&St!==rt&&Tt&&At&&0<At.length&&At.forEach(function(e){e.style.marginTop=0}),Tt=!1,St="",At=[],wt=!1,e.innerHTML=function(){var e="",t="";return document.body.style.transition="",document.getElementById("branch-banner-iframe")&&(document.getElementById("branch-banner-iframe").style.transition=""),kt||(e="body { -webkit-transition: all 0.375s ease; }\n",document.body.style.transition="all 00.375s ease",t="-webkit-transition: all 0.25s ease; transition: all 00.25s ease;"),(e||"")+"#branch-banner-iframe { box-shadow: 0 0 5px rgba(0, 0, 0, .35); width: 1px; min-width:100%; left: 0; right: 0; border: 0; height: "+it+"; z-index: 99999; "+t+" }\n#branch-banner-iframe { position: "+nt+"; }\n@media only screen and (orientation: landscape) { body { "+("top"===rt?"margin-top: ":"margin-bottom: ")+(at?ut+"px":it)+"; }\n#branch-banner-iframe { height: "+(at?ut+"px":it)+"; }"}(),oe(e),document.head.appendChild(e)}function Ot(e,t,r,n,i,a,o){var s=Ct;n&&i&&(Array.prototype.forEach.call(i.contentWindow.document.querySelectorAll("#branch-mobile-action"),function(e){e.addEventListener("click",function(){qt(mt,"didClickJourneyCTA",Rt),wt=!0,n(),It(i)})}),Dt(".branch-banner-continue","didClickJourneyContinue",r,i,e,t,a,o,s),Dt(".branch-banner-close","didClickJourneyClose",r,i,e,t,a,o,s))}function Dt(e,t,r,n,i,a,o,s,l){Array.prototype.forEach.call(n.contentWindow.document.querySelectorAll(e),function(e){e.addEventListener("click",function(){!function(e,t,r,n,i,a,o,s){var l=o?0:function(e){if("number"==typeof(e=e.globalDismissPeriod)){if(-1===e)e=!0;else{var t=new Date;e=t.setSeconds(t.getSeconds()+e)}return e}}(a);if(qt(mt,e,Rt),wt=!0,It(r),!o)if(void 0!==l&&t.set("globalJourneysDismiss",l,!0),function(e,t,r){var n;(n=(n=e.get("journeyDismissals",!0))?v(n):{})[r]={view_id:t,dismiss_time:Date.now()},e.set("journeyDismissals",g(n),!0)}(t,n,i),a.dismissRedirect)window.location=a.dismissRedirect;else{var u=function(){mt.removeListener(u);var e=function(e){var t={},r=W();return r&&0<Object.keys(r).length&&(t.hosted_deeplink_data=r),e.I(Pt(null,t),null,mt,!0)}(s);mt.b(De,e,function(t,r){!t&&"object"==typeof r&&r.template&&s.N(r,null,!1)&&s.J(r.template,e,e.branch_view_id||r.event_data.branch_view_data.id,r.event_data.branch_view_data,!1)})};mt.addListener("branch_internal_event_didCloseJourney",u)}}(t,r,n,i,a,o,s,l)})})}function Pt(e,t){return F({url:e&&e.url||I(),user_agent:navigator.userAgent,language:navigator.language,screen_width:screen.width||-1,screen_height:screen.height||-1},t||{})}function It(e,t){if(kt&&!Et){document.body.style.transition="all 00.375s ease",document.getElementById("branch-banner-iframe").style.transition="all 00.25s ease";var r=document.getElementById("branch-iframe-css").innerHTML+"\n";document.getElementById("branch-iframe-css").innerHTML="",document.getElementById("branch-iframe-css").innerHTML=r+"body { -webkit-transition: all 0.375s ease; }\n#branch-banner-iframe { -webkit-transition: all 0.25s ease; }\n"}"top"===rt?e.style.top="-"+it:"bottom"===rt&&(e.style.bottom="-"+it),qt(mt,"willCloseJourney",Rt),setTimeout(function(){Ve(e),Ve(document.getElementById("branch-css")),Ve(document.getElementById("branch-iframe-css")),Ve(document.getElementById("branch-journey-cta")),(!Et||wt)&&st&&0<st.length?st.forEach(function(e){e.style.marginTop=0}):(Tt=Et,St=rt,At=st),"top"===rt?document.body.style.marginTop=ct:"bottom"===rt&&(document.body.style.marginBottom=dt),qe("branch-banner-is-active"),qe("branch-banner-no-scroll"),qt(mt,"didCloseJourney",Rt),t||qt(mt,"branch_internal_event_didCloseJourney",Rt),_t=!1},Et?0:270)}var Ct={};function Mt(e,t){var r,n={banner_id:et};if(a=e.match(yt)){var i=a[1],a="";try{a=v(i)}catch(e){}if(a){var o=["browser_fingerprint_id","app_id","source","open_app","link_click_id"];if((i=a.journey_link_data)&&"object"==typeof i&&!Array.isArray(i)&&0<Object.keys(i).length&&o&&Array.isArray(o)&&0<o.length)for(var s in i)i.hasOwnProperty(s)&&-1<o.indexOf(s)&&delete i[s];n=F(n,a)}}if((Rt=n,n=t?"OPEN":"GET",(a=xt(s=e))&&a.bannerHeight&&a.position&&a.sticky?(it=a.bannerHeight,rt=a.position,nt=a.sticky):(s=s.match(vt))?(rt="top",(s=s[1].match(gt))&&(it=s[1]),nt="absolute"):(rt="bottom",nt="fixed"),-1===it.indexOf("vh")&&-1===it.indexOf("%")||(s=it.indexOf("vh")?it.slice(0,-2):it.slice(0,-1),it=s/100*lt+"px",100>s?ot=!0:at=!0),s=xt(e))&&(t&&s&&s.ctaText&&s.ctaText.has_app?r=s.ctaText.has_app:s&&s.ctaText&&s.ctaText.no_app&&(r=s.ctaText.no_app),n=r,st=[],s&&s.injectorSelector&&(r=document.querySelectorAll(s.injectorSelector))))for(s=0;s<r.length;s++)st.push(r[s].parentElement);r=(r=e.match(pt))?r[1]:void 0,(s=e.match(ht))&&(s=s[1],(a=document.createElement("script")).id="branch-journey-cta",oe(a),a.innerHTML=s,document.body.appendChild(a));a=(s=e).match(ft),i=s.match(ht),o=s.match(pt);var l=s.match(yt);(a&&(s=s.replace(ft,"")),i&&(s=s.replace(ht,"")),o&&(s=s.replace(pt,"")),l&&(s=s.replace(yt,"")),e=s,(s=document.createElement("iframe")).src="about:blank",s.style.overflow="hidden",s.scrolling="no",s.id="branch-banner-iframe",s.className="branch-animation",s.title="Branch Banner",s.setAttribute("aria-label","Branch Banner"),oe(s),document.body.appendChild(s),a='<html><head></head><body class="'+("ios"===(a=N())||"ipad"===a?"branch-banner-ios":"android"===a?"branch-banner-android":"branch-banner-desktop")+'">'+e+"</body></html>",s.contentWindow.document.open(),s.contentWindow.document.write(a),s.contentWindow.document.close(),Lt(),(a=document.createElement("style")).type="text/css",a.id="branch-css",a.innerHTML=r,oe(a),(r=s.contentWindow.document).head.appendChild(a),ot||at)&&((u=r.getElementsByClassName("branch-banner-content")[0])&&(u.style.height=it));"top"===rt?s.style.top="-"+it:"bottom"===rt&&(s.style.bottom="-"+it);try{var u=r.getElementsByClassName("branch-banner-content")[0],c=window.getComputedStyle(u).getPropertyValue("background-color").split(", ");c[3]&&!parseFloat(c[3])&&(s.style.boxShadow="none")}catch(e){}return s.contentWindow.document.getElementById("branch-mobile-action").innerHTML=n,qt(mt,"willShowJourney",Rt),function(e){ze(document.body,"branch-banner-is-active"),at&&"fixed"===nt&&ze(document.body,"branch-banner-no-scroll"),setTimeout(function(){"top"===rt?e.style.top="0":"bottom"===rt&&(e.style.bottom="0"),qt(mt,"didShowJourney",Rt),_t=!0},20)}(s),s}Ct.N=function(e,t,r){return!(document.getElementById("branch-banner")||document.getElementById("branch-banner-iframe")||document.getElementById("branch-banner-container")||!N()||!e.event_data||!e.template)&&(!!r||((e=!e.event_data.branch_view_data.id||t&&t.no_journeys)||(!0===(t=(e=mt).c.get("globalJourneysDismiss",!0))||t>Date.now()?e=!0:(e.c.remove("globalJourneysDismiss",!0),e=!1)),!e||(Ct.za=1,!1)))},Ct.ja=function(e){mt.b(Oe,{event:"pageview",journey_displayed:!0,audience_rule_id:e.audience_rule_id,branch_view_id:e.branch_view_id},function(){})},Ct.J=function(e,t,r,n,i){et=r;var a=n.audience_rule_id,o=document.getElementById("branch-iframe-css");o&&o.parentElement.removeChild(o),(o=document.createElement("div")).id="branch-banner",document.body.insertBefore(o,null),ze(o,"branch-banner-is-active");var s=!1,l=t.callback_string,u=null,c=null,d=mt.c;if(e){var f=xt(e)||{},h=window.setTimeout(function(){window[l]=function(){}},_);if(window[l]=function(e){window.clearTimeout(h),s||Ot(r,a,d,c=e,u,f,i)},bt=u=Mt(e,t.has_app_websdk),null===u)return void(s=!0);Ot(r,a,d,c,u,f,i),w&&(k["journey-load-time"]=(Date.now()-window.performance.timing.navigationStart).toString())}document.body.removeChild(o),A||i||Ct.ja(n)},Ct.I=function(e,t,r,n){mt=r,t||(t={}),e||(e={}),kt=t.disable_entry_animation||!1,Et=t.disable_exit_animation||!1;var i,a=F({},r.H),o=Ue(r.c)||{},s=!!o.hasOwnProperty("has_app")&&o.has_app,l=r.c.get("journeyDismissals",!0),u=(t.user_language||K()||"en").toLowerCase()||null,c=ne(zt(r));return(i=t.branch_view_id)||(i="_branch_view_id".replace(/[\[\]]/g,"\\$&"),i=(i=new RegExp("[?&]"+i+"(=([^&#]*)|&|#|$)").exec(I()))&&i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):""),i=i||null,r=t.make_new_link?null:M(zt(r)),a.event=n?"dismiss":"pageview",a.metadata=e,(a=$(a=$(a=$(a=$(a=$(a,"initial_referrer",c),"branch_view_id",i),"no_journeys",t.no_journeys),"is_iframe",te()),"journey_dismissals",l)).user_language=u,a.open_app=t.open_app||!1,a.has_app_websdk=s,a.feature="journeys",a.callback_string="branch_view_callback__"+tt++,a.data||(a.data={}),a.data=F(W(),a.data),a.data=F(function(e){var t=/^\$journeys_\S+$/,r=e.data,n={};if(!r)return{};switch(typeof r){case"string":try{r=v(r)}catch(e){r={}}break;case"object":break;default:r={}}return Object.keys(r).forEach(function(e){t.test(e)&&(n[e]=r[e])}),n}(o||{}),a.data),r&&(a.data.link_click_id=r),C(a)};var Ft,Nt={androidAppIndexingTagsPresent:!1,iosAppIndexingTagsPresent:!1,androidDetailsComplete:!1,iosDetailsComplete:!1},Ut={};function Bt(e){"android"===e&&Nt.androidDetailsComplete&&Gt(jt("android-app://"+Ut.androidPackageName+"/"+Ut.androidURL)),"ios"===e&&Nt.iosDetailsComplete&&Gt(jt("ios-app://"+Ut.iosAppId+"/"+Ut.iosURL))}function jt(e){var t={"~channel":"Firebase App Indexing","~feature":"Auto App Indexing",$canonical_url:I()};if("object"==typeof Ut.data)for(var r in Ut.data)Ut.data.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=Ut.data[r]);return e+(-1<e.indexOf("?")?"&":"?")+"link_click_id=a-"+btoa(g(t))}function Gt(e){var t=document.createElement("link");t.setAttribute("rel","alternate"),t.setAttribute("href",e),document.head.appendChild(t)}function Ht(e){"android"===e&&"string"==typeof Ut.androidPackageName&&"string"==typeof Ut.androidURL&&(Nt.androidDetailsComplete=!0,Bt("android")),"ios"===e&&"string"==typeof Ut.iosAppId&&"string"==typeof Ut.iosURL&&(Nt.iosDetailsComplete=!0,Bt("ios"))}function Wt(e){for(var t=document.getElementsByTagName("meta"),r=0;r<t.length;r++){var n=t[r];"ios"===e&&"al:ios:app_store_id"===n.getAttribute("property")&&(Ut.iosAppId=n.getAttribute("content")),"ios"===e&&"al:ios:url"===n.getAttribute("property")&&(Ut.iosURL=n.getAttribute("content").replace("://","/")),"android"===e&&"al:android:package"===n.getAttribute("property")&&(Ut.androidPackageName=n.getAttribute("content")),"android"===e&&"al:android:url"===n.getAttribute("property")&&(Ut.androidURL=n.getAttribute("content").replace("://","/"))}Ht(e)}function Kt(e,t,r){return function(){var n,i,a=this,o=arguments[arguments.length-1];e&&"function"==typeof o?(n=Array.prototype.slice.call(arguments,0,arguments.length-1)||[],i=o):(i=function(){},n=Array.prototype.slice.call(arguments)),a.$(function(o){function s(t,r){try{if(t&&!e)throw t;1===e?i(t):2===e&&i(t,r)}finally{o()}}if(!r){if(1===a.j)return s(Error(D("Branch SDK initialization pending and a Branch method was called outside of the queue order")),null);if(2===a.j)return s(Error(D("Branch SDK initialization failed, so further methods cannot be called",a.i,a.l)),null);if(0===a.j||!a.j)return s(Error(D("Branch SDK not initialized")),null)}n.unshift(s),t.apply(a,n)})}}function Vt(){if(!(this instanceof Vt))return Ft||(Ft=new Vt),Ft;this.$=y(),this.c=new Pe(["session","cookie","pojo"]),this.ca=new Ge,this.g=[],this.V="web2.45.0",this.i=this.j=0,this.l=null}function zt(e){var t=Ue(e.c);return(t=t&&t.referring_link)?t:(e=e.c.get("click_id"))?"https://bnc.lt/c/"+e:null}function qt(e,t,r){for(var n=0;n<e.g.length;n++)e.g[n].event&&e.g[n].event!==t||e.g[n].listener(t,r)}function Yt(e,t,r){r=r||{};try{e.H=v(g(r))}finally{e.H=e.H||{}}t()}Vt.prototype.b=function(e,t,r){return this.U&&(t.app_id=this.U),this.h&&(t.branch_key=this.h),(e.a&&e.a.session_id||e.f&&e.f.session_id)&&this.G&&(t.session_id=this.G),(e.a&&e.a.identity_id||e.f&&e.f.identity_id)&&this.v&&(t.identity_id=this.v),(e.a&&e.a.link_click_id||e.f&&e.f.link_click_id)&&this.Z&&(t.link_click_id=this.Z),(e.a&&e.a.sdk||e.f&&e.f.sdk)&&this.V&&(t.sdk=this.V),(e.a&&e.a.browser_fingerprint_id||e.f&&e.f.browser_fingerprint_id)&&this.B&&(t.browser_fingerprint_id=this.B),A&&(t.tracking_disabled=A),Ke(this.ca,e,t,this.c,function(e,t){r(e,t)})},Vt.prototype.init=Kt(2,function(e,t,r){function n(){var e,t;void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.mozHidden?(e="mozHidden",t="mozvisibilitychange"):void 0!==document.msHidden?(e="msHidden",t="msvisibilitychange"):void 0!==document.webkitHidden&&(e="webkitHidden",t="webkitvisibilitychange"),t&&!o.da&&(o.da=!0,document.addEventListener(t,function(){document[e]||(a(null),"function"==typeof o.s&&o.s())},!1))}function i(t,n){if(n&&(n=function(e){if(e.link_click_id&&(o.Z=e.link_click_id.toString()),e.session_id&&(o.G=e.session_id.toString()),e.identity_id&&(o.v=e.identity_id.toString()),e.link&&(o.M=e.link),e.referring_link){var t=e.referring_link;e.referring_link=t?"http"!==t.substring(0,4)?"https://bnc.lt"+t:t:null}return!e.click_id&&e.referring_link&&(e.click_id=M(e.referring_link)),o.B=e.browser_fingerprint_id,e}(n),A||Be(o.c,n,l),o.j=3,n.data_parsed=n.data&&0!==n.data.length?v(n.data):{}),t)return o.j=2,o.i||(o.i=1,o.l=t.message),e(t,n&&P(n));try{e(t,n&&P(n))}catch(e){}finally{o.renderFinalize()}var i=function(){var e,t={};return(t=$(t=$(t=$(t=$(t=$(t,"og_data",e=(e=$(e=$(e=$(e=$(e={},"$og_title",H("title")),"$og_description",H("description")),"$og_image_url",H("image")),"$og_video",H("video")))&&0<Object.keys(e).length?e:null),"hosted_deeplink_data",W()),"title",0<(e=document.getElementsByTagName("title")).length?e[0].innerText:null),"description",(e=document.querySelector('meta[name="description"]'))&&e.content?e.content:null),"canonical_url",(e=document.querySelector('link[rel="canonical"]'))&&e.href?e.href:null))&&0<Object.keys(t).length?t:{}}(),a=Z(r.metadata,"object")?r.metadata:null;a&&(a=ae(i.hosted_deeplink_data,a))&&0<Object.keys(a).length&&(i.hosted_deeplink_data=a);var s=Ct.I(Pt(r,i),r,o,!1);o.renderQueue(function(){o.b(Oe,s,function(e,t){if(!e&&"object"==typeof t){var n=!!s.branch_view_id;Ct.N(t,r,n)?Ct.J(t.template,s,s.branch_view_id||t.event_data.branch_view_data.id,t.event_data.branch_view_data,n):qt(mt,"willNotShowJourney")}A&&(x=!0)})})}function a(e){var t={sdk:"2.45.0",branch_key:o.h},r=Ue(o.c)||{},n=Ue(o.c,!0)||{};n.browser_fingerprint_id&&(t._t=n.browser_fingerprint_id),U()||o.b(de,t,function(e,t){e&&(o.i=3,o.l=e.message),t&&(r.browser_fingerprint_id=t)}),o.b(Se,{browser_fingerprint_id:r.browser_fingerprint_id},function(t,n){t&&(o.i=4,o.l=t.message),t||!n||r.has_app||(r.has_app=!0,je(o.c,r),qt(o,"didDownloadApp")),e&&e(null,r)})}w&&(k["init-began-at"]=(Date.now()-window.performance.timing.navigationStart).toString());var o=this;o.j=1,-1<t.indexOf("key_")?o.h=t:o.U=t,r=r&&Z(r,"object")?r:{},m=(o.F=r)&&r.retries&&Number.isInteger(r.retries)?r.retries:m,b=r&&r.retry_delay&&Number.isInteger(r.retry_delay)?r.retry_delay:b,_=r&&r.timeout&&Number.isInteger(r.timeout)?r.timeout:_,E=r&&r.nonce?r.nonce:E,A=!(!r||!r.tracking_disabled||!0!==r.tracking_disabled),x=!1,A&&O(o),t=Ue(o.c);var s=(r&&void 0!==r.branch_match_id&&null!==r.branch_match_id?r.branch_match_id:null)||function(){try{var e=(te()&&re()?window.top.location.search:window.location.search).substring(1).match(/_branch_match_id=([^&]*)/);if(e&&1<=e.length)return e[1]}catch(e){}}()||function(){try{var e=(te()&&re()?window.top.location.hash:window.location.hash).match(/r:([^&]*)/);if(e&&1<=e.length)return e[1]}catch(e){}}(),l=!t||!t.identity_id;if(o.A=!!o.c.get("branch_view_enabled"),t&&t.session_id&&!s)je(o.c,{data:""}),je(o.c,{referring_link:""}),n(),a(i);else{t={sdk:"2.45.0",branch_key:o.h};var u=Ue(o.c,!0)||{};u.browser_fingerprint_id&&(t._t=u.browser_fingerprint_id),U()?o.b(ce,{link_identifier:s,browser_fingerprint_id:s||u.browser_fingerprint_id,alternative_browser_fingerprint_id:u.browser_fingerprint_id,options:r,initial_referrer:ne(zt(o))},function(e,t){e&&(o.i=2,o.l=e.message),e||"object"!=typeof t||(t.branch_view_enabled&&(o.A=!!t.branch_view_enabled,o.c.set("branch_view_enabled",o.A)),s&&(t.click_id=s)),n(),i(e,t)}):o.b(de,t,function(e,t){if(e)return o.i=3,o.l=e.message,i(e,null);o.b(ce,{link_identifier:s,browser_fingerprint_id:s||t,alternative_browser_fingerprint_id:u.browser_fingerprint_id,options:r,initial_referrer:ne(zt(o))},function(e,t){e&&(o.i=2,o.l=e.message),e||"object"!=typeof t||(t.branch_view_enabled&&(o.A=!!t.branch_view_enabled,o.c.set("branch_view_enabled",o.A)),s&&(t.click_id=s)),n(),i(e,t)})})}},!0),Vt.prototype.renderQueue=Kt(0,function(e,t){this.aa?t():(this.m=this.m||[],this.m.push(t)),e(null,null)}),Vt.prototype.renderFinalize=Kt(2,function(e){this.m&&0<this.m.length&&(this.m.forEach(function(e){e.call(this)}),delete this.m),this.aa=!0,e(null,null)}),Vt.prototype.data=Kt(2,function(e){var t=P(Ue(this.c));t.referring_link=zt(this),t.data_parsed=t.data&&0!==t.data.length?v(t.data):{},e(null,t)}),Vt.prototype.first=Kt(2,function(e){e(null,P(Ue(this.c,!0)))}),Vt.prototype.setIdentity=Kt(2,function(e,t){var r=this;this.b(me,{identity:t},function(n,i){n&&e(n),i=i||{},r.v=i.identity_id?i.identity_id.toString():null,r.M=i.link,r.C=t,i.referring_data_parsed=i.referring_data?v(i.referring_data):null,je(r.c,i),e(null,i)})}),Vt.prototype.logout=Kt(1,function(e){var t=this;this.b(ye,{},function(r,n){r&&e(r),n={data_parsed:null,data:null,referring_link:null,click_id:null,link_click_id:null,identity:null,session_id:(n=n||{}).session_id,identity_id:n.identity_id,link:n.link,device_fingerprint_id:t.ga||null},t.M=n.link,t.G=n.session_id,t.v=n.identity_id,t.C=n.identity,je(t.c,n),e(null)})}),Vt.prototype.getBrowserFingerprintId=Kt(2,function(e){e(null,(Ue(this.c,!0)||{}).browser_fingerprint_id||null)}),Vt.prototype.track=Kt(1,function(e,t,r,n){if(r=r||{},E=(n=n||{}).nonce?n.nonce:E,"pageview"===t){(t=ae(W(),r))&&0<Object.keys(t).length&&(r.hosted_deeplink_data=t);var i=Ct.I(Pt(n,r),n,this,!1);this.b(Oe,i,function(t,r){if(!t&&"object"==typeof r){var a=!!i.branch_view_id;Ct.N(r,n,a)?Ct.J(r.template,i,i.branch_view_id||r.event_data.branch_view_data.id,r.event_data.branch_view_data,a):qt(mt,"willNotShowJourney")}"function"==typeof e&&e.apply(this,arguments)})}else this.b(Ae,{event:t,metadata:F({url:I(),user_agent:navigator.userAgent,language:navigator.language},r),initial_referrer:ne(zt(this))},function(t,r){"function"==typeof e&&e.apply(this,arguments)})}),Vt.prototype.logEvent=Kt(1,function(e,t,r,n){t=Z(t,"string")?t:null,r=Z(r,"object")?r:null,-1<J.indexOf(t)?(n=Z(n,"array")?n:null,r=function(e){if(!e||!Object.keys(e).length)return null;for(var t=V(Q,Object.keys(e)),r={},n=0;n<t.length;n++){var i=t[n];r[i]=e[i],delete e[i]}return{custom_data:ie(r),event_data:e}}(r),this.b(xe,{name:t,user_data:g(ee(this)),custom_data:g(r&&r.custom_data||{}),event_data:g(r&&r.event_data||{}),content_items:g(n||[])},function(t){return e(t||null)})):this.b(Le,{name:t,user_data:g(ee(this)),custom_data:g(ie(r)||{})},function(t){return e(t||null)})}),Vt.prototype.link=Kt(2,function(e,t){var r=C(t),n=this.h;this.b(we,r,function(t,i){if(t)return e(null,L(n,r));e(null,i&&i.url)})}),Vt.prototype.sendSMS=Kt(1,function(e,t,r,n){function i(r){a.b(he,{link_url:r,phone:t},function(t){e(t||null)})}var a=this;"function"==typeof n?n={}:void 0!==n&&null!==n||(n={}),n.make_new_link=n.make_new_link||!1,r.channel&&"app banner"!==r.channel||(r.channel="sms");var o=zt(a);o&&!n.make_new_link?i(M(o)):a.b(we,C(r),function(t,r){if(t)return e(t);var n=r.url;/(bnc.lt\/|app\.link\/)/.test(n)||(n="https://bnc.lt/"+function(e){return e?(-1<e.indexOf("://")&&(e=e.split("://")[1]),e.substring(e.indexOf("/")+1)):null}(n)),a.b(fe,{link_url:n,click:"click"},function(t,r){if(t)return e(t);i(r.click_id)})})}),Vt.prototype.deepview=Kt(1,function(e,t,r){var n=this;r||(r={}),r.deepview_type=void 0===r.deepview_type?"deepview":"banner",t.data=F(W(),t.data),t=C(t=te()?F({is_iframe:!0},t):t);var i=L(this.h,t);(r.open_app||null===r.open_app||void 0===r.open_app)&&(t.open_app=!0),t.append_deeplink_path=!!r.append_deeplink_path,t.deepview_type=r.deepview_type;var a=zt(n);a&&!r.make_new_link&&(t.link_click_id=M(a)),t.banner_options=r,n.s=c(this.b,n,Te,t,function(t,r){if(t)return A||(n.o=function(){window.top.location=i}),e(t);"function"==typeof r&&(n.o=r),e(null)}),n.s()}),Vt.prototype.deepviewCta=Kt(1,function(e){if(void 0===this.o)return e(A?Error("Requested operation cannot be completed since tracking is disabled"):Error("Cannot call Deepview CTA, please call branch.deepview() first"),null);window.event&&(window.event.preventDefault?window.event.preventDefault():window.event.returnValue=!1),qt(this,"didDeepviewCTA"),this.o(),e()}),Vt.prototype.referrals=Kt(2,function(e){this.b(be,{},e)}),Vt.prototype.getCode=Kt(2,function(e,t){t.type="credit",t.creation_source=t.creation_source||2,this.b(pe,t,e)}),Vt.prototype.validateCode=Kt(1,function(e,t){this.b(ve,{code:t},e)}),Vt.prototype.applyCode=Kt(1,function(e,t){this.b(ge,{code:t},e)}),Vt.prototype.credits=Kt(2,function(e){this.b(Ee,{branch_key:this.h,identity:this.C},e)}),Vt.prototype.creditHistory=Kt(2,function(e,t){this.b(_e,t||{},e)}),Vt.prototype.redeem=Kt(1,function(e,t,r){this.b(ke,{amount:t,bucket:r},function(t){e(t||null)})}),Vt.prototype.addListener=function(e,t){"function"==typeof e&&void 0===t&&(t=e,e=null),t&&this.g.push({listener:t,event:e||null})},Vt.prototype.removeListener=function(e){e&&(this.g=this.g.filter(function(t){if(t.listener!==e)return t}))},Vt.prototype.setBranchViewData=Kt(1,function(e,t){Yt.call(null,this,e,t)}),Vt.prototype.closeJourney=Kt(1,function(e){var t=this;t.renderQueue(function(){if(!bt||!_t)return e("Journey already dismissed.");qt(t,"didCallJourneyClose",Rt),It(bt,!0)}),e()}),Vt.prototype.banner=Kt(1,function(e,t,r){r=r||{},Yt.call(null,this,function(){},r),void 0===t.showAgain&&void 0!==t.forgetHide&&(t.showAgain=t.forgetHide);var n={icon:X(t.icon)||"",title:X(t.title)||"",description:X(t.description)||"",L:"number"==typeof t.reviewCount&&0<t.reviewCount?Math.floor(t.reviewCount):null,w:"number"==typeof t.rating&&5>=t.rating&&0<t.rating?Math.round(2*t.rating)/2:null,ma:X(t.openAppButtonText)||"View in app",ia:X(t.downloadAppButtonText)||"Download App",qa:X(t.sendLinkText)||"Send Link",oa:X(t.phonePreviewText)||"(999) 999-9999",D:void 0===t.iframe||t.iframe,T:void 0===t.showiOS||t.showiOS,sa:void 0===t.showiPad||t.showiPad,O:void 0===t.showAndroid||t.showAndroid,P:void 0===t.showBlackberry||t.showBlackberry,S:void 0===t.showWindowsPhone||t.showWindowsPhone,R:void 0===t.showKindle||t.showKindle,ra:void 0===t.showDesktop||t.showDesktop,ha:!!t.disableHide,K:"number"==typeof t.forgetHide?t.forgetHide:!!t.forgetHide,pa:void 0!==t.respectDNT&&t.respectDNT,position:t.position||"top",ea:t.customCSS||"",la:void 0!==t.mobileSticky&&t.mobileSticky,fa:void 0===t.desktopSticky||t.desktopSticky,va:t.buttonBorderColor||"",ta:t.buttonBackgroundColor||"",xa:t.buttonFontColor||"",wa:t.buttonBorderColorHover||"",ua:t.buttonBackgroundColorHover||"",ya:t.buttonFontColorHover||"",ka:!!t.make_new_link,na:!!t.open_app,X:!!t.immediate,ba:!!t.append_deeplink_path};void 0!==t.showMobile&&(n.T=t.showMobile,n.O=t.showMobile,n.P=t.showMobile,n.S=t.showMobile,n.R=t.showMobile),r.data=F(W(),r.data);var i=this;i.renderQueue(function(){i.W=Ze(i,n,r,i.c)}),e()}),Vt.prototype.closeBanner=Kt(0,function(e){var t=this;t.renderQueue(function(){t.W&&(qt(t,"willCloseBanner"),t.W(function(){qt(t,"didCloseBanner")}))}),e()}),Vt.prototype.autoAppIndex=Kt(1,function(e,t){t=t||{};var r=document.getElementsByTagName("link"),n=r.length;if(n)for(var i=0;i<n;i++){var a=r[i],o=a.href;o&&(o.includes("ios-app")&&(Nt.iosAppIndexingTagsPresent=!0,a.setAttribute("href",jt(o))),o.includes("android-app")&&(Nt.androidAppIndexingTagsPresent=!0,a.setAttribute("href",jt(o))))}Ut=t,Nt.androidAppIndexingTagsPresent||(Ht("android"),Nt.androidDetailsComplete||Wt("android")),Nt.iosAppIndexingTagsPresent||(Ht("ios"),Nt.iosDetailsComplete||Wt("ios")),Nt.iosDetailsComplete||Nt.androidDetailsComplete?e(null):e("Firebase App Indexing tags were not added to your webpage. Please check your configuration.")}),Vt.prototype.trackCommerceEvent=Kt(1,function(e,t,r,n){var i=this;i.renderQueue(function(){var a=Y(t,r);if(a)return e(Error(a));i.b(Re,{event:t,metadata:F({url:document.URL,user_agent:navigator.userAgent,language:navigator.language},n||{}),initial_referrer:ne(zt(i)),commerce_data:r},function(t){e(t||null)})}),e()}),Vt.prototype.disableTracking=Kt(1,function(e,t){!1===t||"false"===t?(x=A=!1,this.h&&this.F&&(!0===this.F.tracking_disabled&&delete this.F.tracking_disabled,this.init(this.h,this.F))):void 0!==t&&!0!==t&&"true"!==t||(O(this),x=A=!0,this.closeBanner(),this.closeJourney()),e()});var Xt=new Vt;if(window.branch&&window.branch._q)for(var $t=window.branch._q,Jt=0;Jt<$t.length;Jt++){var Qt=$t[Jt];Xt[Qt[0]].apply(Xt,Qt[1])}void 0===(i=function(){return Xt}.call(t,r,t,e))||(e.exports=i),window&&(window.branch=Xt)}()}).call(this,r(51))},,,function(e,t,r){var n=r(65),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=a.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var i=o.call(e);return n&&(t?e[s]=r:delete e[s]),i}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t,r){var n=/^\./,i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=r(274)(function(e){var t=[];return n.test(e)&&t.push(""),e.replace(i,function(e,r,n,i){t.push(n?i.replace(a,"$1"):r||e)}),t});e.exports=o},function(e,t,r){var n=r(275),i=500;e.exports=function(e){var t=n(e,function(e){return r.size===i&&r.clear(),e}),r=t.cache;return t}},function(e,t,r){var n=r(117),i="Expected a function";function a(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(i);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],a=r.cache;if(a.has(i))return a.get(i);var o=e.apply(this,n);return r.cache=a.set(i,o)||a,o};return r.cache=new(a.Cache||n),r}a.Cache=n,e.exports=a},function(e,t,r){var n=r(277),i=r(89),a=r(118);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(a||i),string:new n}}},function(e,t,r){var n=r(278),i=r(283),a=r(284),o=r(285),s=r(286);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,e.exports=l},function(e,t,r){var n=r(88);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(e,t,r){var n=r(27),i=r(280),a=r(23),o=r(154),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,d=u.hasOwnProperty,f=RegExp("^"+c.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!a(e)||i(e))&&(n(e)?f:s).test(o(e))}},function(e,t,r){var n=r(281),i=function(){var e=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();e.exports=function(e){return!!i&&i in e}},function(e,t,r){var n=r(37)["__core-js_shared__"];e.exports=n},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,r){var n=r(88),i="__lodash_hash_undefined__",a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return r===i?void 0:r}return a.call(t,e)?t[e]:void 0}},function(e,t,r){var n=r(88),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)}},function(e,t,r){var n=r(88),i="__lodash_hash_undefined__";e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?i:t,this}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,r){var n=r(90),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0||(r==t.length-1?t.pop():i.call(t,r,1),--this.size,0))}},function(e,t,r){var n=r(90);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},function(e,t,r){var n=r(90);e.exports=function(e){return n(this.__data__,e)>-1}},function(e,t,r){var n=r(90);e.exports=function(e,t){var r=this.__data__,i=n(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}},function(e,t,r){var n=r(91);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,r){var n=r(91);e.exports=function(e){return n(this,e).get(e)}},function(e,t,r){var n=r(91);e.exports=function(e){return n(this,e).has(e)}},function(e,t,r){var n=r(91);e.exports=function(e,t){var r=n(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}},,function(e,t){var r="Expected a function";e.exports=function(e,t,n){if("function"!=typeof e)throw new TypeError(r);return setTimeout(function(){e.apply(void 0,n)},t)}},function(e,t,r){var n=r(47),i=r(158),a=r(78),o=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:a;e.exports=o},function(e,t,r){var n=r(160),i=1/0,a=1.7976931348623157e308;e.exports=function(e){return e?(e=n(e))===i||e===-i?(e<0?-1:1)*a:e==e?e:0:0===e?e:0}},function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},function(e,t,r){var n=r(57),i=r(49),a="[object Arguments]";e.exports=function(e){return i(e)&&n(e)==a}},function(e,t){e.exports=function(){return!1}},function(e,t,r){var n=r(57),i=r(120),a=r(49),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return a(e)&&i(e.length)&&!!o[n(e)]}},function(e,t,r){(function(e){var n=r(153),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,o=a&&a.exports===i&&n.process,s=function(){try{return o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=s}).call(this,r(92)(e))},function(e,t,r){var n=r(164)(Object.keys,Object);e.exports=n},function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&r.call(e,t)}},function(e,t){e.exports=function(e){return function(t,r,n){for(var i=-1,a=Object(t),o=n(t),s=o.length;s--;){var l=o[e?s:++i];if(!1===r(a[l],l,a))break}return t}}},function(e,t,r){var n=r(95),i=r(37),a=1;e.exports=function(e,t,r){var o=t&a,s=n(e);return function t(){return(this&&this!==i&&this instanceof t?s:e).apply(o?r:this,arguments)}}},function(e,t,r){var n=r(79),i=r(95),a=r(173),o=r(176),s=r(98),l=r(82),u=r(37);e.exports=function(e,t,r){var c=i(e);return function i(){for(var d=arguments.length,f=Array(d),h=d,p=s(i);h--;)f[h]=arguments[h];var v=d<3&&f[0]!==p&&f[d-1]!==p?[]:l(f,p);return(d-=v.length)<r?o(e,t,a,i.placeholder,void 0,f,v,void 0,void 0,r-d):n(this&&this!==u&&this instanceof i?c:e,this,f)}}},function(e,t){e.exports=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}},function(e,t){e.exports={}},function(e,t,r){var n=r(122),i=r(125),a=r(123),o=r(16),s=r(49),l=r(314),u=Object.prototype.hasOwnProperty;function c(e){if(s(e)&&!o(e)&&!(e instanceof n)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return l(e)}return new i(e)}c.prototype=a.prototype,c.prototype.constructor=c,e.exports=c},function(e,t,r){var n=r(122),i=r(125),a=r(97);e.exports=function(e){if(e instanceof n)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=a(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t){var r=/\{\n\/\* \[wrapped with (.+)\] \*/,n=/,? & /;e.exports=function(e){var t=e.match(r);return t?t[1].split(n):[]}},function(e,t){var r=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(r,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,r){var n=r(126),i=r(127),a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return n(a,function(r){var n="_."+r[0];t&r[1]&&!i(e,n)&&e.push(n)}),e.sort()}},function(e,t){e.exports=function(e,t,r,n){for(var i=e.length,a=r+(n?1:-1);n?a--:++a<i;)if(t(e[a],a,e))return a;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},function(e,t,r){var n=r(97),i=r(69),a=Math.min;e.exports=function(e,t){for(var r=e.length,o=a(t.length,r),s=n(e);o--;){var l=t[o];e[o]=i(l,r)?s[l]:void 0}return e}},function(e,t,r){var n=r(79),i=r(95),a=r(37),o=1;e.exports=function(e,t,r,s){var l=t&o,u=i(e);return function t(){for(var i=-1,o=arguments.length,c=-1,d=s.length,f=Array(d+o),h=this&&this!==a&&this instanceof t?u:e;++c<d;)f[c]=s[c];for(;o--;)f[c++]=arguments[++i];return n(h,l?r:this,f)}}},function(e,t,r){var n=r(174),i=r(175),a=r(82),o="__lodash_placeholder__",s=1,l=2,u=4,c=8,d=128,f=256,h=Math.min;e.exports=function(e,t){var r=e[1],p=t[1],v=r|p,g=v<(s|l|d),y=p==d&&r==c||p==d&&r==f&&e[7].length<=t[8]||p==(d|f)&&t[7].length<=t[8]&&r==c;if(!g&&!y)return e;p&s&&(e[2]=t[2],v|=r&s?0:u);var m=t[3];if(m){var b=e[3];e[3]=b?n(b,m,t[4]):m,e[4]=b?a(e[3],o):t[4]}return(m=t[5])&&(b=e[5],e[5]=b?i(b,m,t[6]):m,e[6]=b?a(e[5],o):t[6]),(m=t[7])&&(e[7]=m),p&d&&(e[8]=null==e[8]?t[8]:h(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=v,e}},function(e,t,r){var n=r(58)(r(37),"DataView");e.exports=n},function(e,t,r){var n=r(58)(r(37),"Promise");e.exports=n},function(e,t,r){var n=r(100),i=r(126),a=r(129),o=r(332),s=r(333),l=r(183),u=r(97),c=r(336),d=r(337),f=r(187),h=r(189),p=r(99),v=r(338),g=r(339),y=r(193),m=r(16),b=r(81),_=r(23),E=r(40),k=1,w=2,T=4,S="[object Arguments]",A="[object Function]",R="[object GeneratorFunction]",x="[object Object]",L={};L[S]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object DataView]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L[x]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L["[object Error]"]=L[A]=L["[object WeakMap]"]=!1,e.exports=function e(t,r,O,D,P,I){var C,M=r&k,F=r&w,N=r&T;if(O&&(C=P?O(t,D,P,I):O(t)),void 0!==C)return C;if(!_(t))return t;var U=m(t);if(U){if(C=v(t),!M)return u(t,C)}else{var B=p(t),j=B==A||B==R;if(b(t))return l(t,M);if(B==x||B==S||j&&!P){if(C=F||j?{}:y(t),!M)return F?d(t,s(C,t)):c(t,o(C,t))}else{if(!L[B])return P?t:{};C=g(t,B,e,M)}}I||(I=new n);var G=I.get(t);if(G)return G;I.set(t,C);var H=N?F?h:f:F?keysIn:E,W=U?void 0:H(t);return i(W||t,function(n,i){W&&(n=t[i=n]),a(C,i,e(n,r,O,i,t,I))}),C}},function(e,t,r){var n=r(89);e.exports=function(){this.__data__=new n,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,r){var n=r(89),i=r(118),a=r(117),o=200;e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var s=r.__data__;if(!i||s.length<o-1)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new a(s)}return r.set(e,t),this.size=r.size,this}},function(e,t,r){var n=r(60),i=r(40);e.exports=function(e,t){return e&&n(t,i(t),e)}},function(e,t,r){var n=r(60),i=r(70);e.exports=function(e,t){return e&&n(t,i(t),e)}},function(e,t,r){var n=r(23),i=r(94),a=r(335),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return a(e);var t=i(e),r=[];for(var s in e)("constructor"!=s||!t&&o.call(e,s))&&r.push(s);return r}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},function(e,t,r){var n=r(60),i=r(131);e.exports=function(e,t){return n(e,i(e),t)}},function(e,t,r){var n=r(60),i=r(186);e.exports=function(e,t){return n(e,i(e),t)}},function(e,t){var r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,n=e.constructor(t);return t&&"string"==typeof e[0]&&r.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},function(e,t,r){var n=r(133),i=r(340),a=r(341),o=r(343),s=r(344),l=r(346),u=r(192),c="[object Boolean]",d="[object Date]",f="[object Map]",h="[object Number]",p="[object RegExp]",v="[object Set]",g="[object String]",y="[object Symbol]",m="[object ArrayBuffer]",b="[object DataView]",_="[object Float32Array]",E="[object Float64Array]",k="[object Int8Array]",w="[object Int16Array]",T="[object Int32Array]",S="[object Uint8Array]",A="[object Uint8ClampedArray]",R="[object Uint16Array]",x="[object Uint32Array]";e.exports=function(e,t,r,L){var O=e.constructor;switch(t){case m:return n(e);case c:case d:return new O(+e);case b:return i(e,L);case _:case E:case k:case w:case T:case S:case A:case R:case x:return u(e,L);case f:return a(e,L,r);case h:case g:return new O(e);case p:return o(e);case v:return s(e,L,r);case y:return l(e)}}},function(e,t,r){var n=r(133);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},function(e,t,r){var n=r(342),i=r(191),a=r(134),o=1;e.exports=function(e,t,r){var s=t?r(a(e),o):a(e);return i(s,n,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.set(t[0],t[1]),e}},function(e,t){var r=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,r.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,r){var n=r(345),i=r(191),a=r(101),o=1;e.exports=function(e,t,r){var s=t?r(a(e),o):a(e);return i(s,n,new e.constructor)}},function(e,t){e.exports=function(e,t){return e.add(t),e}},function(e,t,r){var n=r(65),i=n?n.prototype:void 0,a=i?i.valueOf:void 0;e.exports=function(e){return a?Object(a.call(e)):{}}},function(e,t){e.exports=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}},function(e,t,r){(function(n){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==n&&"env"in n&&(e=n.env.DEBUG),e}(t=e.exports=r(349)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var r=this.useColors;if(e[0]=(r?"%c":"")+this.namespace+(r?" %c":" ")+e[0]+(r?"%c ":" ")+"+"+t.humanize(this.diff),!r)return;var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var i=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(a=++i)}),e.splice(a,0,n)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,r(115))},function(e,t,r){var n;function i(e){function r(){if(r.enabled){var e=r,i=+new Date,a=i-(n||i);e.diff=a,e.prev=n,e.curr=i,n=i;for(var o=new Array(arguments.length),s=0;s<o.length;s++)o[s]=arguments[s];o[0]=t.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var l=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var i=t.formatters[n];if("function"==typeof i){var a=o[l];r=i.call(e,a),o.splice(l,1),l--}return r}),t.formatArgs.call(e,o),(r.log||t.log||console.log.bind(console)).apply(e,o)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var r,n=0;for(r in e)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]}(e),"function"==typeof t.init&&t.init(r),r}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length,i=0;i<n;i++)r[i]&&("-"===(e=r[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(350),t.names=[],t.skips=[],t.formatters={}},function(e,t){var r=1e3,n=60*r,i=60*n,a=24*i,o=365.25*a;function s(e,t,r){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+r:Math.ceil(e/t)+" "+r+"s"}e.exports=function(e,t){t=t||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*o;case"days":case"day":case"d":return s*a;case"hours":case"hour":case"hrs":case"hr":case"h":return s*i;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===l&&!1===isNaN(e))return t.long?function(e){return s(e,a,"day")||s(e,i,"hour")||s(e,n,"minute")||s(e,r,"second")||e+" ms"}(e):function(e){if(e>=a)return Math.round(e/a)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=n)return Math.round(e/n)+"m";if(e>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){var n=r(195),i=r(197);e.exports=function(e,t){return n(e,t,function(t,r){return i(e,r)})}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,r){var n=r(65),i=r(80),a=r(16),o=n?n.isConcatSpreadable:void 0;e.exports=function(e){return a(e)||i(e)||!!(o&&e&&e[o])}},function(e,t){var r=Element.prototype,n=r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;e.exports=function(e,t){if(n)return n.call(e,t);for(var r=e.parentNode.querySelectorAll(t),i=0;i<r.length;++i)if(r[i]==e)return!0;return!1}},function(e,t,r){var n=r(199),i=r(183),a=r(192),o=r(97),s=r(193),l=r(80),u=r(16),c=r(137),d=r(81),f=r(27),h=r(23),p=r(45),v=r(93),g=r(356);e.exports=function(e,t,r,y,m,b,_){var E=e[r],k=t[r],w=_.get(k);if(w)n(e,r,w);else{var T=b?b(E,k,r+"",e,t,_):void 0,S=void 0===T;if(S){var A=u(k),R=!A&&d(k),x=!A&&!R&&v(k);T=k,A||R||x?u(E)?T=E:c(E)?T=o(E):R?(S=!1,T=i(k,!0)):x?(S=!1,T=a(k,!0)):T=[]:p(k)||l(k)?(T=E,l(E)?T=g(E):(!h(E)||y&&f(E))&&(T=s(k))):S=!1}S&&(_.set(k,T),m(T,k,y,b,_),_.delete(k)),n(e,r,T)}}},function(e,t,r){var n=r(60),i=r(70);e.exports=function(e){return n(e,i(e))}},function(e,t,r){var n=r(37);e.exports=function(){return n.Date.now()}},function(e,t,r){var n=r(60),i=r(103),a=r(70),o=i(function(e,t,r,i){n(t,a(t),e,i)});e.exports=o},function(e,t,r){var n=r(66),i=Object.prototype,a=i.hasOwnProperty;e.exports=function(e,t,r,o){return void 0===e||n(e,i[r])&&!a.call(o,r)?t:e}},function(e,t,r){var n=r(77);e.exports=function(e,t){return n(t,function(t){return e[t]})}},function(e,t,r){var n=r(136),i=r(23);e.exports=function e(t,r,a,o,s,l){return i(t)&&i(r)&&(l.set(r,t),n(t,r,void 0,e,l),l.delete(r)),t}},function(e,t,r){!function(e){var t=/\S/,r=/\"/g,n=/\n/g,i=/\r/g,a=/\\/g,o=/\u2028/,s=/\u2029/;function l(e){"}"===e.n.substr(e.n.length-1)&&(e.n=e.n.substring(0,e.n.length-1))}function u(e){return e.trim?e.trim():e.replace(/^\s*|\s*$/g,"")}function c(e,t,r){if(t.charAt(r)!=e.charAt(0))return!1;for(var n=1,i=e.length;n<i;n++)if(t.charAt(r+n)!=e.charAt(n))return!1;return!0}e.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},e.scan=function(r,n){var i=r.length,a=0,o=null,s=null,d="",f=[],h=!1,p=0,v=0,g="{{",y="}}";function m(){d.length>0&&(f.push({tag:"_t",text:new String(d)}),d="")}function b(r,n){if(m(),r&&function(){for(var r=!0,n=v;n<f.length;n++)if(!(r=e.tags[f[n].tag]<e.tags._v||"_t"==f[n].tag&&null===f[n].text.match(t)))return!1;return r}())for(var i,a=v;a<f.length;a++)f[a].text&&((i=f[a+1])&&">"==i.tag&&(i.indent=f[a].text.toString()),f.splice(a,1));else n||f.push({tag:"\n"});h=!1,v=f.length}function _(e,t){var r="="+y,n=e.indexOf(r,t),i=u(e.substring(e.indexOf("=",t)+1,n)).split(" ");return g=i[0],y=i[i.length-1],n+r.length-1}for(n&&(n=n.split(" "),g=n[0],y=n[1]),p=0;p<i;p++)0==a?c(g,r,p)?(--p,m(),a=1):"\n"==r.charAt(p)?b(h):d+=r.charAt(p):1==a?(p+=g.length-1,"="==(o=(s=e.tags[r.charAt(p+1)])?r.charAt(p+1):"_v")?(p=_(r,p),a=0):(s&&p++,a=2),h=p):c(y,r,p)?(f.push({tag:o,n:u(d),otag:g,ctag:y,i:"/"==o?h-g.length:p+y.length}),d="",p+=y.length-1,a=0,"{"==o&&("}}"==y?p++:l(f[f.length-1]))):d+=r.charAt(p);return b(h,!0),f};var d={_t:!0,"\n":!0,$:!0,"/":!0};function f(e,t){for(var r=0,n=t.length;r<n;r++)if(t[r].o==e.n)return e.tag="#",!0}function h(e,t,r){for(var n=0,i=r.length;n<i;n++)if(r[n].c==e&&r[n].o==t)return!0}function p(e){var t=[];for(var r in e.partials)t.push('"'+g(r)+'":{name:"'+g(e.partials[r].name)+'", '+p(e.partials[r])+"}");return"partials: {"+t.join(",")+"}, subs: "+function(e){var t=[];for(var r in e)t.push('"'+g(r)+'": function(c,p,t,i) {'+e[r]+"}");return"{ "+t.join(",")+" }"}(e.subs)}e.stringify=function(t,r,n){return"{code: function (c,p,i) { "+e.wrapMain(t.code)+" },"+p(t)+"}"};var v=0;function g(e){return e.replace(a,"\\\\").replace(r,'\\"').replace(n,"\\n").replace(i,"\\r").replace(o,"\\u2028").replace(s,"\\u2029")}function y(e){return~e.indexOf(".")?"d":"f"}function m(e,t){var r="<"+(t.prefix||"")+e.n+v++;return t.partials[r]={name:e.n,partials:{}},t.code+='t.b(t.rp("'+g(r)+'",c,p,"'+(e.indent||"")+'"));',r}function b(e,t){t.code+="t.b(t.t(t."+y(e.n)+'("'+g(e.n)+'",c,p,0)));'}function _(e){return"t.b("+e+");"}e.generate=function(t,r,n){v=0;var i={code:"",subs:{},partials:{}};return e.walk(t,i),n.asString?this.stringify(i,r,n):this.makeTemplate(i,r,n)},e.wrapMain=function(e){return'var t=this;t.b(i=i||"");'+e+"return t.fl();"},e.template=e.Template,e.makeTemplate=function(e,t,r){var n=this.makePartials(e);return n.code=new Function("c","p","i",this.wrapMain(e.code)),new this.template(n,t,this,r)},e.makePartials=function(e){var t,r={subs:{},partials:e.partials,name:e.name};for(t in r.partials)r.partials[t]=this.makePartials(r.partials[t]);for(t in e.subs)r.subs[t]=new Function("c","p","t","i",e.subs[t]);return r},e.codegen={"#":function(t,r){r.code+="if(t.s(t."+y(t.n)+'("'+g(t.n)+'",c,p,1),c,p,0,'+t.i+","+t.end+',"'+t.otag+" "+t.ctag+'")){t.rs(c,p,function(c,p,t){',e.walk(t.nodes,r),r.code+="});c.pop();}"},"^":function(t,r){r.code+="if(!t.s(t."+y(t.n)+'("'+g(t.n)+'",c,p,1),c,p,1,0,0,"")){',e.walk(t.nodes,r),r.code+="};"},">":m,"<":function(t,r){var n={partials:{},code:"",subs:{},inPartial:!0};e.walk(t.nodes,n);var i=r.partials[m(t,r)];i.subs=n.subs,i.partials=n.partials},$:function(t,r){var n={subs:{},code:"",partials:r.partials,prefix:t.n};e.walk(t.nodes,n),r.subs[t.n]=n.code,r.inPartial||(r.code+='t.sub("'+g(t.n)+'",c,p,i);')},"\n":function(e,t){t.code+=_('"\\n"'+(e.last?"":" + i"))},_v:function(e,t){t.code+="t.b(t.v(t."+y(e.n)+'("'+g(e.n)+'",c,p,0)));'},_t:function(e,t){t.code+=_('"'+g(e.text)+'"')},"{":b,"&":b},e.walk=function(t,r){for(var n,i=0,a=t.length;i<a;i++)(n=e.codegen[t[i].tag])&&n(t[i],r);return r},e.parse=function(t,r,n){return function t(r,n,i,a){var o,s=[],l=null,u=null;for(o=i[i.length-1];r.length>0;){if(u=r.shift(),o&&"<"==o.tag&&!(u.tag in d))throw new Error("Illegal content in < super tag.");if(e.tags[u.tag]<=e.tags.$||f(u,a))i.push(u),u.nodes=t(r,u.tag,i,a);else{if("/"==u.tag){if(0===i.length)throw new Error("Closing tag without opener: /"+u.n);if(l=i.pop(),u.n!=l.n&&!h(u.n,l.n,a))throw new Error("Nesting error: "+l.n+" vs. "+u.n);return l.end=u.i,s}"\n"==u.tag&&(u.last=0==r.length||"\n"==r[0].tag)}s.push(u)}if(i.length>0)throw new Error("missing closing tag: "+i.pop().n);return s}(t,0,[],(n=n||{}).sectionTags||[])},e.cache={},e.cacheKey=function(e,t){return[e,!!t.asString,!!t.disableLambda,t.delimiters,!!t.modelGet].join("||")},e.compile=function(t,r){r=r||{};var n=e.cacheKey(t,r),i=this.cache[n];if(i){var a=i.partials;for(var o in a)delete a[o].instance;return i}return i=this.generate(this.parse(this.scan(t,r.delimiters),t,r),t,r),this.cache[n]=i}}(t)},function(e,t,r){!function(e){function t(e,t,r){var n;return t&&"object"==typeof t&&(void 0!==t[e]?n=t[e]:r&&t.get&&"function"==typeof t.get&&(n=t.get(e))),n}e.Template=function(e,t,r,n){e=e||{},this.r=e.code||this.r,this.c=r,this.options=n||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(e,t,r){return""},v:function(e){return e=l(e),s.test(e)?e.replace(r,"&amp;").replace(n,"&lt;").replace(i,"&gt;").replace(a,"&#39;").replace(o,"&quot;"):e},t:l,render:function(e,t,r){return this.ri([e],t||{},r)},ri:function(e,t,r){return this.r(e,t,r)},ep:function(e,t){var r=this.partials[e],n=t[r.name];if(r.instance&&r.base==n)return r.instance;if("string"==typeof n){if(!this.c)throw new Error("No compiler available.");n=this.c.compile(n,this.options)}if(!n)return null;if(this.partials[e].base=n,r.subs){for(key in t.stackText||(t.stackText={}),r.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);n=function(e,t,r,n,i,a){function o(){}function s(){}var l;o.prototype=e,s.prototype=e.subs;var u=new o;for(l in u.subs=new s,u.subsText={},u.buf="",n=n||{},u.stackSubs=n,u.subsText=a,t)n[l]||(n[l]=t[l]);for(l in n)u.subs[l]=n[l];for(l in i=i||{},u.stackPartials=i,r)i[l]||(i[l]=r[l]);for(l in i)u.partials[l]=i[l];return u}(n,r.subs,r.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=n,n},rp:function(e,t,r,n){var i=this.ep(e,r);return i?i.ri(t,r,n):""},rs:function(e,t,r){var n=e[e.length-1];if(u(n))for(var i=0;i<n.length;i++)e.push(n[i]),r(e,t,this),e.pop();else r(e,t,this)},s:function(e,t,r,n,i,a,o){var s;return(!u(e)||0!==e.length)&&("function"==typeof e&&(e=this.ms(e,t,r,n,i,a,o)),s=!!e,!n&&s&&t&&t.push("object"==typeof e?e:t[t.length-1]),s)},d:function(e,r,n,i){var a,o=e.split("."),s=this.f(o[0],r,n,i),l=this.options.modelGet,c=null;if("."===e&&u(r[r.length-2]))s=r[r.length-1];else for(var d=1;d<o.length;d++)void 0!==(a=t(o[d],s,l))?(c=s,s=a):s="";return!(i&&!s)&&(i||"function"!=typeof s||(r.push(c),s=this.mv(s,r,n),r.pop()),s)},f:function(e,r,n,i){for(var a=!1,o=!1,s=this.options.modelGet,l=r.length-1;l>=0;l--)if(void 0!==(a=t(e,r[l],s))){o=!0;break}return o?(i||"function"!=typeof a||(a=this.mv(a,r,n)),a):!i&&""},ls:function(e,t,r,n,i){var a=this.options.delimiters;return this.options.delimiters=i,this.b(this.ct(l(e.call(t,n)),t,r)),this.options.delimiters=a,!1},ct:function(e,t,r){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(e,this.options).render(t,r)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,r,n,i,a,o){var s,l=t[t.length-1],u=e.call(l);return"function"==typeof u?!!n||(s=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(u,l,r,s.substring(i,a),o)):u},mv:function(e,t,r){var n=t[t.length-1],i=e.call(n);return"function"==typeof i?this.ct(l(i.call(n)),n,r):i},sub:function(e,t,r,n){var i=this.subs[e];i&&(this.activeSub=e,i(t,r,this,n),this.activeSub=!1)}};var r=/&/g,n=/</g,i=/>/g,a=/\'/g,o=/\"/g,s=/[&<>\"\']/;function l(e){return String(null===e||void 0===e?"":e)}var u=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}(t)},function(e,t,r){var n=r(365),i=r(371),a=r(203);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?a(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},function(e,t,r){var n=r(100),i=r(138),a=1,o=2;e.exports=function(e,t,r,s){var l=r.length,u=l,c=!s;if(null==e)return!u;for(e=Object(e);l--;){var d=r[l];if(c&&d[2]?d[1]!==e[d[0]]:!(d[0]in e))return!1}for(;++l<u;){var f=(d=r[l])[0],h=e[f],p=d[1];if(c&&d[2]){if(void 0===h&&!(f in e))return!1}else{var v=new n;if(s)var g=s(h,p,f,e,t,v);if(!(void 0===g?i(p,h,a|o,s,v):g))return!1}}return!0}},function(e,t,r){var n=r(100),i=r(201),a=r(369),o=r(370),s=r(99),l=r(16),u=r(81),c=r(93),d=1,f="[object Arguments]",h="[object Array]",p="[object Object]",v=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,g,y,m){var b=l(e),_=l(t),E=b?h:s(e),k=_?h:s(t),w=(E=E==f?p:E)==p,T=(k=k==f?p:k)==p,S=E==k;if(S&&u(e)){if(!u(t))return!1;b=!0,w=!1}if(S&&!w)return m||(m=new n),b||c(e)?i(e,t,r,g,y,m):a(e,t,E,r,g,y,m);if(!(r&d)){var A=w&&v.call(e,"__wrapped__"),R=T&&v.call(t,"__wrapped__");if(A||R){var x=A?e.value():e,L=R?t.value():t;return m||(m=new n),y(x,L,r,g,m)}}return!!S&&(m||(m=new n),o(e,t,r,g,y,m))}},function(e,t){var r="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,r),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,r){var n=r(65),i=r(190),a=r(66),o=r(201),s=r(134),l=r(101),u=1,c=2,d="[object Boolean]",f="[object Date]",h="[object Error]",p="[object Map]",v="[object Number]",g="[object RegExp]",y="[object Set]",m="[object String]",b="[object Symbol]",_="[object ArrayBuffer]",E="[object DataView]",k=n?n.prototype:void 0,w=k?k.valueOf:void 0;e.exports=function(e,t,r,n,k,T,S){switch(r){case E:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _:return!(e.byteLength!=t.byteLength||!T(new i(e),new i(t)));case d:case f:case v:return a(+e,+t);case h:return e.name==t.name&&e.message==t.message;case g:case m:return e==t+"";case p:var A=s;case y:var R=n&u;if(A||(A=l),e.size!=t.size&&!R)return!1;var x=S.get(e);if(x)return x==t;n|=c,S.set(e,t);var L=o(A(e),A(t),n,k,T,S);return S.delete(e),L;case b:if(w)return w.call(e)==w.call(t)}return!1}},function(e,t,r){var n=r(187),i=1,a=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,o,s,l){var u=r&i,c=n(e),d=c.length;if(d!=n(t).length&&!u)return!1;for(var f=d;f--;){var h=c[f];if(!(u?h in t:a.call(t,h)))return!1}var p=l.get(e);if(p&&l.get(t))return p==t;var v=!0;l.set(e,t),l.set(t,e);for(var g=u;++f<d;){var y=e[h=c[f]],m=t[h];if(o)var b=u?o(m,y,h,t,e,l):o(y,m,h,e,t,l);if(!(void 0===b?y===m||s(y,m,r,o,l):b)){v=!1;break}g||(g="constructor"==h)}if(v&&!g){var _=e.constructor,E=t.constructor;_!=E&&"constructor"in e&&"constructor"in t&&!("function"==typeof _&&_ instanceof _&&"function"==typeof E&&E instanceof E)&&(v=!1)}return l.delete(e),l.delete(t),v}},function(e,t,r){var n=r(202),i=r(40);e.exports=function(e){for(var t=i(e),r=t.length;r--;){var a=t[r],o=e[a];t[r]=[a,o,n(o)]}return t}},function(e,t,r){var n=r(138),i=r(4),a=r(197),o=r(116),s=r(202),l=r(203),u=r(67),c=1,d=2;e.exports=function(e,t){return o(e)&&s(t)?l(u(e),t):function(r){var o=i(r,e);return void 0===o&&o===t?a(r,e):n(t,o,c|d)}}},function(e,t,r){var n=r(374),i=r(375),a=r(116),o=r(67);e.exports=function(e){return a(e)?n(o(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,r){var n=r(86);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t,r){var n=r(104);e.exports=function(e,t){var r;return n(e,function(e,n,i){return!(r=t(e,n,i))}),!!r}},function(e,t,r){var n=r(59);e.exports=function(e,t){return function(r,i){if(null==r)return r;if(!n(r))return e(r,i);for(var a=r.length,o=t?a:-1,s=Object(r);(t?o--:++o<a)&&!1!==i(s[o],o,s););return r}}},function(e,t,r){var n=r(379),i=r(69),a=Array.prototype.splice;e.exports=function(e,t){for(var r=e?t.length:0,o=r-1;r--;){var s=t[r];if(r==o||s!==l){var l=s;i(s)?a.call(e,s,1):n(e,s)}}return e}},function(e,t,r){var n=r(76),i=r(141),a=r(380),o=r(67);e.exports=function(e,t){return t=n(t,e),null==(e=a(e,t))||delete e[o(i(t))]}},function(e,t,r){var n=r(86),i=r(194);e.exports=function(e,t){return t.length<2?e:n(e,i(t,0,-1))}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}},function(e,t,r){var n=r(104);e.exports=function(e,t){var r=!0;return n(e,function(e,n,i){return r=!!t(e,n,i)}),r}},function(e,t,r){var n=r(60),i=r(103),a=r(70),o=i(function(e,t){n(t,a(t),e)});e.exports=o},function(e,t,r){var n=r(182),i=r(178),a=r(101),o=n&&1/a(new n([,-0]))[1]==1/0?function(e){return new n(e)}:i;e.exports=o},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(139),i=r(127),a=r(205),o=r(77),s=r(162),l=r(140),u=200;e.exports=function(e,t,r,c){var d=-1,f=i,h=!0,p=e.length,v=[],g=t.length;if(!p)return v;r&&(t=o(t,s(r))),c?(f=a,h=!1):t.length>=u&&(f=l,h=!1,t=new n(t));e:for(;++d<p;){var y=e[d],m=null==r?y:r(y);if(y=c||0!==y?y:0,h&&m==m){for(var b=g;b--;)if(t[b]===m)continue e;v.push(y)}else f(t,m,c)||v.push(y)}return v}},function(e,t,r){var n=r(416),i=r(99),a=r(134),o=r(417),s="[object Map]",l="[object Set]";e.exports=function(e){return function(t){var r=i(t);return r==s?a(t):r==l?o(t):n(t,e(t))}}},function(e,t,r){var n=r(77);e.exports=function(e,t){return n(t,function(t){return[t,e[t]]})}},function(e,t){e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=[e,e]}),r}},,function(e,t){var r=Math.floor,n=Math.random;e.exports=function(e,t){return e+r(n()*(t-e+1))}},function(e,t,r){var n=r(207),i=r(50);e.exports=function(e){return n(i(e))}},,,,,,,,function(e,t,r){var n=r(125),i=r(198),a=r(124),o=r(179),s=r(16),l=r(177),u="Expected a function",c=8,d=32,f=128,h=256;e.exports=function(e){return i(function(t){var r=t.length,i=r,p=n.prototype.thru;for(e&&t.reverse();i--;){var v=t[i];if("function"!=typeof v)throw new TypeError(u);if(p&&!g&&"wrapper"==o(v))var g=new n([],!0)}for(i=g?i:r;++i<r;){v=t[i];var y=o(v),m="wrapper"==y?a(v):void 0;g=m&&l(m[0])&&m[1]==(f|c|d|h)&&!m[4].length&&1==m[9]?g[o(m[0])].apply(g,m[3]):1==v.length&&l(v)?g[y]():g.thru(v)}return function(){var e=arguments,n=e[0];if(g&&1==e.length&&s(n))return g.plant(n).value();for(var i=0,a=r?t[i].apply(this,e):n;++i<r;)a=t[i].call(this,a);return a}})}},,,,,,,,,,,,,,,,,,,,,function(e,t,r){var n=r(104);e.exports=function(e,t){var r=[];return n(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r}},,,,function(e,t,r){"use strict";(function(t){var n=r(454),i=r(455),a=r(456),o=r(212),s=o.isError,l=o.isObject,u=r(457).wrapMethod,c="source protocol user pass host port path".split(" "),d=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;function f(){return+new Date}var h="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},p=h.document,v=h.navigator;function g(e,t){return _(t)?function(r){return t(r,e)}:t}function y(){for(var e in this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!b(p),this._hasNavigator=!b(v),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=h.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=f(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=h.location,this._lastHref=this._location&&this._location.href,this._resetBackoff(),this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}y.prototype={VERSION:"3.17.0",debug:!1,TraceKit:n,config:function(e,t){var r=this;if(r._globalServer)return this._logDebug("error","Error: Raven has already been configured"),r;if(!e)return r;var i=r._globalOptions;t&&w(t,function(e,t){"tags"===e||"extra"===e||"user"===e?r._globalContext[e]=t:i[e]=t}),r.setDSN(e),i.ignoreErrors.push(/^Script error\.?$/),i.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),i.ignoreErrors=x(i.ignoreErrors),i.ignoreUrls=!!i.ignoreUrls.length&&x(i.ignoreUrls),i.whitelistUrls=!!i.whitelistUrls.length&&x(i.whitelistUrls),i.includePaths=x(i.includePaths),i.maxBreadcrumbs=Math.max(0,Math.min(i.maxBreadcrumbs||100,100));var a={xhr:!0,console:!0,dom:!0,location:!0},o=i.autoBreadcrumbs;"[object Object]"==={}.toString.call(o)?o=T(a,o):!1!==o&&(o=a),i.autoBreadcrumbs=o;var s={tryCatch:!0},l=i.instrument;return"[object Object]"==={}.toString.call(l)?l=T(s,l):!1!==l&&(l=s),i.instrument=l,n.collectWindowErrors=!!i.collectWindowErrors,r},install:function(){var e=this;return e.isSetup()&&!e._isRavenInstalled&&(n.report.subscribe(function(){e._handleOnErrorStackInfo.apply(e,arguments)}),e._globalOptions.instrument&&e._globalOptions.instrument.tryCatch&&e._instrumentTryCatch(),e._globalOptions.autoBreadcrumbs&&e._instrumentBreadcrumbs(),e._drainPlugins(),e._isRavenInstalled=!0),Error.stackTraceLimit=e._globalOptions.stackTraceLimit,this},setDSN:function(e){var t=this._parseDSN(e),r=t.path.lastIndexOf("/"),n=t.path.substr(1,r);this._dsn=e,this._globalKey=t.user,this._globalSecret=t.pass&&t.pass.substr(1),this._globalProject=t.path.substr(r+1),this._globalServer=this._getGlobalServer(t),this._globalEndpoint=this._globalServer+"/"+n+"api/"+this._globalProject+"/store/",this._resetBackoff()},context:function(e,t,r){return _(e)&&(r=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,r)},wrap:function(e,t,r){var n=this;if(b(t)&&!_(e))return e;if(_(e)&&(t=e,e=void 0),!_(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(e){return t}function i(){var i=[],a=arguments.length,o=!e||e&&!1!==e.deep;for(r&&_(r)&&r.apply(this,arguments);a--;)i[a]=o?n.wrap(e,arguments[a]):arguments[a];try{return t.apply(this,i)}catch(t){throw n._ignoreNextOnError(),n.captureException(t,e),t}}for(var a in t)R(t,a)&&(i[a]=t[a]);return i.prototype=t.prototype,t.__raven_wrapper__=i,i.__raven__=!0,i.__inner__=t,i},uninstall:function(){return n.report.uninstall(),this._restoreBuiltIns(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},captureException:function(e,t){if(!s(e))return this.captureMessage(e,T({trimHeadFrames:1,stacktrace:!0},t));this._lastCapturedException=e;try{var r=n.computeStackTrace(e);this._handleStackInfo(r,t)}catch(t){if(e!==t)throw t}return this},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){var r=T({message:e+""},t=t||{});if(this._globalOptions.stacktrace||t&&t.stacktrace){var i;try{throw new Error(e)}catch(e){i=e}i.name=null,t=T({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var a=n.computeStackTrace(i),o=this._prepareFrames(a,t);r.stacktrace={frames:o.reverse()}}return this._send(r),this}},captureBreadcrumb:function(e){var t=T({timestamp:f()/1e3},e);if(_(this._globalOptions.breadcrumbCallback)){var r=this._globalOptions.breadcrumbCallback(t);if(l(r)&&!k(r))t=r;else if(!1===r)return this}return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(i(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(e){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=g(t,e),this},setBreadcrumbCallback:function(e){var t=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=g(t,e),this},setShouldSendCallback:function(e){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=g(t,e),this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=h.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(p){var t=(e=e||{}).eventId||this.lastEventId();if(!t)throw new a("Missing eventId");var r=e.dsn||this._dsn;if(!r)throw new a("Missing DSN");var n=encodeURIComponent,i="";i+="?eventId="+n(t),i+="&dsn="+n(r);var o=e.user||this._globalContext.user;o&&(o.name&&(i+="&name="+n(o.name)),o.email&&(i+="&email="+n(o.email)));var s=this._getGlobalServer(this._parseDSN(r)),l=p.createElement("script");l.async=!0,l.src=s+"/api/embed/error-page/"+i,(p.head||p.body).appendChild(l)}},_ignoreNextOnError:function(){var e=this;this._ignoreOnError+=1,setTimeout(function(){e._ignoreOnError-=1})},_triggerEvent:function(e,t){var r,n;if(this._hasDocument){for(n in t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),p.createEvent?(r=p.createEvent("HTMLEvents")).initEvent(e,!0,!0):(r=p.createEventObject()).eventType=e,t)R(t,n)&&(r[n]=t[n]);if(p.createEvent)p.dispatchEvent(r);else try{p.fireEvent("on"+r.eventType.toLowerCase(),r)}catch(e){}}},_breadcrumbEventHandler:function(e){var t=this;return function(r){if(t._keypressTimeout=null,t._lastCapturedEvent!==r){var n;t._lastCapturedEvent=r;try{n=P(r.target)}catch(e){n="<unknown>"}t.captureBreadcrumb({category:"ui."+e,message:n})}}},_keypressEventHandler:function(){var e=this;return function(t){var r;try{r=t.target}catch(e){return}var n=r&&r.tagName;if(n&&("INPUT"===n||"TEXTAREA"===n||r.isContentEditable)){var i=e._keypressTimeout;i||e._breadcrumbEventHandler("input")(t),clearTimeout(i),e._keypressTimeout=setTimeout(function(){e._keypressTimeout=null},1e3)}}},_captureUrlChange:function(e,t){var r=O(this._location.href),n=O(t),i=O(e);this._lastHref=t,r.protocol===n.protocol&&r.host===n.host&&(t=n.relative),r.protocol===i.protocol&&r.host===i.host&&(e=i.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_instrumentTryCatch:function(){var e=this,t=e._wrappedBuiltIns;function r(t){return function(r,n){for(var i=new Array(arguments.length),a=0;a<i.length;++a)i[a]=arguments[a];var o=i[0];return _(o)&&(i[0]=e.wrap(o)),t.apply?t.apply(this,i):t(i[0],i[1])}}var n=this._globalOptions.autoBreadcrumbs;function i(r){var i=h[r]&&h[r].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(F(i,"addEventListener",function(t){return function(i,a,o,s){try{a&&a.handleEvent&&(a.handleEvent=e.wrap(a.handleEvent))}catch(e){}var l,u,c;return n&&n.dom&&("EventTarget"===r||"Node"===r)&&(u=e._breadcrumbEventHandler("click"),c=e._keypressEventHandler(),l=function(e){if(e){var t;try{t=e.type}catch(e){return}return"click"===t?u(e):"keypress"===t?c(e):void 0}}),t.call(this,i,e.wrap(a,void 0,l),o,s)}},t),F(i,"removeEventListener",function(e){return function(t,r,n,i){try{r=r&&(r.__raven_wrapper__?r.__raven_wrapper__:r)}catch(e){}return e.call(this,t,r,n,i)}},t))}F(h,"setTimeout",r,t),F(h,"setInterval",r,t),h.requestAnimationFrame&&F(h,"requestAnimationFrame",function(t){return function(r){return t(e.wrap(r))}},t);for(var a=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],o=0;o<a.length;o++)i(a[o])},_instrumentBreadcrumbs:function(){var e=this,t=this._globalOptions.autoBreadcrumbs,r=e._wrappedBuiltIns;function n(t,r){t in r&&_(r[t])&&F(r,t,function(t){return e.wrap(t)})}if(t.xhr&&"XMLHttpRequest"in h){var i=XMLHttpRequest.prototype;F(i,"open",function(t){return function(r,n){return E(n)&&-1===n.indexOf(e._globalKey)&&(this.__raven_xhr={method:r,url:n,status_code:null}),t.apply(this,arguments)}},r),F(i,"send",function(t){return function(r){var i=this;function a(){if(i.__raven_xhr&&(1===i.readyState||4===i.readyState)){try{i.__raven_xhr.status_code=i.status}catch(e){}e.captureBreadcrumb({type:"http",category:"xhr",data:i.__raven_xhr})}}for(var o=["onload","onerror","onprogress"],s=0;s<o.length;s++)n(o[s],i);return"onreadystatechange"in i&&_(i.onreadystatechange)?F(i,"onreadystatechange",function(t){return e.wrap(t,void 0,a)}):i.onreadystatechange=a,t.apply(this,arguments)}},r)}t.xhr&&"fetch"in h&&F(h,"fetch",function(t){return function(r,n){for(var i=new Array(arguments.length),a=0;a<i.length;++a)i[a]=arguments[a];var o,s=i[0],l="GET";"string"==typeof s?o=s:(o=s.url,s.method&&(l=s.method)),i[1]&&i[1].method&&(l=i[1].method);var u={method:l,url:o,status_code:null};return e.captureBreadcrumb({type:"http",category:"fetch",data:u}),t.apply(this,i).then(function(e){return u.status_code=e.status,e})}},r),t.dom&&this._hasDocument&&(p.addEventListener?(p.addEventListener("click",e._breadcrumbEventHandler("click"),!1),p.addEventListener("keypress",e._keypressEventHandler(),!1)):(p.attachEvent("onclick",e._breadcrumbEventHandler("click")),p.attachEvent("onkeypress",e._keypressEventHandler())));var a=h.chrome,o=!(a&&a.app&&a.app.runtime)&&h.history&&history.pushState;if(t.location&&o){var s=h.onpopstate;h.onpopstate=function(){var t=e._location.href;if(e._captureUrlChange(e._lastHref,t),s)return s.apply(this,arguments)},F(history,"pushState",function(t){return function(){var r=arguments.length>2?arguments[2]:void 0;return r&&e._captureUrlChange(e._lastHref,r+""),t.apply(this,arguments)}},r)}if(t.console&&"console"in h&&console.log){var l=function(t,r){e.captureBreadcrumb({message:t,level:r.level,category:"console"})};w(["debug","info","warn","error","log"],function(e,t){u(console,t,l)})}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){var t=(e=this._wrappedBuiltIns.shift())[0],r=e[1],n=e[2];t[r]=n}},_drainPlugins:function(){var e=this;w(this._plugins,function(t,r){var n=r[0],i=r[1];n.apply(e,[e].concat(i))})},_parseDSN:function(e){var t=d.exec(e),r={},n=7;try{for(;n--;)r[c[n]]=t[n]||""}catch(t){throw new a("Invalid DSN: "+e)}if(r.pass&&!this._globalOptions.allowSecretKey)throw new a("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return r},_getGlobalServer:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(e,t){var r=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,r,t)},_prepareFrames:function(e,t){var r=this,n=[];if(e.stack&&e.stack.length&&(w(e.stack,function(e,t){var i=r._normalizeFrame(t);i&&n.push(i)}),t&&t.trimHeadFrames))for(var i=0;i<t.trimHeadFrames&&i<n.length;i++)n[i].in_app=!1;return n=n.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return t.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t.function)||/raven\.(min\.)?js$/.test(t.filename)),t}},_processException:function(e,t,r,n,i,a){var o;if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t))&&(t+="",i&&i.length?(r=i[0].filename||r,i.reverse(),o={frames:i}):r&&(o={frames:[{filename:r,lineno:n,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(r))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(r)))){var s=T({exception:{values:[{type:e,value:t,stacktrace:o}]},culprit:r},a);this._send(s)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=A(e.message,t)),e.exception){var r=e.exception.values[0];r.value=A(r.value,t)}var n=e.request;return n&&(n.url&&(n.url=A(n.url,this._globalOptions.maxUrlLength)),n.Referer&&(n.Referer=A(n.Referer,this._globalOptions.maxUrlLength))),e.breadcrumbs&&e.breadcrumbs.values&&this._trimBreadcrumbs(e.breadcrumbs),e},_trimBreadcrumbs:function(e){for(var t,r,n,i=["to","from","url"],a=0;a<e.values.length;++a)if((r=e.values[a]).hasOwnProperty("data")&&l(r.data)&&!S(r.data)){n=T({},r.data);for(var o=0;o<i.length;++o)t=i[o],n.hasOwnProperty(t)&&(n[t]=A(n[t],this._globalOptions.maxUrlLength));e.values[a].data=n}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var e={};return this._hasNavigator&&v.userAgent&&(e.headers={"User-Agent":navigator.userAgent}),this._hasDocument&&(p.location&&p.location.href&&(e.url=p.location.href),p.referrer&&(e.headers||(e.headers={}),e.headers.Referer=p.referrer)),e}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&f()-this._backoffStart<this._backoffDuration},_isRepeatData:function(e){var t=this._lastData;return!(!t||e.message!==t.message||e.culprit!==t.culprit)&&(e.stacktrace||t.stacktrace?M(e.stacktrace,t.stacktrace):!e.exception&&!t.exception||function(e,t){return!C(e,t)&&(e=e.values[0],t=t.values[0],e.type===t.type&&e.value===t.value&&M(e.stacktrace,t.stacktrace))}(e.exception,t.exception))},_setBackoffState:function(e){if(!this._shouldBackoff()){var t=e.status;if(400===t||401===t||429===t){var r;try{r=e.getResponseHeader("Retry-After"),r=1e3*parseInt(r,10)}catch(e){}this._backoffDuration=r||(2*this._backoffDuration||1e3),this._backoffStart=f()}}},_send:function(e){var t=this._globalOptions,r={project:this._globalProject,logger:t.logger,platform:"javascript"},n=this._getHttpData();n&&(r.request=n),e.trimHeadFrames&&delete e.trimHeadFrames,(e=T(r,e)).tags=T(T({},this._globalContext.tags),e.tags),e.extra=T(T({},this._globalContext.extra),e.extra),e.extra["session:duration"]=f()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),k(e.tags)&&delete e.tags,this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),_(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!k(e)&&(_(t.shouldSendCallback)&&!t.shouldSendCallback(e)||(this._shouldBackoff()?this._logDebug("warn","Raven dropped error due to backoff: ",e):"number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this._sendProcessedPayload(e):this._sendProcessedPayload(e)))},_getUuid:function(){return D()},_sendProcessedPayload:function(e,t){var r=this,n=this._globalOptions;if(this.isSetup())if(this._lastEventId=e.event_id||(e.event_id=this._getUuid()),e=this._trimPacket(e),this._globalOptions.allowDuplicates||!this._isRepeatData(e)){this._lastData=e,this._logDebug("debug","Raven about to send:",e);var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(i.sentry_secret=this._globalSecret);var a=e.exception&&e.exception.values[0];this.captureBreadcrumb({category:"sentry",message:a?(a.type?a.type+": ":"")+a.value:e.message,event_id:e.event_id,level:e.level||"error"});var o=this._globalEndpoint;(n.transport||this._makeRequest).call(this,{url:o,auth:i,data:e,options:n,onSuccess:function(){r._resetBackoff(),r._triggerEvent("success",{data:e,src:o}),t&&t()},onError:function(n){r._logDebug("error","Raven transport failed to send: ",n),n.request&&r._setBackoffState(n.request),r._triggerEvent("failure",{data:e,src:o}),n=n||new Error("Raven send failed (no additional details provided)"),t&&t(n)}})}else this._logDebug("warn","Raven dropped repeat event: ",e)},_makeRequest:function(e){var t=new XMLHttpRequest;if("withCredentials"in t||"undefined"!=typeof XDomainRequest){var r=e.url;"withCredentials"in t?t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status)e.onSuccess&&e.onSuccess();else if(e.onError){var r=new Error("Sentry error code: "+t.status);r.request=t,e.onError(r)}}:(t=new XDomainRequest,r=r.replace(/^https?:/,""),e.onSuccess&&(t.onload=e.onSuccess),e.onError&&(t.onerror=function(){var r=new Error("Sentry error code: XDomainRequest");r.request=t,e.onError(r)})),t.open("POST",r+"?"+L(e.auth)),t.send(i(e.data))}},_logDebug:function(e){this._originalConsoleMethods[e]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){b(t)?delete this._globalContext[e]:this._globalContext[e]=T(this._globalContext[e]||{},t)}};var m=Object.prototype;function b(e){return void 0===e}function _(e){return"function"==typeof e}function E(e){return"[object String]"===m.toString.call(e)}function k(e){for(var t in e)return!1;return!0}function w(e,t){var r,n;if(b(e.length))for(r in e)R(e,r)&&t.call(null,r,e[r]);else if(n=e.length)for(r=0;r<n;r++)t.call(null,r,e[r])}function T(e,t){return t?(w(t,function(t,r){e[t]=r}),e):e}function S(e){return!!Object.isFrozen&&Object.isFrozen(e)}function A(e,t){return!t||e.length<=t?e:e.substr(0,t)+""}function R(e,t){return m.hasOwnProperty.call(e,t)}function x(e){for(var t,r=[],n=0,i=e.length;n<i;n++)E(t=e[n])?r.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&r.push(t.source);return new RegExp(r.join("|"),"i")}function L(e){var t=[];return w(e,function(e,r){t.push(encodeURIComponent(e)+"="+encodeURIComponent(r))}),t.join("&")}function O(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var r=t[6]||"",n=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+r+n}}function D(){var e=h.crypto||h.msCrypto;if(!b(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var r=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return r(t[0])+r(t[1])+r(t[2])+r(t[3])+r(t[4])+r(t[5])+r(t[6])+r(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function P(e){for(var t,r=[],n=0,i=0,a=" > ".length;e&&n++<5&&!("html"===(t=I(e))||n>1&&i+r.length*a+t.length>=80);)r.push(t),i+=t.length,e=e.parentNode;return r.reverse().join(" > ")}function I(e){var t,r,n,i,a,o=[];if(!e||!e.tagName)return"";if(o.push(e.tagName.toLowerCase()),e.id&&o.push("#"+e.id),(t=e.className)&&E(t))for(r=t.split(/\s+/),a=0;a<r.length;a++)o.push("."+r[a]);var s=["type","name","title","alt"];for(a=0;a<s.length;a++)n=s[a],(i=e.getAttribute(n))&&o.push("["+n+'="'+i+'"]');return o.join("")}function C(e,t){return!!(!!e^!!t)}function M(e,t){if(C(e,t))return!1;var r,n,i=e.frames,a=t.frames;if(i.length!==a.length)return!1;for(var o=0;o<i.length;o++)if(r=i[o],n=a[o],r.filename!==n.filename||r.lineno!==n.lineno||r.colno!==n.colno||r.function!==n.function)return!1;return!0}function F(e,t,r,n){var i=e[t];e[t]=r(i),n&&n.push([e,t,i])}"undefined"!=typeof __DEV__&&__DEV__&&(y.utils={isUndefined:b,isFunction:_,isString:E,isObject:l,isEmptyObject:k,isError:s,each:w,objectMerge:T,truncate:A,hasKey:R,joinRegExp:x,urlencode:L,uuid4:D,htmlTreeAsString:P,htmlElementAsString:I,parseUrl:O,fill:F}),y.prototype.setUser=y.prototype.setUserContext,y.prototype.setReleaseContext=y.prototype.setRelease,e.exports=y}).call(this,r(51))},function(e,t,r){"use strict";(function(t){var n=r(212),i={collectWindowErrors:!0,debug:!1},a="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o=[].slice,s="?",l=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function u(){return"undefined"==typeof document||void 0===document.location?"":document.location.href}i.report=function(){var e,t,r=[],c=null,d=null,f=null;function h(e,t){var n=null;if(!t||i.collectWindowErrors){for(var a in r)if(r.hasOwnProperty(a))try{r[a].apply(null,[e].concat(o.call(arguments,2)))}catch(e){n=e}if(n)throw n}}function p(t,r,a,o,c){if(f)i.computeStackTrace.augmentStackTraceWithInitialElement(f,r,a,t),v();else if(c&&n.isError(c))h(i.computeStackTrace(c),!0);else{var d,p={url:r,line:a,column:o},g=void 0,y=t;if("[object String]"==={}.toString.call(t))(d=t.match(l))&&(g=d[1],y=d[2]);p.func=s,h({name:g,message:y,url:u(),stack:[p]},!0)}return!!e&&e.apply(this,arguments)}function v(){var e=f,t=c;c=null,f=null,d=null,h.apply(null,[e,!1].concat(t))}function g(e,t){var r=o.call(arguments,1);if(f){if(d===e)return;v()}var n=i.computeStackTrace(e);if(f=n,d=e,c=r,setTimeout(function(){d===e&&v()},n.incomplete?2e3:0),!1!==t)throw e}return g.subscribe=function(n){t||(e=a.onerror,a.onerror=p,t=!0),r.push(n)},g.unsubscribe=function(e){for(var t=r.length-1;t>=0;--t)r[t]===e&&r.splice(t,1)},g.uninstall=function(){t&&(a.onerror=e,t=!1,e=void 0),r=[]},g}(),i.computeStackTrace=function(){function e(e){if(void 0!==e.stack&&e.stack){for(var t,r,n,i=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,a=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,c=/\((\S*)(?::(\d+))(?::(\d+))\)/,d=e.stack.split("\n"),f=[],h=(/^(.*) is undefined$/.exec(e.message),0),p=d.length;h<p;++h){if(r=i.exec(d[h])){var v=r[2]&&0===r[2].indexOf("native");r[2]&&0===r[2].indexOf("eval")&&(t=c.exec(r[2]))&&(r[2]=t[1],r[3]=t[2],r[4]=t[3]),n={url:v?null:r[2],func:r[1]||s,args:v?[r[2]]:[],line:r[3]?+r[3]:null,column:r[4]?+r[4]:null}}else if(r=o.exec(d[h]))n={url:r[2],func:r[1]||s,args:[],line:+r[3],column:r[4]?+r[4]:null};else{if(!(r=a.exec(d[h])))continue;r[3]&&r[3].indexOf(" > eval")>-1&&(t=l.exec(r[3]))?(r[3]=t[1],r[4]=t[2],r[5]=null):0!==h||r[5]||void 0===e.columnNumber||(f[0].column=e.columnNumber+1),n={url:r[3],func:r[1]||s,args:r[2]?r[2].split(","):[],line:r[4]?+r[4]:null,column:r[5]?+r[5]:null}}!n.func&&n.line&&(n.func=s),f.push(n)}return f.length?{name:e.name,message:e.message,url:u(),stack:f}:null}}function t(e,t,r,n){var i={url:t,line:r};if(i.url&&i.line){if(e.incomplete=!1,i.func||(i.func=s),e.stack.length>0&&e.stack[0].url===i.url){if(e.stack[0].line===i.line)return!1;if(!e.stack[0].line&&e.stack[0].func===i.func)return e.stack[0].line=i.line,!1}return e.stack.unshift(i),e.partial=!0,!0}return e.incomplete=!0,!1}function r(e,a){for(var o,l,c=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,d=[],f={},h=!1,p=r.caller;p&&!h;p=p.caller)if(p!==n&&p!==i.report){if(l={url:null,func:s,line:null,column:null},p.name?l.func=p.name:(o=c.exec(p.toString()))&&(l.func=o[1]),void 0===l.func)try{l.func=o.input.substring(0,o.input.indexOf("{"))}catch(e){}f[""+p]?h=!0:f[""+p]=!0,d.push(l)}a&&d.splice(0,a);var v={name:e.name,message:e.message,url:u(),stack:d};return t(v,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),v}function n(t,n){var a=null;n=null==n?0:+n;try{if(a=e(t))return a}catch(e){if(i.debug)throw e}try{if(a=r(t,n+1))return a}catch(e){if(i.debug)throw e}return{name:t.name,message:t.message,url:u()}}return n.augmentStackTraceWithInitialElement=t,n.computeStackTraceFromStackProp=e,n}(),e.exports=i}).call(this,r(51))},function(e,t,r){"use strict";function n(e,t){for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}function i(e,t){var r=[],i=[];return null==t&&(t=function(e,t){return r[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n(r,t)).join(".")+"]"}),function(a,o){if(r.length>0){var s=n(r,this);~s?r.splice(s+1):r.push(this),~s?i.splice(s,1/0,a):i.push(a),~n(r,o)&&(o=t.call(this,a,o))}else r.push(o);return null==e?o:e.call(this,a,o)}}(e.exports=function(e,t,r,n){return JSON.stringify(e,i(t,n),r)}).getSerialize=i},function(e,t,r){"use strict";function n(e){this.name="RavenConfigError",this.message=e}n.prototype=new Error,n.prototype.constructor=n,e.exports=n},function(e,t,r){"use strict";e.exports={wrapMethod:function(e,t,r){var n=e[t],i=e;if(t in e){var a="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" ");r&&r(t,{level:a,logger:"console",extra:{arguments:e}}),n&&Function.prototype.apply.call(n,i,e)}}}}},,,,,,,,,,,,,function(e,t,r){var n;e.exports=function e(t,r,i){function a(s,l){if(!r[s]){if(!t[s]){var u="function"==typeof n&&n;if(!l&&u)return n(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=r[s]={exports:{}};t[s][0].call(d.exports,function(e){var r=t[s][1][e];return a(r||e)},d,d.exports,e,t,r,i)}return r[s].exports}for(var o="function"==typeof n&&n,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}t.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(o(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(a(r))for(s=Array.prototype.slice.call(arguments,1),u=r.slice(),n=u.length,l=0;l<n;l++)u[l].apply(this,s);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(r=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],o=r.length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},{}],2:[function(e,t,r){!function(e){var n=/^((?:[^\/;?#]+:)?)(\/\/[^\/\;?#]*)?(.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,i=/^([^\/;?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,s={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");return n.path=s.normalizePath(n.path),s.buildURLFromParts(n)}var a=this.parseURL(t);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):t;var o=this.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=i.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,d=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(d)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(e){var t=n.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(a,"");e.length!==(e=e.replace(o,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}};"object"==typeof r&&"object"==typeof t?t.exports=s:"object"==typeof r?r.URLToolkit=s:e.URLToolkit=s}(this)},{}],3:[function(e,t,r){var n=arguments[3],i=arguments[4],a=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var r,s=Object.keys(a),l=0,u=s.length;l<u;l++){var c=s[l],d=a[c].exports;if(d===e||d&&d.default===e){r=c;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var f={},l=0,u=s.length;l<u;l++){var c=s[l];f[c]=c}i[r]=[Function(["require","module","exports"],"("+e+")(self)"),f]}var h=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[r]=r,i[h]=[Function(["require"],"var f = require("+o(r)+");(f.default ? f.default : f)(self);"),p];var v={};!function e(t){for(var r in v[t]=!0,i[t][1]){var n=i[t][1][r];v[n]||e(n)}}(h);var g="("+n+")({"+Object.keys(v).map(function(e){return o(e)+":["+i[e][0]+","+o(i[e][1])+"]"}).join(",")+"},{},["+o(h)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,m=new Blob([g],{type:"text/javascript"});if(t&&t.bare)return m;var b=y.createObjectURL(m),_=new Worker(b);return _.objectURL=b,_}},{}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hlsDefaultConfig=void 0;var n=e(5),i=h(n),a=e(6),o=h(a),s=e(7),l=h(s),u=e(8),c=h(u),d=e(48),f=h(d);function h(e){return e&&e.__esModule?e:{default:e}}r.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,maxSeekHole:2,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,fragLoadingLoopThreshold:3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:f.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,fetchSetup:void 0,abrController:i.default,bufferController:o.default,capLevelController:l.default,fpsController:c.default,stretchShortVideoTrack:!1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0}},{48:48,5:5,6:6,7:7,8:8}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=p(i),o=e(29),s=p(o),l=e(32),u=p(l),c=e(28),d=e(46),f=e(44),h=p(f);function p(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FRAG_LOADING,a.default.FRAG_LOADED,a.default.FRAG_BUFFERED,a.default.ERROR));return r.lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.clearTimer(),s.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag;if("main"===t.type){if(this.timer||(this.timer=setInterval(this.onCheck,100)),!this._bwEstimator){var r=this.hls,n=e.frag.level,i=r.levels[n].details.live,a=r.config,o=void 0,s=void 0;i?(o=a.abrEwmaFastLive,s=a.abrEwmaSlowLive):(o=a.abrEwmaFastVoD,s=a.abrEwmaSlowVoD),this._bwEstimator=new h.default(r,s,o,a.abrEwmaDefaultEstimate)}this.fragCurrent=t}}},{key:"_abandonRulesCheck",value:function(){var e=this.hls,t=e.media,r=this.fragCurrent,n=r.loader,i=e.minAutoLevel;if(!n||n.stats&&n.stats.aborted)return d.logger.warn("frag loader destroy or aborted, disarm abandonRules"),void this.clearTimer();var o=n.stats;if(t&&o&&(!t.paused&&0!==t.playbackRate||!t.readyState)&&r.autoLevel&&r.level){var s=performance.now()-o.trequest,l=Math.abs(t.playbackRate);if(s>500*r.duration/l){var c=e.levels,f=Math.max(1,o.bw?o.bw/8:1e3*o.loaded/s),h=c[r.level],p=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,v=o.total?o.total:Math.max(o.loaded,Math.round(r.duration*p/8)),g=t.currentTime,y=(v-o.loaded)/f,m=(u.default.bufferInfo(t,g,e.config.maxBufferHole).end-g)/l;if(m<2*r.duration/l&&y>m){var b=void 0,_=void 0;for(_=r.level-1;_>i;_--){var E=c[_].realBitrate?Math.max(c[_].realBitrate,c[_].bitrate):c[_].bitrate;if((b=r.duration*E/(6.4*f))<m)break}b<y&&(d.logger.warn("loading too slow, abort fragment loading and switch to level "+_+":fragLoadedDelay["+_+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+b.toFixed(1)+"<"+y.toFixed(1)+":"+m.toFixed(1)),e.nextLoadLevel=_,this._bwEstimator.sample(s,o.loaded),n.abort(),this.clearTimer(),e.trigger(a.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:o}))}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if("main"===t.type&&!isNaN(t.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[t.level],n=(r.loaded?r.loaded.bytes:0)+e.stats.loaded,i=(r.loaded?r.loaded.duration:0)+e.frag.duration;r.loaded={bytes:n,duration:i},r.realBitrate=Math.round(8*n/i)}if(e.frag.bitrateTest){var a=e.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(e)}}}},{key:"onFragBuffered",value:function(e){var t=e.stats,r=e.frag;if(!(!0===t.aborted||1!==r.loadCounter||"main"!==r.type||isNaN(r.sn)||r.bitrateTest&&t.tload!==t.tbuffered)){var n=t.tparsed-t.trequest;d.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(n,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}}},{key:"onError",value:function(e){switch(e.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}}},{key:"clearTimer",value:function(){clearInterval(this.timer),this.timer=null}},{key:"_findBestLevel",value:function(e,t,r,n,i,a,o,s,l){for(var u=i;u>=n;u--){var c=l[u],f=c.details,h=f?f.totalduration/f.fragments.length:t,p=!!f&&f.live,v=void 0;v=u<=e?o*r:s*r;var g=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,y=g*h/v;if(d.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(v)+"/"+g+"/"+h+"/"+a+"/"+y),v>g&&(!y||p&&!this.bitrateTestDelay||y<a))return u}return-1}},{key:"nextAutoLevel",get:function(){var e=this._nextAutoLevel,t=this._bwEstimator;if(!(-1===e||t&&t.canEstimate()))return e;var r=this._nextABRAutoLevel;return-1!==e&&(r=Math.min(e,r)),r},set:function(e){this._nextAutoLevel=e}},{key:"_nextABRAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.levels,n=e.config,i=e.minAutoLevel,a=e.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,c=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,f=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,h=(u.default.bufferInfo(a,l,n.maxBufferHole).end-l)/c,p=this._findBestLevel(o,s,f,i,t,h,n.abrBandWidthFactor,n.abrBandWidthUpFactor,r);if(p>=0)return p;d.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var v=s?Math.min(s,n.maxStarvationDelay):n.maxStarvationDelay,g=n.abrBandWidthFactor,y=n.abrBandWidthUpFactor;if(0===h){var m=this.bitrateTestDelay;if(m){var b=s?Math.min(s,n.maxLoadingDelay):n.maxLoadingDelay;v=b-m,d.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*v)+" ms"),g=y=1}}return p=this._findBestLevel(o,s,f,i,t,h+v,g,y,r),Math.max(p,0)}}]),t}(s.default);r.default=v},{28:28,29:29,30:30,32:32,44:44,46:46}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=c(i),o=e(29),s=c(o),l=e(46),u=e(28);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING,a.default.MEDIA_DETACHING,a.default.MANIFEST_PARSED,a.default.BUFFER_RESET,a.default.BUFFER_APPENDING,a.default.BUFFER_CODECS,a.default.BUFFER_EOS,a.default.BUFFER_FLUSHING,a.default.LEVEL_PTS_UPDATED,a.default.LEVEL_UPDATED));return r._msDuration=null,r._levelDuration=null,r.onsbue=r.onSBUpdateEnd.bind(r),r.onsbe=r.onSBUpdateError.bind(r),r.pendingTracks={},r.tracks={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"onLevelPtsUpdated",value:function(e){var t=e.type,r=this.tracks.audio;if("audio"===t&&r&&"audio/mpeg"===r.container){var n=this.sourceBuffer.audio,i=Math.abs(n.timestampOffset-e.start);if(i>.1){var a=n.updating;try{n.abort()}catch(e){a=!0,l.logger.warn("can not abort audio buffer: "+e)}a?this.audioTimestampOffset=e.start:(l.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+e.start),n.timestampOffset=e.start)}}}},{key:"onManifestParsed",value:function(e){var t=e.audio,r=e.video||e.levels.length&&e.audio,n=0;e.altAudio&&(t||r)&&(n=(t?1:0)+(r?1:0),l.logger.log(n+" sourceBuffer(s) expected")),this.sourceBufferNb=n}},{key:"onMediaAttaching",value:function(e){var t=this.media=e.media;if(t){var r=this.mediaSource=new MediaSource;this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),r.addEventListener("sourceopen",this.onmso),r.addEventListener("sourceended",this.onmse),r.addEventListener("sourceclose",this.onmsc),t.src=URL.createObjectURL(r)}}},{key:"onMediaDetaching",value:function(){l.logger.log("media source detaching");var e=this.mediaSource;if(e){if("open"===e.readyState)try{e.endOfStream()}catch(e){l.logger.warn("onMediaDetaching:"+e.message+" while calling endOfStream")}e.removeEventListener("sourceopen",this.onmso),e.removeEventListener("sourceended",this.onmse),e.removeEventListener("sourceclose",this.onmsc),this.media&&(URL.revokeObjectURL(this.media.src),this.media.removeAttribute("src"),this.media.load()),this.mediaSource=null,this.media=null,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.onmso=this.onmse=this.onmsc=null,this.hls.trigger(a.default.MEDIA_DETACHED)}},{key:"onMediaSourceOpen",value:function(){l.logger.log("media source opened"),this.hls.trigger(a.default.MEDIA_ATTACHED,{media:this.media});var e=this.mediaSource;e&&e.removeEventListener("sourceopen",this.onmso),this.checkPendingTracks()}},{key:"checkPendingTracks",value:function(){var e=this.pendingTracks,t=Object.keys(e).length;t&&(this.sourceBufferNb<=t||0===this.sourceBufferNb)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())}},{key:"onMediaSourceClose",value:function(){l.logger.log("media source closed")}},{key:"onMediaSourceEnded",value:function(){l.logger.log("media source ended")}},{key:"onSBUpdateEnd",value:function(){if(this.audioTimestampOffset){var e=this.sourceBuffer.audio;l.logger.warn("change mpeg audio timestamp offset from "+e.timestampOffset+" to "+this.audioTimestampOffset),e.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset}this._needsFlush&&this.doFlush(),this._needsEos&&this.checkEos(),this.appending=!1;var t=this.parent,r=this.segments.reduce(function(e,r){return r.parent===t?e+1:e},0);this.hls.trigger(a.default.BUFFER_APPENDED,{parent:t,pending:r}),this._needsFlush||this.doAppending(),this.updateMediaElementDuration()}},{key:"onSBUpdateError",value:function(e){l.logger.error("sourceBuffer error:",e),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferReset",value:function(){var e=this.sourceBuffer;for(var t in e){var r=e[t];try{this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this.onsbue),r.removeEventListener("error",this.onsbe)}catch(e){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}},{key:"onBufferCodecs",value:function(e){if(0===Object.keys(this.sourceBuffer).length){for(var t in e)this.pendingTracks[t]=e[t];var r=this.mediaSource;r&&"open"===r.readyState&&this.checkPendingTracks()}}},{key:"createSourceBuffers",value:function(e){var t=this.sourceBuffer,r=this.mediaSource;for(var n in e)if(!t[n]){var i=e[n],o=i.levelCodec||i.codec,s=i.container+";codecs="+o;l.logger.log("creating sourceBuffer("+s+")");try{var c=t[n]=r.addSourceBuffer(s);c.addEventListener("updateend",this.onsbue),c.addEventListener("error",this.onsbe),this.tracks[n]={codec:o,container:i.container},i.buffer=c}catch(e){l.logger.error("error while trying to add sourceBuffer:"+e.message),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:e,mimeType:s})}}this.hls.trigger(a.default.BUFFER_CREATED,{tracks:e})}},{key:"onBufferAppending",value:function(e){this._needsFlush||(this.segments?this.segments.push(e):this.segments=[e],this.doAppending())}},{key:"onBufferAppendFail",value:function(e){l.logger.error("sourceBuffer error:",e.event),this.hls.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})}},{key:"onBufferEos",value:function(e){var t=this.sourceBuffer,r=e.type;for(var n in t)r&&n!==r||t[n].ended||(t[n].ended=!0,l.logger.log(n+" sourceBuffer now EOS"));this.checkEos()}},{key:"checkEos",value:function(){var e=this.sourceBuffer,t=this.mediaSource;if(t&&"open"===t.readyState){for(var r in e){var n=e[r];if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}l.logger.log("all media data available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(e){l.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1}},{key:"onBufferFlushing",value:function(e){this.flushRange.push({start:e.startOffset,end:e.endOffset,type:e.type}),this.flushBufferCounter=0,this.doFlush()}},{key:"onLevelUpdated",value:function(e){var t=e.details;0!==t.fragments.length&&(this._levelDuration=t.totalduration+t.fragments[0].start,this.updateMediaElementDuration())}},{key:"updateMediaElementDuration",value:function(){var e=this.media,t=this.mediaSource,r=this.sourceBuffer,n=this._levelDuration;if(null!==n&&e&&t&&r&&0!==e.readyState&&"open"===t.readyState){for(var i in r)if(r[i].updating)return;null===this._msDuration&&(this._msDuration=t.duration);var a=e.duration;(n>this._msDuration&&n>a||a===1/0||isNaN(a))&&(l.logger.log("Updating mediasource duration to "+n.toFixed(3)),this._msDuration=t.duration=n)}}},{key:"doFlush",value:function(){for(;this.flushRange.length;){var e=this.flushRange[0];if(!this.flushBuffer(e.start,e.end,e.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var t=0,r=this.sourceBuffer;try{for(var n in r)t+=r[n].buffered.length}catch(e){l.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t,this.hls.trigger(a.default.BUFFER_FLUSHED)}}},{key:"doAppending",value:function(){var e=this.hls,t=this.sourceBuffer,r=this.segments;if(Object.keys(t).length){if(this.media.error)return this.segments=[],void l.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(r&&r.length){var n=r.shift();try{var i=n.type,o=t[i];o?o.updating?r.unshift(n):(o.ended=!1,this.parent=n.parent,o.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(t){l.logger.error("error while trying to append buffer:"+t.message),r.unshift(n);var s={type:u.ErrorTypes.MEDIA_ERROR,parent:n.parent};if(22===t.code)return this.segments=[],s.details=u.ErrorDetails.BUFFER_FULL_ERROR,s.fatal=!1,void e.trigger(a.default.ERROR,s);if(this.appendError?this.appendError++:this.appendError=1,s.details=u.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>e.config.appendErrorMaxRetry)return l.logger.log("fail "+e.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),r=[],s.fatal=!0,void e.trigger(a.default.ERROR,s);s.fatal=!1,e.trigger(a.default.ERROR,s)}}}}},{key:"flushBuffer",value:function(e,t,r){var n,i,a,o,s,u,c=this.sourceBuffer;if(Object.keys(c).length){if(l.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+e+"/"+t),this.flushBufferCounter<this.appended){for(var d in c)if(!r||d===r){if((n=c[d]).ended=!1,n.updating)return l.logger.warn("cannot flush, sb updating in progress"),!1;try{for(i=0;i<n.buffered.length;i++)if(a=n.buffered.start(i),o=n.buffered.end(i),-1!==navigator.userAgent.toLowerCase().indexOf("firefox")&&t===Number.POSITIVE_INFINITY?(s=e,u=t):(s=Math.max(a,e),u=Math.min(o,t)),Math.min(u,o)-s>.5)return this.flushBufferCounter++,l.logger.log("flush "+d+" ["+s+","+u+"], of ["+a+","+o+"], pos:"+this.media.currentTime),n.remove(s,u),!1}catch(e){l.logger.warn("exception while accessing sourcebuffer, it might have been removed from MediaSource")}}}else l.logger.warn("abort flushing too many retries");l.logger.log("buffer flushed")}return!0}}]),t}(s.default);r.default=d},{28:28,29:29,30:30,46:46}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=l(i),o=e(29),s=l(o);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FPS_DROP_LEVEL_CAPPING,a.default.MEDIA_ATTACHING,a.default.MANIFEST_PARSED))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.hls.config.capLevelToPlayerSize&&(this.media=this.restrictedLevels=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer)))}},{key:"onFpsDropLevelCapping",value:function(e){t.isLevelAllowed(e.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(e.droppedLevel)}},{key:"onMediaAttaching",value:function(e){this.media=e.media instanceof HTMLVideoElement?e.media:null}},{key:"onManifestParsed",value:function(e){var t=this.hls;this.restrictedLevels=[],t.config.capLevelToPlayerSize&&(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.levels=e.levels,t.firstLevel=this.getMaxLevel(e.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"detectPlayerSize",value:function(){if(this.media){var e=this.levels?this.levels.length:0;if(e){var t=this.hls;t.autoLevelCapping=this.getMaxLevel(e-1),t.autoLevelCapping>this.autoLevelCapping&&t.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(e){var r=this;if(!this.levels)return-1;var n=this.levels.filter(function(n,i){return t.isLevelAllowed(i,r.restrictedLevels)&&i<=e});return t.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}},{key:"mediaWidth",get:function(){var e=void 0,r=this.media;return r&&(e=r.width||r.clientWidth||r.offsetWidth,e*=t.contentScaleFactor),e}},{key:"mediaHeight",get:function(){var e=void 0,r=this.media;return r&&(e=r.height||r.clientHeight||r.offsetHeight,e*=t.contentScaleFactor),e}}],[{key:"isLevelAllowed",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return-1===t.indexOf(e)}},{key:"getMaxLevelByMediaSize",value:function(e,t,r){if(!e||e&&!e.length)return-1;for(var n=function(e,t){return!t||e.width!==t.width||e.height!==t.height},i=e.length-1,a=0;a<e.length;a+=1){var o=e[a];if((o.width>=t||o.height>=r)&&n(o,e[a+1])){i=a;break}}return i}},{key:"contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){}return e}}]),t}(s.default);r.default=u},{29:29,30:30}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=u(i),o=e(29),s=u(o),l=e(46);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHING))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1}},{key:"onMediaAttaching",value:function(e){var t=this.hls.config;if(t.capLevelOnFPSDrop){var r=this.video=e.media instanceof HTMLVideoElement?e.media:null;"function"==typeof r.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod)}}},{key:"checkFPS",value:function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var i=n-this.lastTime,o=r-this.lastDroppedFrames,s=t-this.lastDecodedFrames,u=1e3*o/i,c=this.hls;if(c.trigger(a.default.FPS_DROP,{currentDropped:o,currentDecoded:s,totalDroppedFrames:r}),u>0&&o>c.config.fpsDroppedMonitoringThreshold*s){var d=c.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+d),d>0&&(-1===c.autoLevelCapping||c.autoLevelCapping>=d)&&(d-=1,c.trigger(a.default.FPS_DROP_LEVEL_CAPPING,{level:d,droppedLevel:c.currentLevel}),c.autoLevelCapping=d,c.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.video;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),t}(s.default);r.default=c},{29:29,30:30,46:46}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=c(i),o=e(29),s=c(o),l=e(22),u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MEDIA_ATTACHED,a.default.MEDIA_DETACHING,a.default.FRAG_PARSING_METADATA));return r.id3Track=void 0,r.media=void 0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){s.default.prototype.destroy.call(this)}},{key:"onMediaAttached",value:function(e){this.media=e.media,this.media&&(this.id3Track=this.media.addTextTrack("metadata","id3"),this.id3Track.mode="hidden")}},{key:"onMediaDetaching",value:function(){this.media=void 0}},{key:"onFragParsingMetadata",value:function(e){for(var t=e.frag,r=e.samples,n=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,i=0;i<r.length;i++){var a=u.default.getID3Frames(r[i].data);if(a){var o=r[i].pts,s=i<r.length-1?r[i+1].pts:t.endPTS;o===s&&(s+=1e-4);for(var l=0;l<a.length;l++){var c=a[l];if(!u.default.isTimeStampFrame(c)){var d=new n(o,s,"");d.value=c,this.id3Track.addCue(d)}}}}}}]),t}(s.default);r.default=d},{22:22,29:29,30:30}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=f(i),o=e(29),s=f(o),l=e(46),u=e(28),c=e(32),d=f(c);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.MANIFEST_LOADED,a.default.LEVEL_LOADED,a.default.FRAG_LOADED,a.default.ERROR));return r.ontick=r.tick.bind(r),r._manualLevel=-1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.cleanTimer(),this._manualLevel=-1}},{key:"cleanTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"startLoad",value:function(){this.canload=!0;var e=this._levels;e&&e.forEach(function(e){e.loadError=0;var t=e.details;t&&t.live&&(e.details=void 0)}),this.timer&&this.tick()}},{key:"stopLoad",value:function(){this.canload=!1}},{key:"onManifestLoaded",value:function(e){var t,r=[],n=[],i={},o=!1,s=!1,c=this.hls,d=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),f=function(e,t){return MediaSource.isTypeSupported(e+"/mp4;codecs="+t)};if(e.levels.forEach(function(e){e.videoCodec&&(o=!0),d&&e.audioCodec&&-1!==e.audioCodec.indexOf("mp4a.40.34")&&(e.audioCodec=void 0),(e.audioCodec||e.attrs&&e.attrs.AUDIO)&&(s=!0);var t=i[e.bitrate];void 0===t?(i[e.bitrate]=r.length,e.url=[e.url],e.urlId=0,r.push(e)):r[t].url.push(e.url)}),o&&s?r.forEach(function(e){e.videoCodec&&n.push(e)}):n=r,(n=n.filter(function(e){var t=e.audioCodec,r=e.videoCodec;return(!t||f("audio",t))&&(!r||f("video",r))})).length){t=n[0].bitrate,n.sort(function(e,t){return e.bitrate-t.bitrate}),this._levels=n;for(var h=0;h<n.length;h++)if(n[h].bitrate===t){this._firstLevel=h,l.logger.log("manifest loaded,"+n.length+" level(s) found, first bitrate:"+t);break}c.trigger(a.default.MANIFEST_PARSED,{levels:n,firstLevel:this._firstLevel,stats:e.stats,audio:s,video:o,altAudio:e.audioTracks.length>0})}else c.trigger(a.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:c.url,reason:"no level with compatible codecs found in manifest"})}},{key:"setLevelInternal",value:function(e){var t=this._levels,r=this.hls;if(e>=0&&e<t.length){if(this.cleanTimer(),this._level!==e){l.logger.log("switching to level "+e),this._level=e;var n=t[e];n.level=e,r.trigger(a.default.LEVEL_SWITCH,n),r.trigger(a.default.LEVEL_SWITCHING,n)}var i=t[e],o=i.details;if(!o||!0===o.live){var s=i.urlId;r.trigger(a.default.LEVEL_LOADING,{url:i.url[s],level:e,id:s})}}else r.trigger(a.default.ERROR,{type:u.ErrorTypes.OTHER_ERROR,details:u.ErrorDetails.LEVEL_SWITCH_ERROR,level:e,fatal:!1,reason:"invalid level idx"})}},{key:"onError",value:function(e){if(e.fatal)e.type===u.ErrorTypes.NETWORK_ERROR&&this.cleanTimer();else{var t=e.details,r=this.hls,n=void 0,i=void 0,a=!1;switch(t){case u.ErrorDetails.FRAG_LOAD_ERROR:case u.ErrorDetails.FRAG_LOAD_TIMEOUT:case u.ErrorDetails.FRAG_LOOP_LOADING_ERROR:case u.ErrorDetails.KEY_LOAD_ERROR:case u.ErrorDetails.KEY_LOAD_TIMEOUT:n=e.frag.level;break;case u.ErrorDetails.LEVEL_LOAD_ERROR:case u.ErrorDetails.LEVEL_LOAD_TIMEOUT:n=e.context.level,a=!0;break;case u.ErrorDetails.REMUX_ALLOC_ERROR:n=e.level}if(void 0!==n){(i=this._levels[n]).loadError?i.loadError++:i.loadError=1;var o=i.url.length;if(o>1&&i.loadError<o)i.urlId=(i.urlId+1)%o,i.details=void 0,l.logger.warn("level controller,"+t+" for level "+n+": switching to redundant stream id "+i.urlId);else{var s=-1===this._manualLevel&&n;if(s)l.logger.warn("level controller,"+t+": switch-down for next fragment"),r.nextAutoLevel=Math.max(0,n-1);else if(i&&i.details&&i.details.live)l.logger.warn("level controller,"+t+" on live stream, discard"),a&&(this._level=void 0);else if(t===u.ErrorDetails.LEVEL_LOAD_ERROR||t===u.ErrorDetails.LEVEL_LOAD_TIMEOUT){var c=r.media,f=c&&d.default.isBuffered(c,c.currentTime)&&d.default.isBuffered(c,c.currentTime+.5);if(f){var h=r.config.levelLoadingRetryDelay;l.logger.warn("level controller,"+t+", but media buffered, retry in "+h+"ms"),this.timer=setTimeout(this.ontick,h),e.levelRetry=!0}else l.logger.error("cannot recover "+t+" error"),this._level=void 0,this.cleanTimer(),e.fatal=!0}}}}}},{key:"onFragLoaded",value:function(e){var t=e.frag;if(t&&"main"===t.type){var r=this._levels[t.level];r&&(r.loadError=0)}}},{key:"onLevelLoaded",value:function(e){var t=e.level;if(t===this._level){var r=this._levels[t];r.loadError=0;var n=e.details;if(n.live){var i=1e3*(n.averagetargetduration?n.averagetargetduration:n.targetduration),a=r.details;a&&n.endSN===a.endSN&&(i/=2,l.logger.log("same live playlist, reload twice faster")),i-=performance.now()-e.stats.trequest,i=Math.max(1e3,Math.round(i)),l.logger.log("live playlist, reload in "+i+" ms"),this.timer=setTimeout(this.ontick,i)}else this.timer=null}}},{key:"tick",value:function(){var e=this._level;if(void 0!==e&&this.canload){var t=this._levels[e];if(t&&t.url){var r=t.urlId;this.hls.trigger(a.default.LEVEL_LOADING,{url:t.url[r],level:e,id:r})}}}},{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this._level},set:function(e){var t=this._levels;t&&t.length>e&&(this._level===e&&void 0!==t[e].details||this.setLevelInternal(e))}},{key:"manualLevel",get:function(){return this._manualLevel},set:function(e){this._manualLevel=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"nextLoadLevel",get:function(){return-1!==this._manualLevel?this._manualLevel:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this._manualLevel&&(this.hls.nextAutoLevel=e)}}]),t}(s.default);r.default=h},{28:28,29:29,30:30,32:32,46:46}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(43),a=_(i),o=e(32),s=_(o),l=e(20),u=_(l),c=e(30),d=_(c),f=e(29),h=_(f),p=e(33),v=_(p),g=e(47),y=_(g),m=e(28),b=e(46);function _(e){return e&&e.__esModule?e:{default:e}}var E={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_LEVEL:"WAITING_LEVEL",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR"},k=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,d.default.MEDIA_ATTACHED,d.default.MEDIA_DETACHING,d.default.MANIFEST_LOADING,d.default.MANIFEST_PARSED,d.default.LEVEL_LOADED,d.default.KEY_LOADED,d.default.FRAG_LOADED,d.default.FRAG_LOAD_EMERGENCY_ABORTED,d.default.FRAG_PARSING_INIT_SEGMENT,d.default.FRAG_PARSING_DATA,d.default.FRAG_PARSED,d.default.ERROR,d.default.AUDIO_TRACK_SWITCHING,d.default.AUDIO_TRACK_SWITCHED,d.default.BUFFER_CREATED,d.default.BUFFER_APPENDED,d.default.BUFFER_FLUSHED));return r.config=e.config,r.audioCodecSwap=!1,r.ticks=0,r._state=E.STOPPED,r.ontick=r.tick.bind(r),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){this.stopLoad(),this.timer&&(clearInterval(this.timer),this.timer=null),h.default.prototype.destroy.call(this),this.state=E.STOPPED}},{key:"startLoad",value:function(e){if(this.levels){var t=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.timer||(this.timer=setInterval(this.ontick,100)),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var n=r.startLevel;-1===n&&(n=0,this.bitrateTest=!0),this.level=r.nextLoadLevel=n,this.loadedmetadata=!1}t>0&&-1===e&&(b.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),e=t),this.state=E.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this.forceStartLoad=!0,this.state=E.STOPPED}},{key:"stopLoad",value:function(){var e=this.fragCurrent;e&&(e.loader&&e.loader.abort(),this.fragCurrent=null),this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=E.STOPPED,this.forceStartLoad=!1}},{key:"tick",value:function(){this.ticks++,1===this.ticks&&(this.doTick(),this.ticks>1&&setTimeout(this.tick,1),this.ticks=0)}},{key:"doTick",value:function(){switch(this.state){case E.ERROR:break;case E.BUFFER_FLUSHING:this.fragLoadError=0;break;case E.IDLE:this._doTickIdle();break;case E.WAITING_LEVEL:var e=this.levels[this.level];e&&e.details&&(this.state=E.IDLE);break;case E.FRAG_LOADING_WAITING_RETRY:var t=performance.now(),r=this.retryDate;(!r||t>=r||this.media&&this.media.seeking)&&(b.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=E.IDLE);break;case E.ERROR:case E.STOPPED:case E.FRAG_LOADING:case E.PARSING:case E.PARSED:case E.ENDED:}this._checkBuffer(),this._checkFragmentChanged()}},{key:"_doTickIdle",value:function(){var e=this.hls,t=e.config,r=this.media;if(void 0===this.levelLastLoaded||r||!this.startFragRequested&&t.startFragPrefetch){var n=void 0;n=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var i=e.nextLoadLevel,a=this.levels[i];if(a){var o=a.bitrate,l=void 0;l=o?Math.max(8*t.maxBufferSize/o,t.maxBufferLength):t.maxBufferLength,l=Math.min(l,t.maxMaxBufferLength);var u=s.default.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,n,t.maxBufferHole),c=u.len;if(!(c>=l)){b.logger.trace("buffer length of "+c.toFixed(3)+" is below max of "+l.toFixed(3)+". checking for more payload ..."),this.level=e.nextLoadLevel=i;var f=a.details;if(void 0===f||f.live&&this.levelLastLoaded!==i)this.state=E.WAITING_LEVEL;else{var h=this.fragPrevious;if(!f.live&&h&&h.sn===f.endSN&&c&&!u.nextStart){var p=Math.min(r.duration,h.start+h.duration);if(p-Math.max(u.end,h.start)<=Math.max(.2,h.duration)){var v={};return this.altAudio&&(v.type="video"),this.hls.trigger(d.default.BUFFER_EOS,v),void(this.state=E.ENDED)}}this._fetchPayloadOrEos(n,u,f)}}}}}},{key:"_fetchPayloadOrEos",value:function(e,t,r){var n=this.fragPrevious,i=this.level,a=r.fragments,o=a.length;if(0!==o){var s=a[0].start,l=a[o-1].start+a[o-1].duration,u=t.end,c=void 0;if(r.initSegment&&!r.initSegment.data)c=r.initSegment;else if(r.live){var d=this.config.initialLiveManifestSize;if(o<d)return void b.logger.warn("Can not start playback of a level, reason: not enough fragments "+o+" < "+d);if(null===(c=this._ensureFragmentAtLivePoint(r,u,s,l,n,a,o)))return}else u<s&&(c=a[0]);c||(c=this._findFragment(s,n,o,a,u,l,r)),c&&this._loadFragmentOrKey(c,i,r,e,u)}}},{key:"_ensureFragmentAtLivePoint",value:function(e,t,r,n,i,o,s){var l=this.hls.config,u=this.media,c=void 0,d=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*e.targetduration;if(t<Math.max(r-l.maxFragLookUpTolerance,n-d)){var f=this.liveSyncPosition=this.computeLivePosition(r,e);b.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+f.toFixed(3)),t=f,u&&u.readyState&&u.duration>f&&(u.currentTime=f),this.nextLoadPosition=f}if(e.PTSKnown&&t>n&&u&&u.readyState)return null;if(this.startFragRequested&&!e.PTSKnown){if(i){var h=i.sn+1;if(h>=e.startSN&&h<=e.endSN){var p=o[h-e.startSN];i.cc===p.cc&&(c=p,b.logger.log("live playlist, switching playlist, load frag with next SN: "+c.sn))}c||(c=a.default.search(o,function(e){return i.cc-e.cc}))&&b.logger.log("live playlist, switching playlist, load frag with same CC: "+c.sn)}c||(c=o[Math.min(s-1,Math.round(s/2))],b.logger.log("live playlist, switching playlist, unknown, load middle frag : "+c.sn))}return c}},{key:"_findFragment",value:function(e,t,r,n,i,o,s){var l=this.hls.config,u=void 0,c=void 0,d=l.maxFragLookUpTolerance,f=t?n[t.sn-n[0].sn+1]:void 0,h=function(e){var t=Math.min(d,e.duration);return e.start+e.duration-t<=i?1:e.start-t>i&&e.start?-1:0};if(i<o?(i>o-d&&(d=0),c=f&&!h(f)?f:a.default.search(n,h)):c=n[r-1],c){var p=(u=c).sn-s.startSN,v=t&&u.level===t.level,g=n[p-1],y=n[p+1];if(t&&u.sn===t.sn)if(v&&!u.backtracked)if(u.sn<s.endSN){var m=t.deltaPTS;m&&m>l.maxBufferHole&&t.dropped&&p?(u=g,b.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this"),t.loadCounter--):(u=y,b.logger.log("SN just loaded, load next one: "+u.sn))}else u=null;else u.backtracked&&(y&&y.backtracked?(b.logger.warn("Already backtracked from fragment "+y.sn+", will not backtrack to fragment "+u.sn+". Loading fragment "+y.sn),u=y):(b.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),u.dropped=0,g?(g.loadCounter&&g.loadCounter--,(u=g).backtracked=!0):p&&(u=null)))}return u}},{key:"_loadFragmentOrKey",value:function(e,t,r,n,i){var a=this.hls,o=a.config;if(!e.decryptdata||null==e.decryptdata.uri||null!=e.decryptdata.key){if(b.logger.log("Loading "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t+", currentTime:"+n.toFixed(3)+",bufferEnd:"+i.toFixed(3)),void 0!==this.fragLoadIdx?this.fragLoadIdx++:this.fragLoadIdx=0,e.loadCounter){e.loadCounter++;var s=o.fragLoadingLoopThreshold;if(e.loadCounter>s&&Math.abs(this.fragLoadIdx-e.loadIdx)<s)return void a.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.FRAG_LOOP_LOADING_ERROR,fatal:!1,frag:e})}else e.loadCounter=1;return e.loadIdx=this.fragLoadIdx,this.fragCurrent=e,this.startFragRequested=!0,isNaN(e.sn)||(this.nextLoadPosition=e.start+e.duration),e.autoLevel=a.autoLevelEnabled,e.bitrateTest=this.bitrateTest,a.trigger(d.default.FRAG_LOADING,{frag:e}),this.demuxer||(this.demuxer=new u.default(a,"main")),void(this.state=E.FRAG_LOADING)}b.logger.log("Loading key for "+e.sn+" of ["+r.startSN+" ,"+r.endSN+"],level "+t),this.state=E.KEY_LOADING,a.trigger(d.default.KEY_LOADING,{frag:e})}},{key:"getBufferedFrag",value:function(e){return a.default.search(this._bufferedFrags,function(t){return e<t.startPTS?-1:e>t.endPTS?1:0})}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.endPTS+.5):null}},{key:"_checkFragmentChanged",value:function(){var e,t,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((t=r.currentTime)>r.playbackRate*this.lastCurrentTime&&(this.lastCurrentTime=t),s.default.isBuffered(r,t)?e=this.getBufferedFrag(t):s.default.isBuffered(r,t+.1)&&(e=this.getBufferedFrag(t+.1)),e)){var n=e;if(n!==this.fragPlaying){this.hls.trigger(d.default.FRAG_CHANGED,{frag:n});var i=n.level;this.fragPlaying&&this.fragPlaying.level===i||this.hls.trigger(d.default.LEVEL_SWITCHED,{level:i}),this.fragPlaying=n}}}},{key:"immediateLevelSwitch",value:function(){if(b.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var e=this.media,t=void 0;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"immediateLevelSwitchEnd",value:function(){var e=this.media;e&&e.buffered.length&&(this.immediateSwitch=!1,s.default.isBuffered(e,e.currentTime)&&(e.currentTime-=1e-4),this.previouslyPaused||e.play())}},{key:"nextLevelSwitch",value:function(){var e=this.media;if(e&&e.readyState){var t=void 0,r=void 0,n=void 0;if(this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,(r=this.getBufferedFrag(e.currentTime))&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),e.paused)t=0;else{var i=this.hls.nextLoadLevel,a=this.levels[i],o=this.fragLastKbps;t=o&&this.fragCurrent?this.fragCurrent.duration*a.bitrate/(1e3*o)+1:0}if((n=this.getBufferedFrag(e.currentTime+t))&&(n=this.followingBufferedFrag(n))){var s=this.fragCurrent;s&&s.loader&&s.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(n.maxStartPTS,Number.POSITIVE_INFINITY)}}}},{key:"flushMainBuffer",value:function(e,t){this.state=E.BUFFER_FLUSHING;var r={startOffset:e,endOffset:t};this.altAudio&&(r.type="video"),this.hls.trigger(d.default.BUFFER_FLUSHING,r)}},{key:"onMediaAttached",value:function(e){var t=this.media=this.mediaBuffer=e.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),t.addEventListener("seeking",this.onvseeking),t.addEventListener("seeked",this.onvseeked),t.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition)}},{key:"onMediaDetaching",value:function(){var e=this.media;e&&e.ended&&(b.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var t=this.levels;t&&t.forEach(function(e){e.details&&e.details.fragments.forEach(function(e){e.loadCounter=void 0,e.backtracked=void 0})}),e&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("seeked",this.onvseeked),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()}},{key:"onMediaSeeking",value:function(){var e=this.media,t=e?e.currentTime:void 0,r=this.config;isNaN(t)||b.logger.log("media seeking to "+t.toFixed(3));var n=this.mediaBuffer?this.mediaBuffer:e,i=s.default.bufferInfo(n,t,this.config.maxBufferHole);if(this.state===E.FRAG_LOADING){var a=this.fragCurrent;if(0===i.len&&a){var o=r.maxFragLookUpTolerance,l=a.start-o,u=a.start+a.duration+o;t<l||t>u?(a.loader&&(b.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),a.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=E.IDLE):b.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else this.state===E.ENDED&&(0===i.len&&(this.fragPrevious=0),this.state=E.IDLE);e&&(this.lastCurrentTime=t),this.state!==E.FRAG_LOADING&&void 0!==this.fragLoadIdx&&(this.fragLoadIdx+=2*r.fragLoadingLoopThreshold),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t),this.tick()}},{key:"onMediaSeeked",value:function(){var e=this.media,t=e?e.currentTime:void 0;isNaN(t)||b.logger.log("media seeked to "+t.toFixed(3)),this.tick()}},{key:"onMediaEnded",value:function(){b.logger.log("media ended"),this.startPosition=this.lastCurrentTime=0}},{key:"onManifestLoading",value:function(){b.logger.log("trigger BUFFER_RESET"),this.hls.trigger(d.default.BUFFER_RESET),this._bufferedFrags=[],this.stalled=!1,this.startPosition=this.lastCurrentTime=0}},{key:"onManifestParsed",value:function(e){var t,r=!1,n=!1;e.levels.forEach(function(e){(t=e.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=r&&n,this.audioCodecSwitch&&b.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=e.levels,this.startLevelLoaded=!1,this.startFragRequested=!1;var i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)}},{key:"onLevelLoaded",value:function(e){var t=e.details,r=e.level,n=this.levels[r],i=t.totalduration,a=0;if(b.logger.log("level "+r+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i),this.levelLastLoaded=r,t.live){var o=n.details;o&&t.fragments.length>0?(v.default.mergeDetails(o,t),a=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(a,o),t.PTSKnown?b.logger.log("live playlist sliding:"+a.toFixed(3)):b.logger.log("live playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,b.logger.log("live playlist - first load, unknown sliding"))}else t.PTSKnown=!1;if(n.details=t,this.hls.trigger(d.default.LEVEL_UPDATED,{details:t,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var s=t.startTimeOffset;isNaN(s)?t.live?(this.startPosition=this.computeLivePosition(a,t),b.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0:(s<0&&(b.logger.log("negative start time offset "+s+", count from end of last fragment"),s=a+i+s),b.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s),this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===E.WAITING_LEVEL&&(this.state=E.IDLE),this.tick()}},{key:"onKeyLoaded",value:function(){this.state===E.KEY_LOADING&&(this.state=E.IDLE,this.tick())}},{key:"onFragLoaded",value:function(e){var t=this.fragCurrent,r=e.frag;if(this.state===E.FRAG_LOADING&&t&&"main"===r.type&&r.level===t.level&&r.sn===t.sn){var n=e.stats,i=this.levels[t.level],a=i.details;if(b.logger.log("Loaded  "+t.sn+" of ["+a.startSN+" ,"+a.endSN+"],level "+t.level),this.bitrateTest=!1,this.stats=n,!0===r.bitrateTest&&this.hls.nextLoadLevel)this.state=E.IDLE,this.startFragRequested=!1,n.tparsed=n.tbuffered=performance.now(),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else if("initSegment"===r.sn)this.state=E.IDLE,n.tparsed=n.tbuffered=performance.now(),a.initSegment.data=e.payload,this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.tick();else{this.state=E.PARSING;var o=a.totalduration,s=t.level,l=t.sn,c=this.config.defaultAudioCodec||i.audioCodec;this.audioCodecSwap&&(b.logger.log("swapping playlist audio codec"),void 0===c&&(c=this.lastAudioCodec),c&&(c=-1!==c.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),this.pendingBuffering=!0,this.appended=!1,b.logger.log("Parsing "+l+" of ["+a.startSN+" ,"+a.endSN+"],level "+s+", cc "+t.cc);var f=this.demuxer;f||(f=this.demuxer=new u.default(this.hls,"main"));var h=this.media,p=h&&h.seeking,v=!p&&(a.PTSKnown||!a.live),g=a.initSegment?a.initSegment.data:[];f.push(e.payload,g,c,i.videoCodec,t,o,v,void 0)}}this.fragLoadError=0}},{key:"onFragParsingInitSegment",value:function(e){var t=this.fragCurrent,r=e.frag;if(t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E.PARSING){var n,i,a=e.tracks;if(a.audio&&this.altAudio&&delete a.audio,i=a.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(b.logger.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==i.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==i.container&&(o="mp4a.40.2",b.logger.log("Android: force audio codec to "+o)),i.levelCodec=o,i.id=e.id}for(n in(i=a.video)&&(i.levelCodec=this.levels[this.level].videoCodec,i.id=e.id),this.hls.trigger(d.default.BUFFER_CODECS,a),a){i=a[n],b.logger.log("main track:"+n+",container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var l=i.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(d.default.BUFFER_APPENDING,{type:n,data:l,parent:"main",content:"initSegment"}))}this.tick()}}},{key:"onFragParsingData",value:function(e){var t=this,r=this.fragCurrent,n=e.frag;if(r&&"main"===e.id&&n.sn===r.sn&&n.level===r.level&&("audio"!==e.type||!this.altAudio)&&this.state===E.PARSING){var i=this.levels[this.level],a=r;if(isNaN(e.endPTS)&&(e.endPTS=e.startPTS+r.duration,e.endDTS=e.startDTS+r.duration),b.logger.log("Parsed "+e.type+",PTS:["+e.startPTS.toFixed(3)+","+e.endPTS.toFixed(3)+"],DTS:["+e.startDTS.toFixed(3)+"/"+e.endDTS.toFixed(3)+"],nb:"+e.nb+",dropped:"+(e.dropped||0)),"video"===e.type)if(a.dropped=e.dropped,a.dropped){if(!a.backtracked)return b.logger.warn("missing video frame(s), backtracking fragment"),a.backtracked=!0,this.nextLoadPosition=e.startPTS,this.state=E.IDLE,this.fragPrevious=a,void this.tick();b.logger.warn("Already backtracked on this fragment, appending with the gap")}else a.backtracked=!1;var o=v.default.updateFragPTSDTS(i.details,a,e.startPTS,e.endPTS,e.startDTS,e.endDTS),s=this.hls;s.trigger(d.default.LEVEL_PTS_UPDATED,{details:i.details,level:this.level,drift:o,type:e.type,start:e.startPTS,end:e.endPTS}),[e.data1,e.data2].forEach(function(r){r&&r.length&&t.state===E.PARSING&&(t.appended=!0,t.pendingBuffering=!0,s.trigger(d.default.BUFFER_APPENDING,{type:e.type,data:r,parent:"main",content:"data"}))}),this.tick()}}},{key:"onFragParsed",value:function(e){var t=this.fragCurrent,r=e.frag;t&&"main"===e.id&&r.sn===t.sn&&r.level===t.level&&this.state===E.PARSING&&(this.stats.tparsed=performance.now(),this.state=E.PARSED,this._checkAppendedParsed())}},{key:"onAudioTrackSwitching",value:function(e){var t=!!e.url,r=e.id;if(!t){if(this.mediaBuffer!==this.media){b.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var n=this.fragCurrent;n.loader&&(b.logger.log("switching to main audio track, cancel main fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=E.IDLE}var i=this.hls;i.trigger(d.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),i.trigger(d.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}}},{key:"onAudioTrackSwitched",value:function(e){var t=e.id,r=!!this.hls.audioTracks[t].url;if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(b.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r,this.tick()}},{key:"onBufferCreated",value:function(e){var t=e.tracks,r=void 0,n=void 0,i=!1;for(var a in t){var o=t[a];"main"===o.id?(n=a,r=o,"video"===a&&(this.videoBuffer=t[a].buffer)):i=!0}i&&r?(b.logger.log("alternate track found, use "+n+".buffered to schedule main fragment loading"),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}},{key:"onBufferAppended",value:function(e){if("main"===e.parent){var t=this.state;t!==E.PARSING&&t!==E.PARSED||(this.pendingBuffering=e.pending>0,this._checkAppendedParsed())}}},{key:"_checkAppendedParsed",value:function(){if(!(this.state!==E.PARSED||this.appended&&this.pendingBuffering)){var e=this.fragCurrent;if(e){var t=this.mediaBuffer?this.mediaBuffer:this.media;b.logger.log("main buffered : "+y.default.toString(t.buffered));var r=this._bufferedFrags.filter(function(e){return s.default.isBuffered(t,(e.startPTS+e.endPTS)/2)});r.push(e),this._bufferedFrags=r.sort(function(e,t){return e.startPTS-t.startPTS}),this.fragPrevious=e;var n=this.stats;n.tbuffered=performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(d.default.FRAG_BUFFERED,{stats:n,frag:e,id:"main"}),this.state=E.IDLE}this.tick()}}},{key:"onError",value:function(e){var t=e.frag||this.fragCurrent;if(!t||"main"===t.type){var r=this.media,n=r&&s.default.isBuffered(r,r.currentTime)&&s.default.isBuffered(r,r.currentTime+.5);switch(e.details){case m.ErrorDetails.FRAG_LOAD_ERROR:case m.ErrorDetails.FRAG_LOAD_TIMEOUT:case m.ErrorDetails.KEY_LOAD_ERROR:case m.ErrorDetails.KEY_LOAD_TIMEOUT:if(!e.fatal){var i=this.fragLoadError;i?i++:i=1;var a=this.config;if(i<=a.fragLoadingMaxRetry||n||t.autoLevel&&t.level){this.fragLoadError=i,t.loadCounter=0;var o=Math.min(Math.pow(2,i-1)*a.fragLoadingRetryDelay,a.fragLoadingMaxRetryTimeout);b.logger.warn("mediaController: frag loading failed, retry in "+o+" ms"),this.retryDate=performance.now()+o,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.state=E.FRAG_LOADING_WAITING_RETRY}else b.logger.error("mediaController: "+e.details+" reaches max retry, redispatch as fatal ..."),e.fatal=!0,this.state=E.ERROR}break;case m.ErrorDetails.FRAG_LOOP_LOADING_ERROR:e.fatal||(n?(this._reduceMaxBufferLength(t.duration),this.state=E.IDLE):t.autoLevel&&0!==t.level||(e.fatal=!0,this.state=E.ERROR));break;case m.ErrorDetails.LEVEL_LOAD_ERROR:case m.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==E.ERROR&&(e.fatal?(this.state=E.ERROR,b.logger.warn("streamController: "+e.details+",switch to "+this.state+" state ...")):e.levelRetry||this.state!==E.WAITING_LEVEL||(this.state=E.IDLE));break;case m.ErrorDetails.BUFFER_FULL_ERROR:"main"!==e.parent||this.state!==E.PARSING&&this.state!==E.PARSED||(n?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=E.IDLE):(b.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}}},{key:"_reduceMaxBufferLength",value:function(e){var t=this.config;t.maxMaxBufferLength>=e&&(t.maxMaxBufferLength/=2,b.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),this.fragLoadIdx+=2*t.fragLoadingLoopThreshold)}},{key:"_checkBuffer",value:function(){var e=this.media,t=this.config;if(e&&e.readyState){var r=e.currentTime,n=this.mediaBuffer?this.mediaBuffer:e,i=n.buffered;if(!this.loadedmetadata&&i.length){this.loadedmetadata=!0;var a=e.seeking?r:this.startPosition,o=s.default.isBuffered(n,a),l=i.start(0);(r!==a||!o&&Math.abs(a-l)<t.maxSeekHole)&&(b.logger.log("target start position:"+a),o||(a=l,b.logger.log("target start position not buffered, seek to buffered.start(0) "+a)),b.logger.log("adjust currentTime from "+r+" to "+a),e.currentTime=a)}else if(this.immediateSwitch)this.immediateLevelSwitchEnd();else{var u=s.default.bufferInfo(e,r,0),c=!(e.paused||e.ended||0===e.buffered.length),f=r!==this.lastCurrentTime;if(f)this.stallReported&&(b.logger.warn("playback not stuck anymore @"+r+", after "+Math.round(performance.now()-this.stalled)+"ms"),this.stallReported=!1),this.stalled=void 0,this.nudgeRetry=0;else if(c){var h=performance.now(),p=this.hls;if(this.stalled){var v=h-this.stalled,g=u.len,y=this.nudgeRetry||0;if(g<=.5&&v>1e3*t.lowBufferWatchdogPeriod){this.stallReported||(this.stallReported=!0,b.logger.warn("playback stalling in low buffer @"+r),p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:g}));var _=u.nextStart,E=_-r;if(_&&E<t.maxSeekHole&&E>0){this.nudgeRetry=++y;var k=y*t.nudgeOffset;b.logger.log("adjust currentTime from "+e.currentTime+" to next buffered @ "+_+" + nudge "+k),e.currentTime=_+k,this.stalled=void 0,p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,hole:_+k-r})}}else if(g>.5&&v>1e3*t.highBufferWatchdogPeriod)if(this.stallReported||(this.stallReported=!0,b.logger.warn("playback stalling in high buffer @"+r),p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:g})),this.stalled=void 0,this.nudgeRetry=++y,y<t.nudgeMaxRetry){var w=e.currentTime,T=w+y*t.nudgeOffset;b.logger.log("adjust currentTime from "+w+" to "+T),e.currentTime=T,p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else b.logger.error("still stuck in high buffer @"+r+" after "+t.nudgeMaxRetry+", raise fatal error"),p.trigger(d.default.ERROR,{type:m.ErrorTypes.MEDIA_ERROR,details:m.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}else this.stalled=h,this.stallReported=!1}}}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=E.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()}},{key:"onBufferFlushed",value:function(){var e=this.mediaBuffer?this.mediaBuffer:this.media;this._bufferedFrags=this._bufferedFrags.filter(function(t){return s.default.isBuffered(e,(t.startPTS+t.endPTS)/2)}),this.fragLoadIdx+=2*this.config.fragLoadingLoopThreshold,this.state=E.IDLE,this.fragPrevious=null}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"computeLivePosition",value:function(e,t){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return e+Math.max(0,t.totalduration-r)}},{key:"state",set:function(e){if(this.state!==e){var t=this.state;this._state=e,b.logger.log("main stream:"+t+"->"+e),this.hls.trigger(d.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:e})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var e=this.media;if(e){var t=this.getBufferedFrag(e.currentTime);if(t)return t.level}return-1}},{key:"nextBufferedFrag",get:function(){var e=this.media;return e?this.followingBufferedFrag(this.getBufferedFrag(e.currentTime)):null}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(e){this._liveSyncPosition=e}}]),t}(h.default);r.default=k},{20:20,28:28,29:29,30:30,32:32,33:33,43:43,46:46,47:47}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.aesIV=r}return n(e,[{key:"decrypt",value:function(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}]),e}();r.default=i},{}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}return n(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],d=s[3],f=new Uint32Array(256),h=0,p=0,v=0;for(v=0;v<256;v++)f[v]=v<128?v<<1:v<<1^283;for(v=0;v<256;v++){var g=p^p<<1^p<<2^p<<3^p<<4;g=g>>>8^255&g^99,e[h]=g,t[g]=h;var y=f[h],m=f[y],b=f[m],_=257*f[g]^16843008*g;n[h]=_<<24|_>>>8,i[h]=_<<16|_>>>16,a[h]=_<<8|_>>>24,o[h]=_,_=16843009*b^65537*m^257*y^16843008*h,l[g]=_<<24|_>>>8,u[g]=_<<16|_>>>16,c[g]=_<<8|_>>>24,d[g]=_,h?(h=y^f[f[f[b^y]]],p^=f[f[p]]):h=p=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a=this.ksRows=4*(i+6+1),o=void 0,s=void 0,l=this.keySchedule=new Uint32Array(a),u=this.invKeySchedule=new Uint32Array(a),c=this.sBox,d=this.rcon,f=this.invSubMix,h=f[0],p=f[1],v=f[2],g=f[3],y=void 0,m=void 0;for(o=0;o<a;o++)o<i?y=l[o]=t[o]:(m=y,o%i==0?(m=c[(m=m<<8|m>>>24)>>>24]<<24|c[m>>>16&255]<<16|c[m>>>8&255]<<8|c[255&m],m^=d[o/i|0]<<24):i>6&&o%i==4&&(m=c[m>>>24]<<24|c[m>>>16&255]<<16|c[m>>>8&255]<<8|c[255&m]),l[o]=y=(l[o-i]^m)>>>0);for(s=0;s<a;s++)o=a-s,m=3&s?l[o]:l[o-4],u[s]=s<4||o<=4?m:h[c[m>>>24]]^p[c[m>>>16&255]]^v[c[m>>>8&255]]^g[c[255&m]],u[s]=u[s]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,r){for(var n,i,a=this.keySize+6,o=this.invKeySchedule,s=this.invSBox,l=this.invSubMix,u=l[0],c=l[1],d=l[2],f=l[3],h=this.uint8ArrayToUint32Array_(r),p=h[0],v=h[1],g=h[2],y=h[3],m=new Int32Array(e),b=new Int32Array(m.length),_=void 0,E=void 0,k=void 0,w=void 0,T=void 0,S=void 0,A=void 0,R=void 0,x=void 0,L=void 0,O=void 0,D=void 0,P=this.networkToHostOrderSwap;t<m.length;){for(x=P(m[t]),L=P(m[t+1]),O=P(m[t+2]),D=P(m[t+3]),T=x^o[0],S=D^o[1],A=O^o[2],R=L^o[3],n=4,i=1;i<a;i++)_=u[T>>>24]^c[S>>16&255]^d[A>>8&255]^f[255&R]^o[n],E=u[S>>>24]^c[A>>16&255]^d[R>>8&255]^f[255&T]^o[n+1],k=u[A>>>24]^c[R>>16&255]^d[T>>8&255]^f[255&S]^o[n+2],w=u[R>>>24]^c[T>>16&255]^d[S>>8&255]^f[255&A]^o[n+3],T=_,S=E,A=k,R=w,n+=4;_=s[T>>>24]<<24^s[S>>16&255]<<16^s[A>>8&255]<<8^s[255&R]^o[n],E=s[S>>>24]<<24^s[A>>16&255]<<16^s[R>>8&255]<<8^s[255&T]^o[n+1],k=s[A>>>24]<<24^s[R>>16&255]<<16^s[T>>8&255]<<8^s[255&S]^o[n+2],w=s[R>>>24]<<24^s[T>>16&255]<<16^s[S>>8&255]<<8^s[255&A]^o[n+3],n+=3,b[t]=P(_^p),b[t+1]=P(w^v),b[t+2]=P(k^g),b[t+3]=P(E^y),p=x,v=L,g=O,y=D,t+=4}return b.buffer}},{key:"destroy",value:function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0}}]),e}();r.default=i},{}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(12),a=f(i),o=e(15),s=f(o),l=e(13),u=f(l),c=e(28),d=e(46);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.logEnabled=!0;try{var n=crypto||self.crypto;this.subtle=n.subtle||n.webkitSubtle}catch(e){}this.disableWebCrypto=!this.subtle}return n(e,[{key:"isSync",value:function(){return this.disableWebCrypto&&this.config.enableSoftwareAES}},{key:"decrypt",value:function(e,t,r,n){var i=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(d.logger.log("JS AES decrypt"),this.logEnabled=!1);var o=this.decryptor;o||(this.decryptor=o=new u.default),o.expandKey(t),n(o.decrypt(e,0,r))}else{this.logEnabled&&(d.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var l=this.subtle;this.key!==t&&(this.key=t,this.fastAesKey=new s.default(l,t)),this.fastAesKey.expandKey().then(function(o){var s=new a.default(l,r);s.decrypt(e,o).catch(function(a){i.onWebCryptoError(a,e,t,r,n)}).then(function(e){n(e)})}).catch(function(a){i.onWebCryptoError(a,e,t,r,n)})}}},{key:"onWebCryptoError",value:function(e,t,r,n,i){this.config.enableSoftwareAES?(d.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,r,n,i)):(d.logger.error("decrypting error : "+e.message),this.observer.trigger(Event.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:e.message}))}},{key:"destroy",value:function(){var e=this.decryptor;e&&(e.destroy(),this.decryptor=void 0)}}]),e}();r.default=h},{12:12,13:13,15:15,28:28,46:46}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.subtle=t,this.key=r}return n(e,[{key:"expandKey",value:function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}]),e}();r.default=i},{}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(17),a=u(i),o=e(46),s=e(22),l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.remuxer=r}return n(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/adts",type:"audio",id:-1,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var i=this._audioTrack,s=l.default.getID3Data(e,0),u=90*l.default.getTimeStamp(s),c=0,d=u,f=e.length,h=s.length,p=[{pts:d,dts:d,data:s}];h<f-1;)if(a.default.isHeader(e,h)&&h+5<f){a.default.initTrackConfig(i,this.observer,e,h,i.manifestCodec);var v=a.default.appendFrame(i,e,h,u,c);if(!v){o.logger.log("Unable to parse AAC frame");break}h+=v.length,d=v.sample.pts,c++}else l.default.isHeader(e,h)?(s=l.default.getID3Data(e,h),p.push({pts:d,dts:d,data:s}),h+=s.length):h++;this.remuxer.remux(i,{samples:[]},{samples:p,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=l.default.getID3Data(e,0);if(n&&void 0!==l.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(a.default.probe(e,t))return o.logger.log("ADTS sync word found !"),!0;return!1}}]),e}();r.default=c},{17:17,22:22,46:46}],17:[function(e,t,r){"use strict";var n=e(46),i=e(28),a={getAudioConfig:function(e,t,r,a){var o,s,l,u,c,d=navigator.userAgent.toLowerCase(),f=a,h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&t[r+2])>>>6),!((s=(60&t[r+2])>>>2)>h.length-1))return u=(1&t[r+2])<<2,u|=(192&t[r+3])>>>6,n.logger.log("manifest codec:"+a+",ADTS data:type:"+o+",sampleingIndex:"+s+"["+h[s]+"Hz],channelConfig:"+u),/firefox/i.test(d)?s>=6?(o=5,c=new Array(4),l=s-3):(o=2,c=new Array(2),l=s):-1!==d.indexOf("android")?(o=2,c=new Array(2),l=s):(o=5,c=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&s>=6?l=s-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(s>=6&&1===u||/vivaldi/i.test(d))||!a&&1===u)&&(o=2,c=new Array(2)),l=s)),c[0]=o<<3,c[0]|=(14&s)>>1,c[1]|=(1&s)<<7,c[1]|=u<<3,5===o&&(c[1]|=(14&l)>>1,c[2]=(1&l)<<7,c[2]|=8,c[3]=0),{config:c,samplerate:h[s],channelCount:u,codec:"mp4a.40."+o,manifestCodec:f};e.trigger(Event.ERROR,{type:i.ErrorTypes.MEDIA_ERROR,details:i.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+s})},isHeaderPattern:function(e,t){return 255===e[t]&&240==(246&e[t+1])},getHeaderLength:function(e,t){return 1&e[t+1]?7:9},getFullFrameLength:function(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.getHeaderLength(e,t),n=r;t+5<e.length&&(n=this.getFullFrameLength(e,t));var i=t+n;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1},initTrackConfig:function(e,t,r,i,a){if(!e.samplerate){var o=this.getAudioConfig(t,r,i,a);e.config=o.config,e.samplerate=o.samplerate,e.channelCount=o.channelCount,e.codec=o.codec,e.manifestCodec=o.manifestCodec,n.logger.log("parsed codec:"+e.codec+",rate:"+o.samplerate+",nb channel:"+o.channelCount)}},getFrameDuration:function(e){return 9216e4/e},appendFrame:function(e,t,r,n,i){var a=this.getFrameDuration(e.samplerate),o=this.parseFrameHeader(t,r,n,i,a);if(o){var s=o.stamp,l=o.headerLength,u=o.frameLength,c={unit:t.subarray(r+l,r+l+u),pts:s,dts:s};return e.samples.push(c),e.len+=u,{sample:c,length:u+l}}},parseFrameHeader:function(e,t,r,n,i){var a,o,s=e.length;if(a=this.getHeaderLength(e,t),o=this.getFullFrameLength(e,t),(o-=a)>0&&t+a+o<=s)return{headerLength:a,frameLength:o,stamp:r+n*i}}};t.exports=a},{28:28,46:46}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=E(i),o=e(28),s=e(14),l=E(s),u=e(16),c=E(u),d=e(24),f=E(d),h=e(27),p=E(h),v=e(23),g=E(v),y=e(40),m=E(y),b=e(41),_=E(b);function E(e){return e&&e.__esModule?e:{default:e}}var k=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.typeSupported=r,this.config=n,this.vendor=i}return n(e,[{key:"destroy",value:function(){var e=this.demuxer;e&&e.destroy()}},{key:"push",value:function(e,t,r,n,i,o,s,u,c,d,f,h){if(e.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method){var p=this.decrypter;null==p&&(p=this.decrypter=new l.default(this.observer,this.config));var v,g=this;try{v=performance.now()}catch(e){v=Date.now()}p.decrypt(e,t.key.buffer,t.iv.buffer,function(e){var l;try{l=performance.now()}catch(e){l=Date.now()}g.observer.trigger(a.default.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:l}}),g.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,i,o,s,u,c,d,f,h)})}else this.pushDecrypted(new Uint8Array(e),t,new Uint8Array(r),n,i,o,s,u,c,d,f,h)}},{key:"pushDecrypted",value:function(e,t,r,n,i,s,l,u,d,h,v,y){var b=this.demuxer;if(!b||l&&!this.probe(e)){for(var E=this.observer,k=this.typeSupported,w=this.config,T=[{demux:c.default,remux:m.default},{demux:g.default,remux:m.default},{demux:p.default,remux:m.default},{demux:f.default,remux:_.default}],S=0,A=T.length;S<A;S++){var R=T[S],x=R.demux.probe;if(x(e)){var L=this.remuxer=new R.remux(E,w,k,this.vendor);b=new R.demux(E,L,w,k),this.probe=x;break}}if(!b)return void E.trigger(a.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=b}var O=this.remuxer;(l||u)&&(b.resetInitSegment(r,n,i,h),O.resetInitSegment()),l&&(b.resetTimeStamp(y),O.resetTimeStamp(y)),"function"==typeof b.setDecryptData&&b.setDecryptData(t),b.append(e,s,d,v)}}]),e}();r.default=k},{14:14,16:16,23:23,24:24,27:27,28:28,30:30,40:40,41:41}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e(18),i=c(n),a=e(30),o=c(a),s=e(46),l=e(1),u=c(l);function c(e){return e&&e.__esModule?e:{default:e}}r.default=function(e){var t=new u.default;t.trigger=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.emit.apply(t,[e,e].concat(n))},t.off=function(e){for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];t.removeListener.apply(t,[e].concat(n))};var r=function(t,r){e.postMessage({event:t,data:r})};e.addEventListener("message",function(n){var a=n.data;switch(a.cmd){case"init":var o=JSON.parse(a.config);e.demuxer=new i.default(t,a.typeSupported,o,a.vendor);try{(0,s.enableLogs)(!0===o.debug)}catch(e){console.warn("demuxerWorker: unable to enable logs")}r("init",null);break;case"demux":e.demuxer.push(a.data,a.decryptdata,a.initSegment,a.audioCodec,a.videoCodec,a.timeOffset,a.discontinuity,a.trackSwitch,a.contiguous,a.duration,a.accurateTimeOffset,a.defaultInitPTS)}}),t.on(o.default.FRAG_DECRYPTED,r),t.on(o.default.FRAG_PARSING_INIT_SEGMENT,r),t.on(o.default.FRAG_PARSED,r),t.on(o.default.ERROR,r),t.on(o.default.FRAG_PARSING_METADATA,r),t.on(o.default.FRAG_PARSING_USERDATA,r),t.on(o.default.INIT_PTS_FOUND,r),t.on(o.default.FRAG_PARSING_DATA,function(t,r){var n=[],i={event:t,data:r};r.data1&&(i.data1=r.data1.buffer,n.push(r.data1.buffer),delete r.data1),r.data2&&(i.data2=r.data2.buffer,n.push(r.data2.buffer),delete r.data2),e.postMessage(i,n)})}},{1:1,18:18,30:30,46:46}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=p(i),o=e(18),s=p(o),l=e(19),u=p(l),c=e(46),d=e(28),f=e(1),h=p(f);function p(e){return e&&e.__esModule?e:{default:e}}var v=function(){function t(r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.hls=r,this.id=n;var i=this.observer=new h.default,o=r.config;i.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.emit.apply(i,[e,e].concat(r))},i.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];i.removeListener.apply(i,[e].concat(r))};var l=function(e,t){(t=t||{}).frag=this.frag,t.id=this.id,r.trigger(e,t)}.bind(this);i.on(a.default.FRAG_DECRYPTED,l),i.on(a.default.FRAG_PARSING_INIT_SEGMENT,l),i.on(a.default.FRAG_PARSING_DATA,l),i.on(a.default.FRAG_PARSED,l),i.on(a.default.ERROR,l),i.on(a.default.FRAG_PARSING_METADATA,l),i.on(a.default.FRAG_PARSING_USERDATA,l),i.on(a.default.INIT_PTS_FOUND,l);var f={mp4:MediaSource.isTypeSupported("video/mp4"),mpeg:MediaSource.isTypeSupported("audio/mpeg"),mp3:MediaSource.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor;if(o.enableWorker&&"undefined"!=typeof Worker){c.logger.log("demuxing in webworker");var v=void 0;try{var g=e(3);v=this.w=g(u.default),this.onwmsg=this.onWorkerMessage.bind(this),v.addEventListener("message",this.onwmsg),v.onerror=function(e){r.trigger(a.default.ERROR,{type:d.ErrorTypes.OTHER_ERROR,details:d.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},v.postMessage({cmd:"init",typeSupported:f,vendor:p,id:n,config:JSON.stringify(o)})}catch(e){c.logger.error("error while initializing DemuxerWorker, fallback on DemuxerInline"),v&&URL.revokeObjectURL(v.objectURL),this.demuxer=new s.default(i,f,o,p),this.w=void 0}}else this.demuxer=new s.default(i,f,o,p)}return n(t,[{key:"destroy",value:function(){var e=this.w;if(e)e.removeEventListener("message",this.onwmsg),e.terminate(),this.w=null;else{var t=this.demuxer;t&&(t.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)}},{key:"push",value:function(e,t,r,n,i,a,o,s){var l=this.w,u=isNaN(i.startDTS)?i.start:i.startDTS,d=i.decryptdata,f=this.frag,h=!(f&&i.cc===f.cc),p=!(f&&i.level===f.level),v=f&&i.sn===f.sn+1,g=!p&&v;if(h&&c.logger.log(this.id+":discontinuity detected"),p&&c.logger.log(this.id+":switch detected"),this.frag=i,l)l.postMessage({cmd:"demux",data:e,decryptdata:d,initSegment:t,audioCodec:r,videoCodec:n,timeOffset:u,discontinuity:h,trackSwitch:p,contiguous:g,duration:a,accurateTimeOffset:o,defaultInitPTS:s},[e]);else{var y=this.demuxer;y&&y.push(e,d,t,r,n,u,h,p,g,a,o,s)}}},{key:"onWorkerMessage",value:function(e){var t=e.data,r=this.hls;switch(t.event){case"init":URL.revokeObjectURL(this.w.objectURL);break;case a.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1),t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,r.trigger(t.event,t.data)}}}]),t}();r.default=v},{1:1,18:18,19:19,28:28,3:3,30:30,46:46}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(46),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return n(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;return e>32&&i.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}},{key:"skipScalingList",value:function(e){var t,r,n=8,i=8;for(t=0;t<e;t++)0!==i&&(r=this.readEG(),i=(n+r+256)%256),n=0===i?n:i}},{key:"readSPS",value:function(){var e,t,r,n,i,a,o,s=0,l=0,u=0,c=0,d=this.readUByte.bind(this),f=this.readBits.bind(this),h=this.readUEG.bind(this),p=this.readBoolean.bind(this),v=this.skipBits.bind(this),g=this.skipEG.bind(this),y=this.skipUEG.bind(this),m=this.skipScalingList.bind(this);if(d(),e=d(),f(5),v(3),d(),y(),100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e){var b=h();if(3===b&&v(1),y(),y(),v(1),p())for(a=3!==b?8:12,o=0;o<a;o++)p()&&m(o<6?16:64)}y();var _=h();if(0===_)h();else if(1===_)for(v(1),g(),g(),t=h(),o=0;o<t;o++)g();y(),v(1),r=h(),n=h(),0===(i=f(1))&&v(1),v(1),p()&&(s=h(),l=h(),u=h(),c=h());var E=[1,1];if(p()&&p()){var k=d();switch(k){case 1:E=[1,1];break;case 2:E=[12,11];break;case 3:E=[10,11];break;case 4:E=[16,11];break;case 5:E=[40,33];break;case 6:E=[24,11];break;case 7:E=[20,11];break;case 8:E=[32,11];break;case 9:E=[80,33];break;case 10:E=[18,11];break;case 11:E=[15,11];break;case 12:E=[64,33];break;case 13:E=[160,99];break;case 14:E=[4,3];break;case 15:E=[3,2];break;case 16:E=[2,1];break;case 255:E=[d()<<8|d(),d()<<8|d()]}}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-i)*(n+1)*16-(i?2:4)*(u+c),pixelRatio:E}}},{key:"readSliceType",value:function(){return this.readUByte(),this.readUEG(),this.readUEG()}}]),e}();r.default=a},{46:46}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"isHeader",value:function(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"isFooter",value:function(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}},{key:"getID3Data",value:function(t,r){for(var n=r,i=0;e.isHeader(t,r);){i+=10;var a=e._readSize(t,r+6);i+=a,e.isFooter(t,r+10)&&(i+=10),r+=i}if(i>0)return t.subarray(n,n+i)}},{key:"_readSize",value:function(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,r|=(127&e[t+2])<<7,r|=127&e[t+3]}},{key:"getTimeStamp",value:function(t){for(var r=e.getID3Frames(t),n=0;n<r.length;n++){var i=r[n];if(e.isTimeStampFrame(i))return e._readTimeStamp(i)}}},{key:"isTimeStampFrame",value:function(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}},{key:"_getFrameData",value:function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),n=e._readSize(t,4);return{type:r,size:n,data:t.subarray(10,10+n)}}},{key:"getID3Frames",value:function(t){for(var r=0,n=[];e.isHeader(t,r);){for(var i=e._readSize(t,r+6),a=(r+=10)+i;r+8<a;){var o=e._getFrameData(t.subarray(r)),s=e._decodeFrame(o);s&&n.push(s),r+=o.size+10}e.isFooter(t,r)&&(r+=10)}return n}},{key:"_decodeFrame",value:function(t){return"PRIV"===t.type?e._decodePrivFrame(t):"T"===t.type[0]?e._decodeTextFrame(t):"W"===t.type[0]?e._decodeURLFrame(t):void 0}},{key:"_readTimeStamp",value:function(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}},{key:"_decodePrivFrame",value:function(t){if(!(t.size<2)){var r=e._utf8ArrayToStr(t.data),n=new Uint8Array(t.data.subarray(r.length+1));return{key:t.type,info:r,data:n.buffer}}}},{key:"_decodeTextFrame",value:function(t){if(!(t.size<2)){if("TXXX"===t.type){var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data.subarray(1));return{key:t.type,data:a}}}},{key:"_decodeURLFrame",value:function(t){if("WXXX"===t.type){if(t.size<2)return;var r=1,n=e._utf8ArrayToStr(t.data.subarray(r));r+=n.length+1;var i=e._utf8ArrayToStr(t.data.subarray(r));return{key:t.type,info:n,data:i}}var a=e._utf8ArrayToStr(t.data);return{key:t.type,data:a}}},{key:"_utf8ArrayToStr",value:function(e){for(var t=void 0,r=void 0,n="",i=0,a=e.length;i<a;){var o=e[i++];switch(o>>4){case 0:return n;case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(o);break;case 12:case 13:t=e[i++],n+=String.fromCharCode((31&o)<<6|63&t);break;case 14:t=e[i++],r=e[i++],n+=String.fromCharCode((15&o)<<12|(63&t)<<6|(63&r)<<0)}}return n}}]),e}();r.default=i},{}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(22),a=u(i),o=e(46),s=e(25),l=u(s);function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.remuxer=r}return n(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:n,inputTimeScale:9e4}}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){for(var i=a.default.getID3Data(e,0),o=90*a.default.getTimeStamp(i),s=i.length,u=e.length,c=0,d=0,f=this._audioTrack,h=[{pts:o,dts:o,data:i}];s<u;)if(l.default.isHeader(e,s)){var p=l.default.appendFrame(f,e,s,o,c);if(!p)break;s+=p.length,d=p.sample.pts,c++}else a.default.isHeader(e,s)?(i=a.default.getID3Data(e,s),h.push({pts:d,dts:d,data:i}),s+=i.length):s++;this.remuxer.remux(f,{samples:[]},{samples:h,inputTimeScale:9e4},{samples:[]},t,r,n)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(e){var t,r,n=a.default.getID3Data(e,0);if(n&&void 0!==a.default.getTimeStamp(n))for(t=n.length,r=Math.min(e.length-1,t+100);t<r;t++)if(l.default.probe(e,t))return o.logger.log("MPEG Audio sync word found !"),!0;return!1}}]),e}();r.default=c},{22:22,25:25,46:46}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=Math.pow(2,32)-1,s=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.remuxer=r}return n(e,[{key:"resetTimeStamp",value:function(e){this.initPTS=e}},{key:"resetInitSegment",value:function(t,r,n,i){if(t&&t.byteLength){var o=this.initData=e.parseInitSegment(t),s={};o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:i?t:null}),o.video&&(s.video={container:"video/mp4",codec:n,initSegment:i?t:null}),this.observer.trigger(a.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),n&&(this.videoCodec=n)}},{key:"append",value:function(t,r,n,i){var o=this.initData;o||(this.resetInitSegment(t,this.audioCodec,this.videoCodec),o=this.initData);var s=void 0,l=this.initPTS;if(void 0===l){var u=e.getStartDTS(o,t);this.initPTS=l=u-r,this.observer.trigger(a.default.INIT_PTS_FOUND,{initPTS:l})}e.offsetStartDTS(o,t,l),s=e.getStartDTS(o,t),this.remuxer.remux(o.audio,o.video,null,null,s,n,i,t)}},{key:"destroy",value:function(){}}],[{key:"probe",value:function(t){if(t.length>=8){var r=e.bin2str(t.subarray(4,8));return["moof","ftyp","styp"].indexOf(r)>=0}return!1}},{key:"bin2str",value:function(e){return String.fromCharCode.apply(null,e)}},{key:"readUint32",value:function(e,t){e.data&&(t+=e.start,e=e.data);var r=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3];return r<0?4294967296+r:r}},{key:"writeUint32",value:function(e,t,r){e.data&&(t+=e.start,e=e.data),e[t]=r>>24,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}},{key:"findBox",value:function(t,r){var n,i,a,o,s,l,u,c=[];if(t.data?(l=t.start,o=t.end,t=t.data):(l=0,o=t.byteLength),!r.length)return null;for(n=l;n<o;)i=e.readUint32(t,n),a=e.bin2str(t.subarray(n+4,n+8)),u=i>1?n+i:o,a===r[0]&&(1===r.length?c.push({data:t,start:n+8,end:u}):(s=e.findBox({data:t,start:n+8,end:u},r.slice(1))).length&&(c=c.concat(s))),n=u;return c}},{key:"parseInitSegment",value:function(t){var r=[],n=e.findBox(t,["moov","trak"]);return n.forEach(function(t){var n=e.findBox(t,["tkhd"])[0];if(n){var i=n.data[n.start],a=0===i?12:20,o=e.readUint32(n,a),s=e.findBox(t,["mdia","mdhd"])[0];if(s){i=s.data[s.start],a=0===i?12:20;var l=e.readUint32(s,a),u=e.findBox(t,["mdia","hdlr"])[0];if(u){var c=e.bin2str(u.data.subarray(u.start+8,u.start+12)),d={soun:"audio",vide:"video"}[c];d&&(r[o]={timescale:l,type:d},r[d]={timescale:l,id:o})}}}}),r}},{key:"getStartDTS",value:function(t,r){var n,i,a;return n=e.findBox(r,["moof","traf"]),i=[].concat.apply([],n.map(function(r){return e.findBox(r,["tfhd"]).map(function(n){var i,a;return i=e.readUint32(n,4),a=t[i].timescale||9e4,(e.findBox(r,["tfdt"]).map(function(t){var r,n;return r=t.data[t.start],n=e.readUint32(t,4),1===r&&(n*=Math.pow(2,32),n+=e.readUint32(t,8)),n})[0]||1/0)/a})})),a=Math.min.apply(null,i),isFinite(a)?a:0}},{key:"offsetStartDTS",value:function(t,r,n){e.findBox(r,["moof","traf"]).map(function(r){return e.findBox(r,["tfhd"]).map(function(i){var a=e.readUint32(i,4),s=t[a].timescale||9e4;e.findBox(r,["tfdt"]).map(function(t){var r=t.data[t.start],i=e.readUint32(t,4);if(0===r)e.writeUint32(t,4,i-n*s);else{i*=Math.pow(2,32),i+=e.readUint32(t,8),i-=n*s;var a=Math.floor(i/(o+1)),l=Math.floor(i%(o+1));e.writeUint32(t,4,a),e.writeUint32(t,8,l)}})})})}}]),e}();r.default=s},{30:30}],25:[function(e,t,r){"use strict";var n={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],appendFrame:function(e,t,r,n,i){if(!(r+24>t.length)){var a=this.parseHeader(t,r);if(a&&r+a.frameLength<=t.length){var o=10368e4/a.sampleRate,s=n+i*o,l={unit:t.subarray(r,r+a.frameLength),pts:s,dts:s};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(l),e.len+=a.frameLength,{sample:l,length:a.frameLength}}}},parseHeader:function(e,t){var r=e[t+1]>>3&3,i=e[t+1]>>1&3,a=e[t+2]>>4&15,o=e[t+2]>>2&3,s=!!(2&e[t+2]);if(1!==r&&0!==a&&15!==a&&3!==o){var l=3===r?3-i:3===i?3:4,u=1e3*n.BitratesMap[14*l+a-1],c=3===r?0:2===r?1:2,d=n.SamplingRateMap[3*c+o],f=s?1:0,h=e[t+3]>>6==3?1:2,p=3===i?(3===r?12:6)*u/d+f<<2:(3===r?144:72)*u/d+f|0;return{sampleRate:d,channelCount:h,frameLength:p}}},isHeaderPattern:function(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])},isHeader:function(e,t){return!!(t+1<e.length&&this.isHeaderPattern(e,t))},probe:function(e,t){if(t+1<e.length&&this.isHeaderPattern(e,t)){var r=this.parseHeader(e,t),n=4;r&&r.frameLength&&(n=r.frameLength);var i=t+n;if(i===e.length||i+1<e.length&&this.isHeaderPattern(e,i))return!0}return!1}};t.exports=n},{}],26:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(14),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.decryptdata=n,this.discardEPB=i,this.decrypter=new a.default(t,r)}return n(e,[{key:"decryptBuffer",value:function(e,t){this.decrypter.decrypt(e,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)}},{key:"decryptAacSample",value:function(e,t,r,n){var i=e[t].unit,a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,function(a){a=new Uint8Array(a),i.set(a,16),n||s.decryptAacSamples(e,t+1,r)})}},{key:"decryptAacSamples",value:function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)){var n=this.decrypter.isSync();if(this.decryptAacSample(e,t,r,n),!n)return}}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,i=32;i<=e.length-16;i+=160,n+=16)r.set(e.subarray(i,i+16),n);return r}},{key:"getAvcDecryptedUnit",value:function(e,t){t=new Uint8Array(t);for(var r=0,n=32;n<=e.length-16;n+=160,r+=16)e.set(t.subarray(r,r+16),n);return e}},{key:"decryptAvcSample",value:function(e,t,r,n,i,a){var o=this.discardEPB(i.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,function(s){i.data=l.getAvcDecryptedUnit(o,s),a||l.decryptAvcSamples(e,t,r+1,n)})}},{key:"decryptAvcSamples",value:function(e,t,r,n){for(;;t++,r=0){if(t>=e.length)return void n();for(var i=e[t].units;!(r>=i.length);r++){var a=i[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(e,t,r,n,a,o),!o)return}}}}}]),e}();r.default=o},{14:14}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(17),a=g(i),o=e(25),s=g(o),l=e(30),u=g(l),c=e(21),d=g(c),f=e(26),h=g(f),p=e(46),v=e(28);function g(e){return e&&e.__esModule?e:{default:e}}var y=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=n,this.typeSupported=i,this.remuxer=r,this.sampleAes=null}return n(e,[{key:"setDecryptData",value:function(e){null!=e&&null!=e.key&&"SAMPLE-AES"===e.method?this.sampleAes=new h.default(this.observer,this.config,e,this.discardEPB):this.sampleAes=null}},{key:"resetInitSegment",value:function(e,t,r,n){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack={container:"video/mp2t",type:"video",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:0},this._audioTrack={container:"video/mp2t",type:"audio",id:-1,inputTimeScale:9e4,duration:n,sequenceNumber:0,samples:[],len:0,isAAC:!0},this._id3Track={type:"id3",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this._txtTrack={type:"text",id:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0},this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=t,this.videoCodec=r,this._duration=n}},{key:"resetTimeStamp",value:function(){}},{key:"append",value:function(e,t,r,n){var i,a,o,s,l,c=e.length,d=!1;this.contiguous=r;var f=this.pmtParsed,h=this._avcTrack,g=this._audioTrack,y=this._id3Track,m=h.id,b=g.id,_=y.id,E=this._pmtId,k=h.pesData,w=g.pesData,T=y.pesData,S=this._parsePAT,A=this._parsePMT,R=this._parsePES,x=this._parseAVCPES.bind(this),L=this._parseAACPES.bind(this),O=this._parseMPEGPES.bind(this),D=this._parseID3PES.bind(this);for(c-=c%188,i=0;i<c;i+=188)if(71===e[i]){if(a=!!(64&e[i+1]),o=((31&e[i+1])<<8)+e[i+2],(48&e[i+3])>>4>1){if((s=i+5+e[i+4])===i+188)continue}else s=i+4;switch(o){case m:a&&(k&&(l=R(k))&&x(l,!1),k={data:[],size:0}),k&&(k.data.push(e.subarray(s,i+188)),k.size+=i+188-s);break;case b:a&&(w&&(l=R(w))&&(g.isAAC?L(l):O(l)),w={data:[],size:0}),w&&(w.data.push(e.subarray(s,i+188)),w.size+=i+188-s);break;case _:a&&(T&&(l=R(T))&&D(l),T={data:[],size:0}),T&&(T.data.push(e.subarray(s,i+188)),T.size+=i+188-s);break;case 0:a&&(s+=e[s]+1),E=this._pmtId=S(e,s);break;case E:a&&(s+=e[s]+1);var P=A(e,s,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(m=P.avc)>0&&(h.id=m),(b=P.audio)>0&&(g.id=b,g.isAAC=P.isAAC),(_=P.id3)>0&&(y.id=_),d&&!f&&(p.logger.log("reparse from beginning"),d=!1,i=-188),f=this.pmtParsed=!0;break;case 17:case 8191:break;default:d=!0}}else this.observer.trigger(u.default.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});k&&(l=R(k))?(x(l,!0),h.pesData=null):h.pesData=k,w&&(l=R(w))?(g.isAAC?L(l):O(l),g.pesData=null):(w&&w.size&&p.logger.log("last AAC PES packet truncated,might overlap between fragments"),g.pesData=w),T&&(l=R(T))?(D(l),y.pesData=null):y.pesData=T,null==this.sampleAes?this.remuxer.remux(g,h,y,this._txtTrack,t,r,n):this.decryptAndRemux(g,h,y,this._txtTrack,t,r,n)}},{key:"decryptAndRemux",value:function(e,t,r,n,i,a,o){if(e.samples&&e.isAAC){var s=this;this.sampleAes.decryptAacSamples(e.samples,0,function(){s.decryptAndRemuxAvc(e,t,r,n,i,a,o)})}else this.decryptAndRemuxAvc(e,t,r,n,i,a,o)}},{key:"decryptAndRemuxAvc",value:function(e,t,r,n,i,a,o){if(t.samples){var s=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){s.remuxer.remux(e,t,r,n,i,a,o)})}else this.remuxer.remux(e,t,r,n,i,a,o)}},{key:"destroy",value:function(){this._initPTS=this._initDTS=void 0,this._duration=0}},{key:"_parsePAT",value:function(e,t){return(31&e[t+10])<<8|e[t+11]}},{key:"_parsePMT",value:function(e,t,r,n){var i,a,o,s,l={audio:-1,avc:-1,id3:-1,isAAC:!0};for(i=(15&e[t+1])<<8|e[t+2],a=t+3+i-4,o=(15&e[t+10])<<8|e[t+11],t+=12+o;t<a;){switch(s=(31&e[t+1])<<8|e[t+2],e[t]){case 207:if(!n){p.logger.log("unkown stream type:"+e[t]);break}case 15:-1===l.audio&&(l.audio=s);break;case 21:-1===l.id3&&(l.id3=s);break;case 219:if(!n){p.logger.log("unkown stream type:"+e[t]);break}case 27:-1===l.avc&&(l.avc=s);break;case 3:case 4:r?-1===l.audio&&(l.audio=s,l.isAAC=!1):p.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:p.logger.warn("HEVC stream type found, not supported for now");break;default:p.logger.log("unkown stream type:"+e[t])}t+=5+((15&e[t+3])<<8|e[t+4])}return l}},{key:"_parsePES",value:function(e){var t,r,n,i,a,o,s,l,u=0,c=e.data;if(!e||0===e.size)return null;for(;c[0].length<19&&c.length>1;){var d=new Uint8Array(c[0].length+c[1].length);d.set(c[0]),d.set(c[1],c[0].length),c[0]=d,c.splice(1,1)}if(1===((t=c[0])[0]<<16)+(t[1]<<8)+t[2]){if((n=(t[4]<<8)+t[5])&&n>e.size-6)return null;192&(r=t[7])&&((o=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(o-=8589934592),64&r?((s=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(s-=8589934592),o-s>54e5&&(p.logger.warn(Math.round((o-s)/9e4)+"s delta between PTS and DTS, align them"),o=s)):s=o),i=t[8],l=i+9,e.size-=l,a=new Uint8Array(e.size);for(var f=0,h=c.length;f<h;f++){var v=(t=c[f]).byteLength;if(l){if(l>v){l-=v;continue}t=t.subarray(l),v-=l,l=0}a.set(t,u),u+=v}return n&&(n-=i+3),{data:a,pts:o,dts:s,len:n}}return null}},{key:"pushAccesUnit",value:function(e,t){if(e.units.length&&e.frame){var r=t.samples,n=r.length;!this.config.forceKeyFrameOnDiscontinuity||!0===e.key||t.sps&&(n||this.contiguous)?(e.id=n,r.push(e)):t.dropped++}e.debug.length&&p.logger.log(e.pts+"/"+e.dts+":"+e.debug)}},{key:"_parseAVCPES",value:function(e,t){var r,n,i,a=this,o=this._avcTrack,s=this._parseAVCNALu(e.data),l=this.avcSample,u=!1,c=this.pushAccesUnit.bind(this),f=function(e,t,r,n){return{key:e,pts:t,dts:r,units:[],debug:n}};e.data=null,l&&s.length&&(c(l,o),l=this.avcSample=f(!1,e.pts,e.dts,"")),s.forEach(function(t){switch(t.type){case 1:n=!0,l.frame=!0;var s=t.data;if(u&&s.length>4){var h=new d.default(s).readSliceType();2!==h&&4!==h&&7!==h&&9!==h||(l.key=!0)}break;case 5:n=!0,l||(l=a.avcSample=f(!0,e.pts,e.dts,"")),l.key=!0,l.frame=!0;break;case 6:n=!0,(r=new d.default(a.discardEPB(t.data))).readUByte();for(var p=0,v=0,g=!1,y=0;!g&&r.bytesAvailable>1;){p=0;do{y=r.readUByte(),p+=y}while(255===y);v=0;do{y=r.readUByte(),v+=y}while(255===y);if(4===p&&0!==r.bytesAvailable){g=!0;var m=r.readUByte();if(181===m){var b=r.readUShort();if(49===b){var _=r.readUInt();if(1195456820===_){var E=r.readUByte();if(3===E){var k=r.readUByte(),w=r.readUByte(),T=31&k,S=[k,w];for(i=0;i<T;i++)S.push(r.readUByte()),S.push(r.readUByte()),S.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:e.pts,bytes:S})}}}}}else if(v<r.bytesAvailable)for(i=0;i<v;i++)r.readUByte()}break;case 7:if(n=!0,u=!0,!o.sps){var A=(r=new d.default(t.data)).readSPS();o.width=A.width,o.height=A.height,o.pixelRatio=A.pixelRatio,o.sps=[t.data],o.duration=a._duration;var R=t.data.subarray(1,4),x="avc1.";for(i=0;i<3;i++){var L=R[i].toString(16);L.length<2&&(L="0"+L),x+=L}o.codec=x}break;case 8:n=!0,o.pps||(o.pps=[t.data]);break;case 9:n=!1,l&&c(l,o),l=a.avcSample=f(!1,e.pts,e.dts,"");break;case 12:n=!1;break;default:n=!1,l&&(l.debug+="unknown NAL "+t.type+" ")}if(l&&n){var O=l.units;O.push(t)}}),t&&l&&(c(l,o),this.avcSample=null)}},{key:"_insertSampleInOrder",value:function(e,t){var r=e.length;if(r>0){if(t.pts>=e[r-1].pts)e.push(t);else for(var n=r-1;n>=0;n--)if(t.pts<e[n].pts){e.splice(n,0,t);break}}else e.push(t)}},{key:"_getLastNalUnit",value:function(){var e=this.avcSample,t=void 0;if(!e||0===e.units.length){var r=this._avcTrack,n=r.samples;e=n[n.length-1]}if(e){var i=e.units;t=i[i.length-1]}return t}},{key:"_parseAVCNALu",value:function(e){var t,r,n,i,a,o=0,s=e.byteLength,l=this._avcTrack,u=l.naluState||0,c=u,d=[],f=-1;for(-1===u&&(f=0,a=31&e[0],u=0,o=1);o<s;)if(t=e[o++],u)if(1!==u)if(t)if(1===t){if(f>=0)n={data:e.subarray(f,o-u-1),type:a},d.push(n);else{var h=this._getLastNalUnit();if(h&&(c&&o<=4-c&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-c)),(r=o-u-1)>0)){var p=new Uint8Array(h.data.byteLength+r);p.set(h.data,0),p.set(e.subarray(0,r),h.data.byteLength),h.data=p}}o<s?(i=31&e[o],f=o,a=i,u=0):u=-1}else u=0;else u=3;else u=t?0:2;else u=t?0:1;if(f>=0&&u>=0&&(n={data:e.subarray(f,s),type:a,state:u},d.push(n)),0===d.length){var v=this._getLastNalUnit();if(v){var g=new Uint8Array(v.data.byteLength+e.byteLength);g.set(v.data,0),g.set(e,v.data.byteLength),v.data=g}}return l.naluState=u,d}},{key:"discardEPB",value:function(e){for(var t,r,n=e.byteLength,i=[],a=1;a<n-2;)0===e[a]&&0===e[a+1]&&3===e[a+2]?(i.push(a+2),a+=2):a++;if(0===i.length)return e;t=n-i.length,r=new Uint8Array(t);var o=0;for(a=0;a<t;o++,a++)o===i[0]&&(o++,i.shift()),r[a]=e[o];return r}},{key:"_parseAACPES",value:function(e){var t,r,n,i,o,s,l,c=this._audioTrack,d=e.data,f=e.pts,h=this.aacOverFlow,g=this.aacLastPTS;if(h){var y=new Uint8Array(h.byteLength+d.byteLength);y.set(h,0),y.set(d,h.byteLength),d=y}for(n=0,o=d.length;n<o-1&&!a.default.isHeader(d,n);n++);if(!n||(n<o-1?(s="AAC PES did not start with ADTS header,offset:"+n,l=!1):(s="no ADTS header found in AAC PES",l=!0),p.logger.warn("parsing error:"+s),this.observer.trigger(u.default.ERROR,{type:v.ErrorTypes.MEDIA_ERROR,details:v.ErrorDetails.FRAG_PARSING_ERROR,fatal:l,reason:s}),!l)){if(a.default.initTrackConfig(c,this.observer,d,n,this.audioCodec),r=0,t=a.default.getFrameDuration(c.samplerate),h&&g){var m=g+t;Math.abs(m-f)>1&&(p.logger.log("AAC: align PTS for overlapping frames by "+Math.round((m-f)/90)),f=m)}for(;n<o;)if(a.default.isHeader(d,n)&&n+5<o){var b=a.default.appendFrame(c,d,n,f,r);if(!b)break;n+=b.length,i=b.sample.pts,r++}else n++;h=n<o?d.subarray(n,o):null,this.aacOverFlow=h,this.aacLastPTS=i}}},{key:"_parseMPEGPES",value:function(e){for(var t=e.data,r=t.length,n=0,i=0,a=e.pts;i<r;)if(s.default.isHeader(t,i)){var o=s.default.appendFrame(this._audioTrack,t,i,a,n);if(!o)break;i+=o.length,n++}else i++}},{key:"_parseID3PES",value:function(e){this._id3Track.samples.push(e)}}],[{key:"probe",value:function(e){return e.length>=564&&71===e[0]&&71===e[188]&&71===e[376]}}]),e}();r.default=y},{17:17,21:21,25:25,26:26,28:28,30:30,46:46}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"},r.ErrorDetails={MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOOP_LOADING_ERROR:"fragLoopLoadingError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException",WEBVTT_EXCEPTION:"webVTTException"}},{}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e(46),o=e(28),s=e(30),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.onEvent=this.onEvent.bind(this);for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.handledEvents=n,this.useGenericHandler=!0,this.registerListeners()}return i(e,[{key:"destroy",value:function(){this.unregisterListeners()}},{key:"isEventHandler",value:function(){return"object"===n(this.handledEvents)&&this.handledEvents.length&&"function"==typeof this.onEvent}},{key:"registerListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){if("hlsEventGeneric"===e)throw new Error("Forbidden event name: "+e);this.hls.on(e,this.onEvent)},this)}},{key:"unregisterListeners",value:function(){this.isEventHandler()&&this.handledEvents.forEach(function(e){this.hls.off(e,this.onEvent)},this)}},{key:"onEvent",value:function(e,t){this.onEventGeneric(e,t)}},{key:"onEventGeneric",value:function(e,t){try{(function(e,t){var r="on"+e.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+e+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,t)}).call(this,e,t).call()}catch(t){a.logger.error("internal error happened while processing "+e+":"+t.message),this.hls.trigger(l.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:e,err:t})}}}]),e}();r.default=u},{28:28,30:30,46:46}],30:[function(e,t,r){"use strict";t.exports={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCH:"hlsLevelSwitch",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCH:"hlsAudioTrackSwitch",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},{}],31:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null}}]),e}();r.default=i},{}],32:[function(e,t,r){"use strict";var n={isBuffered:function(e,t){if(e)for(var r=e.buffered,n=0;n<r.length;n++)if(t>=r.start(n)&&t<=r.end(n))return!0;return!1},bufferInfo:function(e,t,r){if(e){var n,i=e.buffered,a=[];for(n=0;n<i.length;n++)a.push({start:i.start(n),end:i.end(n)});return this.bufferedInfo(a,t,r)}return{len:0,start:t,end:t,nextStart:void 0}},bufferedInfo:function(e,t,r){var n,i,a,o,s,l=[];for(e.sort(function(e,t){var r=e.start-t.start;return r||t.end-e.end}),s=0;s<e.length;s++){var u=l.length;if(u){var c=l[u-1].end;e[s].start-c<r?e[s].end>c&&(l[u-1].end=e[s].end):l.push(e[s])}else l.push(e[s])}for(s=0,n=0,i=a=t;s<l.length;s++){var d=l[s].start,f=l[s].end;if(t+r>=d&&t<f)i=d,n=(a=f)-t;else if(t+r<d){o=d;break}}return{len:n,start:i,end:a,nextStart:o}}};t.exports=n},{}],33:[function(e,t,r){"use strict";var n=e(46),i={mergeDetails:function(e,t){var r,a=Math.max(e.startSN,t.startSN)-t.startSN,o=Math.min(e.endSN,t.endSN)-t.startSN,s=t.startSN-e.startSN,l=e.fragments,u=t.fragments,c=0;if(o<a)t.PTSKnown=!1;else{for(var d=a;d<=o;d++){var f=l[s+d],h=u[d];h&&f&&(c=f.cc-h.cc,isNaN(f.startPTS)||(h.start=h.startPTS=f.startPTS,h.endPTS=f.endPTS,h.duration=f.duration,h.backtracked=f.backtracked,h.dropped=f.dropped,r=h))}if(c)for(n.logger.log("discontinuity sliding from playlist, take drift into account"),d=0;d<u.length;d++)u[d].cc+=c;if(r)i.updateFragPTSDTS(t,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS);else if(s>=0&&s<l.length){var p=l[s].start;for(d=0;d<u.length;d++)u[d].start+=p}t.PTSKnown=e.PTSKnown}},updateFragPTSDTS:function(e,t,r,n,a,o){var s=r;if(!isNaN(t.startPTS)){var l=Math.abs(t.startPTS-r);isNaN(t.deltaPTS)?t.deltaPTS=l:t.deltaPTS=Math.max(l,t.deltaPTS),s=Math.max(r,t.startPTS),r=Math.min(r,t.startPTS),n=Math.max(n,t.endPTS),a=Math.min(a,t.startDTS),o=Math.max(o,t.endDTS)}var u=r-t.start;t.start=t.startPTS=r,t.maxStartPTS=s,t.endPTS=n,t.startDTS=a,t.endDTS=o,t.duration=n-r;var c,d,f,h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;for(c=h-e.startSN,(d=e.fragments)[c]=t,f=c;f>0;f--)i.updatePTS(d,f,f-1);for(f=c;f<d.length-1;f++)i.updatePTS(d,f,f+1);return e.PTSKnown=!0,u},updatePTS:function(e,t,r){var i=e[t],a=e[r],o=a.startPTS;isNaN(o)?a.start=r>t?i.start+i.duration:Math.max(i.start-a.duration,0):r>t?(i.duration=o-i.start,i.duration<0&&n.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(a.duration=i.start-o,a.duration<0&&n.logger.warn("negative duration computed for frag "+a.sn+",level "+a.level+", there should be some duration drift between playlist and fragment!"))}};t.exports=i},{46:46}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(2),a=S(i),o=e(30),s=S(o),l=e(28),u=e(38),c=S(u),d=e(36),f=S(d),h=e(37),p=S(h),v=e(11),g=S(v),y=e(10),m=S(y),b=e(9),_=S(b),E=e(46),k=e(1),w=S(k),T=e(4);function S(e){return e&&e.__esModule?e:{default:e}}var A=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=e.DefaultConfig;if((r.liveSyncDurationCount||r.liveMaxLatencyDurationCount)&&(r.liveSyncDuration||r.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(var i in n)i in r||(r[i]=n[i]);if(void 0!==r.liveMaxLatencyDurationCount&&r.liveMaxLatencyDurationCount<=r.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==r.liveMaxLatencyDuration&&(r.liveMaxLatencyDuration<=r.liveSyncDuration||void 0===r.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');(0,E.enableLogs)(r.debug),this.config=r,this._autoLevelCapping=-1;var a=this.observer=new w.default;a.trigger=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.emit.apply(a,[e,e].concat(r))},a.off=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.removeListener.apply(a,[e].concat(r))},this.on=a.on.bind(a),this.off=a.off.bind(a),this.trigger=a.trigger.bind(a);var o=this.abrController=new r.abrController(this),s=new r.bufferController(this),l=new r.capLevelController(this),u=new r.fpsController(this),d=new c.default(this),h=new f.default(this),v=new p.default(this),y=new _.default(this),b=this.levelController=new m.default(this),k=this.streamController=new g.default(this),T=[b,k],S=r.audioStreamController;S&&T.push(new S(this)),this.networkControllers=T;var A=[d,h,v,o,s,l,u,y];if(S=r.audioTrackController){var R=new S(this);this.audioTrackController=R,A.push(R)}if(S=r.subtitleTrackController){var x=new S(this);this.subtitleTrackController=x,A.push(x)}[r.subtitleStreamController,r.timelineController].forEach(function(e){e&&A.push(new e(t))}),this.coreComponents=A}return n(e,null,[{key:"isSupported",value:function(){var e=window.MediaSource=window.MediaSource||window.WebKitMediaSource,t=window.SourceBuffer=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return r&&n}},{key:"version",get:function(){return"0.7.11"}},{key:"Events",get:function(){return s.default}},{key:"ErrorTypes",get:function(){return l.ErrorTypes}},{key:"ErrorDetails",get:function(){return l.ErrorDetails}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:T.hlsDefaultConfig},set:function(t){e.defaultConfig=t}}]),n(e,[{key:"destroy",value:function(){E.logger.log("destroy"),this.trigger(s.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(e){e.destroy()}),this.url=null,this.observer.removeAllListeners(),this._autoLevelCapping=-1}},{key:"attachMedia",value:function(e){E.logger.log("attachMedia"),this.media=e,this.trigger(s.default.MEDIA_ATTACHING,{media:e})}},{key:"detachMedia",value:function(){E.logger.log("detachMedia"),this.trigger(s.default.MEDIA_DETACHING),this.media=null}},{key:"loadSource",value:function(e){e=a.default.buildAbsoluteURL(window.location.href,e,{alwaysNormalize:!0}),E.logger.log("loadSource:"+e),this.url=e,this.trigger(s.default.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;E.logger.log("startLoad("+e+")"),this.networkControllers.forEach(function(t){t.startLoad(e)})}},{key:"stopLoad",value:function(){E.logger.log("stopLoad"),this.networkControllers.forEach(function(e){e.stopLoad()})}},{key:"swapAudioCodec",value:function(){E.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){E.logger.log("recoverMediaError");var e=this.media;this.detachMedia(),this.attachMedia(e)}},{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){E.logger.log("set currentLevel:"+e),this.loadLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){E.logger.log("set nextLevel:"+e),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){E.logger.log("set loadLevel:"+e),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){E.logger.log("set firstLevel:"+e),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(e){E.logger.log("set startLevel:"+e),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){E.logger.log("set autoLevelCapping:"+e),this._autoLevelCapping=e}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var e=this.levels,t=this.config.minAutoBitrate,r=e?e.length:0,n=0;n<r;n++){var i=e[n].realBitrate?Math.max(e[n].realBitrate,e[n].bitrate):e[n].bitrate;if(i>t)return n}return 0}},{key:"maxAutoLevel",get:function(){var e=this.levels,t=this.autoLevelCapping;return-1===t&&e&&e.length?e.length-1:t}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}}]),e}();r.default=A},{1:1,10:10,11:11,2:2,28:28,30:30,36:36,37:37,38:38,4:4,46:46,9:9}],35:[function(e,t,r){"use strict";t.exports=e(34).default},{34:34}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=c(i),o=e(29),s=c(o),l=e(28),u=e(46);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.FRAG_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){var e=this.loaders;for(var t in e){var r=e[t];r&&r.destroy()}this.loaders={},s.default.prototype.destroy.call(this)}},{key:"onFragLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=this.hls.config;t.loaded=0,n&&(u.logger.warn("abort previous fragment loader for type:"+r),n.abort()),n=this.loaders[r]=t.loader=void 0!==i.fLoader?new i.fLoader(i):new i.loader(i);var a=void 0,o=void 0,s=void 0;a={url:t.url,frag:t,responseType:"arraybuffer",progressData:!1};var l=t.byteRangeStartOffset,c=t.byteRangeEndOffset;isNaN(l)||isNaN(c)||(a.rangeStart=l,a.rangeEnd=c),o={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout},s={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},n.load(a,o,s)}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,o=r.frag;o.loader=void 0,this.loaders[o.type]=void 0,this.hls.trigger(a.default.FRAG_LOADED,{payload:i,frag:o,stats:t,networkDetails:n})}},{key:"loaderror",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:e,networkDetails:r})}},{key:"loadtimeout",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:r})}},{key:"loadprogress",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.frag;i.loaded=e.loaded,this.hls.trigger(a.default.FRAG_LOAD_PROGRESS,{frag:i,stats:e,networkDetails:n})}}]),t}(s.default);r.default=d},{28:28,29:29,30:30,46:46}],37:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=c(i),o=e(29),s=c(o),l=e(28),u=e(46);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,a.default.KEY_LOADING));return r.loaders={},r.decryptkey=null,r.decrypturl=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},s.default.prototype.destroy.call(this)}},{key:"onKeyLoading",value:function(e){var t=e.frag,r=t.type,n=this.loaders[r],i=t.decryptdata,o=i.uri;if(o!==this.decrypturl||null===this.decryptkey){var s=this.hls.config;n&&(u.logger.warn("abort previous key loader for type:"+r),n.abort()),t.loader=this.loaders[r]=new s.loader(s),this.decrypturl=o,this.decryptkey=null;var l=void 0,c=void 0,d=void 0;l={url:o,frag:t,responseType:"arraybuffer"},c={timeout:s.fragLoadingTimeOut,maxRetry:s.fragLoadingMaxRetry,retryDelay:s.fragLoadingRetryDelay,maxRetryDelay:s.fragLoadingMaxRetryTimeout},d={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(l,c,d)}else this.decryptkey&&(i.key=this.decryptkey,this.hls.trigger(a.default.KEY_LOADED,{frag:t}))}},{key:"loadsuccess",value:function(e,t,r){var n=r.frag;this.decryptkey=n.decryptdata.key=new Uint8Array(e.data),n.loader=void 0,this.loaders[n.type]=void 0,this.hls.trigger(a.default.KEY_LOADED,{frag:n})}},{key:"loaderror",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:e})}},{key:"loadtimeout",value:function(e,t){var r=t.frag,n=r.loader;n&&n.abort(),this.loaders[t.type]=void 0,this.hls.trigger(a.default.ERROR,{type:l.ErrorTypes.NETWORK_ERROR,details:l.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})}}]),t}(s.default);r.default=d},{28:28,29:29,30:30,46:46}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(2),a=p(i),o=e(30),s=p(o),l=e(29),u=p(l),c=e(28),d=e(42),f=p(d),h=e(46);function p(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var g=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,y=/#EXT-X-MEDIA:(.*)/g,m=new RegExp([/#EXTINF:(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)(\S+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),b=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)(.*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,_=function(){function e(){v(this,e),this.method=null,this.key=null,this.iv=null,this._uri=null}return n(e,[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=a.default.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}]),e}(),E=function(){function e(){v(this,e),this._url=null,this._byteRange=null,this._decryptdata=null,this.tagList=[]}return n(e,[{key:"createInitializationVector",value:function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}},{key:"fragmentDecryptdataFromLevelkey",value:function(e,t){var r=e;return e&&e.method&&e.uri&&!e.iv&&((r=new _).method=e.method,r.baseuri=e.baseuri,r.reluri=e.reluri,r.iv=this.createInitializationVector(t)),r}},{key:"cloneObj",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=a.default.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(e){this._url=e}},{key:"programDateTime",get:function(){return!this._programDateTime&&this.rawProgramDateTime&&(this._programDateTime=new Date(Date.parse(this.rawProgramDateTime))),this._programDateTime}},{key:"byteRange",get:function(){if(!this._byteRange){var e=this._byteRange=[];if(this.rawByteRange){var t=this.rawByteRange.split("@",2);if(1===t.length){var r=this.lastByteRangeEndOffset;e[0]=r||0}else e[0]=parseInt(t[1]);e[1]=parseInt(t[0])+e[0]}}return this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata}}]),e}(),k=function(e){function t(e){v(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,s.default.MANIFEST_LOADING,s.default.LEVEL_LOADING,s.default.AUDIO_TRACK_LOADING,s.default.SUBTITLE_TRACK_LOADING));return r.loaders={},r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"destroy",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy()}this.loaders={},u.default.prototype.destroy.call(this)}},{key:"onManifestLoading",value:function(e){this.load(e.url,{type:"manifest"})}},{key:"onLevelLoading",value:function(e){this.load(e.url,{type:"level",level:e.level,id:e.id})}},{key:"onAudioTrackLoading",value:function(e){this.load(e.url,{type:"audioTrack",id:e.id})}},{key:"onSubtitleTrackLoading",value:function(e){this.load(e.url,{type:"subtitleTrack",id:e.id})}},{key:"load",value:function(e,t){var r=this.loaders[t.type];if(r){var n=r.context;if(n&&n.url===e)return void h.logger.trace("playlist request ongoing");h.logger.warn("abort previous loader for type:"+t.type),r.abort()}var i=this.hls.config,a=void 0,o=void 0,s=void 0,l=void 0;"manifest"===t.type?(a=i.manifestLoadingMaxRetry,o=i.manifestLoadingTimeOut,s=i.manifestLoadingRetryDelay,l=i.manifestLoadingMaxRetryTimeout):(a=i.levelLoadingMaxRetry,o=i.levelLoadingTimeOut,s=i.levelLoadingRetryDelay,l=i.levelLoadingMaxRetryTimeout,h.logger.log("loading playlist for "+t.type+" "+(t.level||t.id))),r=this.loaders[t.type]=t.loader=void 0!==i.pLoader?new i.pLoader(i):new i.loader(i),t.url=e,t.responseType="";var u=void 0,c=void 0;u={timeout:o,maxRetry:a,retryDelay:s,maxRetryDelay:l},c={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},r.load(t,u,c)}},{key:"resolve",value:function(e,t){return a.default.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"parseMasterPlaylist",value:function(e,t){var r=[],n=void 0;for(g.lastIndex=0;null!=(n=g.exec(e));){var i={},a=i.attrs=new f.default(n[1]);i.url=this.resolve(n[2],t);var o=a.decimalResolution("RESOLUTION");o&&(i.width=o.width,i.height=o.height),i.bitrate=a.decimalInteger("AVERAGE-BANDWIDTH")||a.decimalInteger("BANDWIDTH"),i.name=a.NAME;var s=a.CODECS;if(s){s=s.split(/[ ,]+/);for(var l=0;l<s.length;l++){var u=s[l];-1!==u.indexOf("avc1")?i.videoCodec=this.avc1toavcoti(u):-1!==u.indexOf("hvc1")?i.videoCodec=u:i.audioCodec=u}}r.push(i)}return r}},{key:"parseMasterPlaylistMedia",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=void 0,a=[],o=0;for(y.lastIndex=0;null!=(i=y.exec(e));){var s={},l=new f.default(i[1]);l.TYPE===r&&(s.groupId=l["GROUP-ID"],s.name=l.NAME,s.type=r,s.default="YES"===l.DEFAULT,s.autoselect="YES"===l.AUTOSELECT,s.forced="YES"===l.FORCED,l.URI&&(s.url=this.resolve(l.URI,t)),s.lang=l.LANGUAGE,s.name||(s.name=s.lang),n&&(s.audioCodec=n),s.id=o++,a.push(s))}return a}},{key:"avc1toavcoti",value:function(e){var t,r=e.split(".");return r.length>2?(t=r.shift()+".",t+=parseInt(r.shift()).toString(16),t+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):t=e,t}},{key:"parseLevelPlaylist",value:function(e,t,r,n){var i,a,o=0,s=0,l={type:null,version:null,url:t,fragments:[],live:!0,startSN:0},u=new _,c=0,d=null,p=new E;for(m.lastIndex=0;null!==(i=m.exec(e));){var v=i[1];if(v){p.duration=parseFloat(v);var g=(" "+i[2]).slice(1);p.title=g||null,p.tagList.push(g?["INF",v,g]:["INF",v])}else if(i[3]){if(!isNaN(p.duration)){var y=o++;p.type=n,p.start=s,p.levelkey=u,p.sn=y,p.level=r,p.cc=c,p.baseurl=t,p.relurl=(" "+i[3]).slice(1),l.fragments.push(p),d=p,s+=p.duration,p=new E}}else if(i[4]){if(p.rawByteRange=(" "+i[4]).slice(1),d){var k=d.byteRangeEndOffset;k&&(p.lastByteRangeEndOffset=k)}}else if(i[5])p.rawProgramDateTime=(" "+i[5]).slice(1),p.tagList.push(["PROGRAM-DATE-TIME",p.rawProgramDateTime]);else{for(i=i[0].match(b),a=1;a<i.length&&void 0===i[a];a++);var w=(" "+i[a+1]).slice(1),T=(" "+i[a+2]).slice(1);switch(i[a]){case"#":p.tagList.push(T?[w,T]:[w]);break;case"PLAYLIST-TYPE":l.type=w.toUpperCase();break;case"MEDIA-SEQUENCE":o=l.startSN=parseInt(w);break;case"TARGETDURATION":l.targetduration=parseFloat(w);break;case"VERSION":l.version=parseInt(w);break;case"EXTM3U":break;case"ENDLIST":l.live=!1;break;case"DIS":c++,p.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":c=parseInt(w);break;case"KEY":var S=w,A=new f.default(S),R=A.enumeratedString("METHOD"),x=A.URI,L=A.hexadecimalInteger("IV");R&&(u=new _,x&&["AES-128","SAMPLE-AES"].indexOf(R)>=0&&(u.method=R,u.baseuri=t,u.reluri=x,u.key=null,u.iv=L));break;case"START":var O=w,D=new f.default(O),P=D.decimalFloatingPoint("TIME-OFFSET");isNaN(P)||(l.startTimeOffset=P);break;case"MAP":var I=new f.default(w);p.relurl=I.URI,p.rawByteRange=I.BYTERANGE,p.baseurl=t,p.level=r,p.type=n,p.sn="initSegment",l.initSegment=p,p=new E;break;default:h.logger.warn("line parsed but not handled: "+i)}}}return(p=d)&&!p.relurl&&(l.fragments.pop(),s-=p.duration),l.totalduration=s,l.averagetargetduration=s/l.fragments.length,l.endSN=o-1,l}},{key:"loadsuccess",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.data,a=e.url,o=r.type,l=r.id,u=r.level,d=this.hls;if(this.loaders[o]=void 0,void 0!==a&&0!==a.indexOf("data:")||(a=r.url),t.tload=performance.now(),0===i.indexOf("#EXTM3U"))if(i.indexOf("#EXTINF:")>0){var f="audioTrack"!==o&&"subtitleTrack"!==o,p=isNaN(u)?isNaN(l)?0:l:u,v=this.parseLevelPlaylist(i,a,p,"audioTrack"===o?"audio":"subtitleTrack"===o?"subtitle":"main");v.tload=t.tload,"manifest"===o&&d.trigger(s.default.MANIFEST_LOADED,{levels:[{url:a,details:v}],audioTracks:[],url:a,stats:t,networkDetails:n}),t.tparsed=performance.now(),v.targetduration?f?d.trigger(s.default.LEVEL_LOADED,{details:v,level:u||0,id:l||0,stats:t,networkDetails:n}):"audioTrack"===o?d.trigger(s.default.AUDIO_TRACK_LOADED,{details:v,id:l,stats:t,networkDetails:n}):"subtitleTrack"===o&&d.trigger(s.default.SUBTITLE_TRACK_LOADED,{details:v,id:l,stats:t,networkDetails:n}):d.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a,reason:"invalid targetduration",networkDetails:n})}else{var g=this.parseMasterPlaylist(i,a);if(g.length){var y=this.parseMasterPlaylistMedia(i,a,"AUDIO",g[0].audioCodec),m=this.parseMasterPlaylistMedia(i,a,"SUBTITLES");if(y.length){var b=!1;y.forEach(function(e){e.url||(b=!0)}),!1===b&&g[0].audioCodec&&!g[0].attrs.AUDIO&&(h.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main"}))}d.trigger(s.default.MANIFEST_LOADED,{levels:g,audioTracks:y,subtitles:m,url:a,stats:t,networkDetails:n})}else d.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a,reason:"no level found in manifest",networkDetails:n})}else d.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:a,reason:"no EXTM3U delimiter",networkDetails:n})}},{key:"loaderror",value:function(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.loader;switch(t.type){case"manifest":r=c.ErrorDetails.MANIFEST_LOAD_ERROR,n=!0;break;case"level":r=c.ErrorDetails.LEVEL_LOAD_ERROR,n=!1;break;case"audioTrack":r=c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,n=!1}a&&(a.abort(),this.loaders[t.type]=void 0),this.hls.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:a.url,loader:a,response:e,context:t,networkDetails:i})}},{key:"loadtimeout",value:function(e,t){var r,n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=t.loader;switch(t.type){case"manifest":r=c.ErrorDetails.MANIFEST_LOAD_TIMEOUT,n=!0;break;case"level":r=c.ErrorDetails.LEVEL_LOAD_TIMEOUT,n=!1;break;case"audioTrack":r=c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT,n=!1}a&&(a.abort(),this.loaders[t.type]=void 0),this.hls.trigger(s.default.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:r,fatal:n,url:a.url,loader:a,context:t,networkDetails:i})}}]),t}(u.default);r.default=k},{2:2,28:28,29:29,30:30,42:42,46:46}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=Math.pow(2,32)-1,a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return n(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t,r=Array.prototype.slice.call(arguments,1),n=8,i=r.length,a=i;i--;)n+=r[i].byteLength;for((t=new Uint8Array(n))[0]=n>>24&255,t[1]=n>>16&255,t[2]=n>>8&255,t[3]=255&n,t.set(e,4),i=0,n=8;i<a;i++)t.set(r[i],n),n+=r[i].byteLength;return t}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){r*=t;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale,t.duration),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))}},{key:"moov",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale,t[0].duration)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,r){r*=t;var n=Math.floor(r/(i+1)),a=Math.floor(r%(i+1)),o=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,o)}},{key:"sdtp",value:function(t){var r,n,i=t.samples||[],a=new Uint8Array(4+i.length);for(n=0;n<i.length;n++)r=i[n].flags,a[n+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,n,i,a=[],o=[];for(r=0;r<t.sps.length;r++)n=t.sps[r],i=n.byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)n=t.pps[r],i=n.byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],d=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,d>>24,d>>16&255,d>>8&255,255&d])))}},{key:"esds",value:function(e){var t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}},{key:"mp4a",value:function(t){var r=t.samplerate;return e.box(e.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){var r=t.samplerate;return e.box(e.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))}},{key:"stsd",value:function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?e.box(e.types.stsd,e.STSD,e.mp4a(t)):e.box(e.types.stsd,e.STSD,e.mp3(t)):e.box(e.types.stsd,e.STSD,e.avc1(t))}},{key:"tkhd",value:function(t){var r=t.id,n=t.duration*t.timescale,a=t.width,o=t.height,s=Math.floor(n/(i+1)),l=Math.floor(n%(i+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,a>>8&255,255&a,0,0,o>>8&255,255&o,0,0]))}},{key:"traf",value:function(t,r){var n=e.sdtp(t),a=t.id,o=Math.floor(r/(i+1)),s=Math.floor(r%(i+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])),e.trun(t,n.length+16+20+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var n,i,a,o,s,l,u=t.samples||[],c=u.length,d=12+16*c,f=new Uint8Array(d);for(r+=8+d,f.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)i=u[n],a=i.duration,o=i.size,s=i.flags,l=i.cts,f.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,f)}},{key:"initSegment",value:function(t){e.types||e.init();var r,n=e.moov(t);return(r=new Uint8Array(e.FTYP.byteLength+n.byteLength)).set(e.FTYP),r.set(n,e.FTYP.byteLength),r}}]),e}();r.default=a},{}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(31),a=f(i),o=e(30),s=f(o),l=e(46),u=e(39),c=f(u),d=e(28);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t,this.config=r,this.typeSupported=n;var a=navigator.userAgent;this.isSafari=i&&i.indexOf("Apple")>-1&&a&&!a.match("CriOS"),this.ISGenerated=!1}return n(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this._initPTS=this._initDTS=e}},{key:"resetInitSegment",value:function(){this.ISGenerated=!1}},{key:"remux",value:function(e,t,r,n,i,a,o){if(this.ISGenerated){if(o){var u=this._initPTS,c=this._PTSNormalize,d=e.inputTimeScale||t.inputTimeScale,f=1/0,h=1/0,p=e.samples;if(p.length&&(f=h=c(p[0].pts-d*i,u)),(p=t.samples).length){var v=p[0];f=Math.min(f,c(v.pts-d*i,u)),h=Math.min(h,c(v.dts-d*i,u))}if(f!==1/0){var g=u-f;Math.abs(g)>10*d&&(l.logger.warn("timestamp inconsistency, "+(g/d).toFixed(3)+"s delta against expected value: missing discontinuity ? reset initPTS/initDTS"),this._initPTS=f,this._initDTS=h,this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:f}))}}}else this.generateIS(e,t,i);if(this.ISGenerated)if(e.samples.length){e.timescale||(l.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(e,t,i));var y=this.remuxAudio(e,i,a,o);if(t.samples.length){var m=void 0;y&&(m=y.endPTS-y.startPTS),t.timescale||(l.logger.warn("regenerate InitSegment as video detected"),this.generateIS(e,t,i)),this.remuxVideo(t,i,a,m,o)}}else{var b=void 0;t.samples.length&&(b=this.remuxVideo(t,i,a,o)),b&&e.codec&&this.remuxEmptyAudio(e,i,a,b)}r.samples.length&&this.remuxID3(r,i),n.samples.length&&this.remuxText(n,i),this.observer.trigger(s.default.FRAG_PARSED)}},{key:"generateIS",value:function(e,t,r){var n,i,a=this.observer,o=e.samples,u=t.samples,f=this.typeSupported,h="audio/mp4",p={},v={tracks:p},g=void 0===this._initPTS;if(g&&(n=i=1/0),e.config&&o.length&&(e.timescale=e.samplerate,l.logger.log("audio sampling rate : "+e.samplerate),e.isAAC||(f.mpeg?(h="audio/mpeg",e.codec=""):f.mp3&&(e.codec="mp3")),p.audio={container:h,codec:e.codec,initSegment:!e.isAAC&&f.mpeg?new Uint8Array:c.default.initSegment([e]),metadata:{channelCount:e.channelCount}},g&&(n=i=o[0].pts-e.inputTimeScale*r)),t.sps&&t.pps&&u.length){var y=t.inputTimeScale;t.timescale=y,p.video={container:"video/mp4",codec:t.codec,initSegment:c.default.initSegment([t]),metadata:{width:t.width,height:t.height}},g&&(n=Math.min(n,u[0].pts-y*r),i=Math.min(i,u[0].dts-y*r),this.observer.trigger(s.default.INIT_PTS_FOUND,{initPTS:n}))}Object.keys(p).length?(a.trigger(s.default.FRAG_PARSING_INIT_SEGMENT,v),this.ISGenerated=!0,g&&(this._initPTS=n,this._initDTS=i)):a.trigger(s.default.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})}},{key:"remuxVideo",value:function(e,t,r,n,i){var a,o,u,f,h,p,v,g=8,y=e.timescale,m=e.samples,b=[],_=m.length,E=this._PTSNormalize,k=this._initDTS,w=this.nextAvcDts,T=this.isSafari;T&&(r|=m.length&&w&&(i&&Math.abs(t-w/y)<.1||Math.abs(m[0].pts-w-k)<y/5)),r||(w=t*y),m.forEach(function(e){e.pts=E(e.pts-k,w),e.dts=E(e.dts-k,w)}),m.sort(function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n||e.id-t.id});var S=m.reduce(function(e,t){return Math.max(Math.min(e,t.pts-t.dts),-18e3)},0);if(S<0){l.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(S/90)+" ms to overcome this issue");for(var A=0;A<m.length;A++)m[A].dts+=S}var R=m[0];h=Math.max(R.dts,0),f=Math.max(R.pts,0);var x=Math.round((h-w)/90);r&&x&&(x>1?l.logger.log("AVC:"+x+" ms hole between fragments detected,filling it"):x<-1&&l.logger.log("AVC:"+-x+" ms overlapping between fragments detected"),h=w,m[0].dts=h,f=Math.max(f-x,w),m[0].pts=f,l.logger.log("Video/PTS/DTS adjusted: "+Math.round(f/90)+"/"+Math.round(h/90)+",delta:"+x+" ms")),R=m[m.length-1],v=Math.max(R.dts,0),p=Math.max(R.pts,0,v),T&&(a=Math.round((v-h)/(m.length-1)));for(var L=0,O=0,D=0;D<_;D++){for(var P=m[D],I=P.units,C=I.length,M=0,F=0;F<C;F++)M+=I[F].data.length;O+=M,L+=C,P.length=M,P.dts=T?h+D*a:Math.max(P.dts,h),P.pts=Math.max(P.pts,P.dts)}var N=O+4*L+8;try{o=new Uint8Array(N)}catch(e){return void this.observer.trigger(s.default.ERROR,{type:d.ErrorTypes.MUX_ERROR,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:N,reason:"fail allocating video mdat "+N})}var U=new DataView(o.buffer);U.setUint32(0,N),o.set(c.default.types.mdat,4);for(var B=0;B<_;B++){for(var j=m[B],G=j.units,H=0,W=void 0,K=0,V=G.length;K<V;K++){var z=G[K],q=z.data,Y=z.data.byteLength;U.setUint32(g,Y),g+=4,o.set(q,g),g+=Y,H+=4+Y}if(T)W=Math.max(0,a*Math.round((j.pts-j.dts)/a));else{if(B<_-1)a=m[B+1].dts-j.dts;else{var X=this.config,$=j.dts-m[B>0?B-1:B].dts;if(X.stretchShortVideoTrack){var J=X.maxBufferHole,Q=X.maxSeekHole,Z=Math.floor(Math.min(J,Q)*y),ee=(n?f+n*y:this.nextAudioPts)-j.pts;ee>Z?((a=ee-$)<0&&(a=$),l.logger.log("It is approximately "+ee/90+" ms to the next segment; using duration "+a/90+" ms for the last video frame.")):a=$}else a=$}W=Math.round(j.pts-j.dts)}b.push({size:H,duration:a,cts:W,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:j.key?2:1,isNonSync:j.key?0:1}})}this.nextAvcDts=v+a;var te=e.dropped;if(e.len=0,e.nbNalu=0,e.dropped=0,b.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var re=b[0].flags;re.dependsOn=2,re.isNonSync=0}e.samples=b,u=c.default.moof(e.sequenceNumber++,h,e),e.samples=[];var ne={data1:u,data2:o,startPTS:f/y,endPTS:(p+a)/y,startDTS:h/y,endDTS:this.nextAvcDts/y,type:"video",nb:b.length,dropped:te};return this.observer.trigger(s.default.FRAG_PARSING_DATA,ne),ne}},{key:"remuxAudio",value:function(e,t,r,n){var i,o,u,f,h,p,v,g=e.inputTimeScale,y=e.timescale,m=g/y,b=e.isAAC?1024:1152,_=b*m,E=this._PTSNormalize,k=this._initDTS,w=!e.isAAC&&this.typeSupported.mpeg,T=e.samples,S=[],A=this.nextAudioPts;if((r|=T.length&&A&&(n&&Math.abs(t-A/g)<.1||Math.abs(T[0].pts-A-k)<20*_))||(A=t*g),T.forEach(function(e){e.pts=e.dts=E(e.pts-k,A)}),T.sort(function(e,t){return e.pts-t.pts}),n&&e.isAAC)for(var R=0,x=A;R<T.length;){var L,O=T[R],D=O.pts;L=D-x;var P=Math.abs(1e3*L/g);if(L<=-_)l.logger.warn("Dropping 1 audio frame @ "+(x/g).toFixed(3)+"s due to "+P+" ms overlap."),T.splice(R,1),e.len-=O.unit.length;else if(L>=_&&P<1e4&&x){var I=Math.round(L/_);l.logger.warn("Injecting "+I+" audio frame @ "+(x/g).toFixed(3)+"s due to "+Math.round(1e3*L/g)+" ms gap.");for(var C=0;C<I;C++){var M=Math.max(x,0);(u=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),u=O.unit.subarray()),T.splice(R,0,{unit:u,pts:M,dts:M}),e.len+=u.length,x+=_,R++}O.pts=O.dts=x,x+=_,R++}else Math.abs(L),O.pts=O.dts=x,x+=_,R++}for(var F=0,N=T.length;F<N;F++){var U=T[F],B=U.unit,j=U.pts;if(void 0!==v)o.duration=Math.round((j-v)/m);else{var G=Math.round(1e3*(j-A)/g),H=0;if(r&&e.isAAC&&G){if(G>0&&G<1e4)H=Math.round((j-A)/_),l.logger.log(G+" ms hole between AAC samples detected,filling it"),H>0&&((u=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(u=B.subarray()),e.len+=H*u.length);else if(G<-12){l.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(A/g).toFixed(3)+"s/"+(j/g).toFixed(3)+"s/"+-G+"ms"),e.len-=B.byteLength;continue}j=A}if(p=Math.max(0,j),!(e.len>0))return;var W=w?e.len:e.len+8;i=w?0:8;try{f=new Uint8Array(W)}catch(e){return void this.observer.trigger(s.default.ERROR,{type:d.ErrorTypes.MUX_ERROR,details:d.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:W,reason:"fail allocating audio mdat "+W})}if(!w){var K=new DataView(f.buffer);K.setUint32(0,W),f.set(c.default.types.mdat,4)}for(var V=0;V<H;V++)(u=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount))||(l.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),u=B.subarray()),f.set(u,i),i+=u.byteLength,o={size:u.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(o)}f.set(B,i);var z=B.byteLength;i+=z,o={size:z,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},S.push(o),v=j}var q=0,Y=S.length;if(Y>=2&&(q=S[Y-2].duration,o.duration=q),Y){this.nextAudioPts=A=v+m*q,e.len=0,e.samples=S,h=w?new Uint8Array:c.default.moof(e.sequenceNumber++,p/m,e),e.samples=[];var X=p/g,$=A/g,J={data1:h,data2:f,startPTS:X,endPTS:$,startDTS:X,endDTS:$,type:"audio",nb:Y};return this.observer.trigger(s.default.FRAG_PARSING_DATA,J),J}return null}},{key:"remuxEmptyAudio",value:function(e,t,r,n){var i=e.inputTimeScale,o=e.samplerate?e.samplerate:i,s=i/o,u=this.nextAudioPts,c=(void 0!==u?u:n.startDTS*i)+this._initDTS,d=n.endDTS*i+this._initDTS,f=1024*s,h=Math.ceil((d-c)/f),p=a.default.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(l.logger.warn("remux empty Audio"),p){for(var v=[],g=0;g<h;g++){var y=c+g*f;v.push({unit:p,pts:y,dts:y}),e.len+=p.length}e.samples=v,this.remuxAudio(e,t,r)}else l.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")}},{key:"remuxID3",value:function(e,t){var r,n=e.samples.length,i=e.inputTimeScale,a=this._initPTS,o=this._initDTS;if(n){for(var l=0;l<n;l++)(r=e.samples[l]).pts=(r.pts-a)/i,r.dts=(r.dts-o)/i;this.observer.trigger(s.default.FRAG_PARSING_METADATA,{samples:e.samples})}e.samples=[],t=t}},{key:"remuxText",value:function(e,t){e.samples.sort(function(e,t){return e.pts-t.pts});var r,n=e.samples.length,i=e.inputTimeScale,a=this._initPTS;if(n){for(var o=0;o<n;o++)(r=e.samples[o]).pts=(r.pts-a)/i;this.observer.trigger(s.default.FRAG_PARSING_USERDATA,{samples:e.samples})}e.samples=[],t=t}},{key:"_PTSNormalize",value:function(e,t){var r;if(void 0===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}}]),e}();r.default=h},{28:28,30:30,31:31,39:39,46:46}],41:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(30),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.observer=t}return n(e,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(){}},{key:"remux",value:function(e,t,r,n,i,o,s,l){var u=this.observer,c="";e&&(c+="audio"),t&&(c+="video"),u.trigger(a.default.FRAG_PARSING_DATA,{data1:l,startPTS:i,startDTS:i,type:c,nb:1,dropped:0}),u.trigger(a.default.FRAG_PARSED)}}]),e}();r.default=o},{30:30}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),"string"==typeof t&&(t=e.parseAttrList(t)),t)t.hasOwnProperty(r)&&(this[r]=t[r])}return n(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"decimalResolution",value:function(e){var t=i.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}}],[{key:"parseAttrList",value:function(e){var t,r={};for(a.lastIndex=0;null!==(t=a.exec(e));){var n=t[2];0===n.indexOf('"')&&n.lastIndexOf('"')===n.length-1&&(n=n.slice(1,-1)),r[t[1]]=n}return r}}]),e}();r.default=o},{}],43:[function(e,t,r){"use strict";t.exports={search:function(e,t){for(var r=0,n=e.length-1,i=null,a=null;r<=n;){a=e[i=(r+n)/2|0];var o=t(a);if(o>0)r=i+1;else{if(!(o<0))return a;n=i-1}}return null}}},{}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(45),a=function(e){return e&&e.__esModule?e:{default:e}}(i),o=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hls=t,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new a.default(r),this.fast_=new a.default(n)}return n(e,[{key:"sample",value:function(e,t){e=Math.max(e,this.minDelayMs_);var r=8e3*t/e,n=e/1e3;this.fast_.sample(n,r),this.slow_.sample(n,r)}},{key:"canEstimate",value:function(){var e=this.fast_;return e&&e.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"destroy",value:function(){}}]),e}();r.default=o},{45:45}],45:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}return n(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/e}return this.estimate_}}]),e}();r.default=i},{}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(){}var a={trace:i,debug:i,log:i,warn:i,info:i,error:i},o=a;function s(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];r.forEach(function(t){o[t]=e[t]?e[t].bind(e):function(e){var t=self.console[e];return t?function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];n[0]&&(n[0]=function(e,t){return t="["+e+"] > "+t}(e,n[0])),t.apply(self.console,n)}:i}(t)})}r.enableLogs=function(e){if(!0===e||"object"===(void 0===e?"undefined":n(e))){s(e,"debug","log","info","warn","error");try{o.log()}catch(e){o=a}}else o=a},r.logger=o},{}],47:[function(e,t,r){"use strict";t.exports={toString:function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="["+e.start(n).toFixed(3)+","+e.end(n).toFixed(3)+"]";return t}}},{}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=e(46),a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}return n(e,[{key:"destroy",value:function(){this.abort(),this.loader=null}},{key:"abort",value:function(){var e=this.loader;e&&4!==e.readyState&&(this.stats.aborted=!0,e.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null}},{key:"load",value:function(e,t,r){this.context=e,this.config=t,this.callbacks=r,this.stats={trequest:performance.now(),retry:0},this.retryDelay=t.retryDelay,this.loadInternal()}},{key:"loadInternal",value:function(){var e,t=this.context;e="undefined"!=typeof XDomainRequest?this.loader=new XDomainRequest:this.loader=new XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var n=this.xhrSetup;try{if(n)try{n(e,t.url)}catch(r){e.open("GET",t.url,!0),n(e,t.url)}e.readyState||e.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:e.status,text:r.message},t,e)}t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),e.send()}},{key:"readystatechange",value:function(e){var t=e.currentTarget,r=t.readyState,n=this.stats,a=this.context,o=this.config;if(!n.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===n.tfirst&&(n.tfirst=Math.max(performance.now(),n.trequest)),4===r){var s=t.status;if(s>=200&&s<300){n.tload=Math.max(n.tfirst,performance.now());var l=void 0,u=void 0;"arraybuffer"===a.responseType?(l=t.response,u=l.byteLength):(l=t.responseText,u=l.length),n.loaded=n.total=u;var c={url:t.responseURL,data:l};this.callbacks.onSuccess(c,n,a,t)}else n.retry>=o.maxRetry||s>=400&&s<499?(i.logger.error(s+" while loading "+a.url),this.callbacks.onError({code:s,text:t.statusText},a,t)):(i.logger.warn(s+" while loading "+a.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),n.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout)}},{key:"loadtimeout",value:function(){i.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)}},{key:"loadprogress",value:function(e){var t=e.currentTarget,r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total);var n=this.callbacks.onProgress;n&&n(r,this.context,null,t)}}]),e}();r.default=a},{46:46}]},{},[35])(35)}]]);
//# sourceMappingURL=vendor.86729727be5839e91fff.js.map