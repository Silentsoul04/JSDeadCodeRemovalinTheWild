const videoFields = [
  'page_url', 'position', 'target', 'type', 'value', 'duration', 'audio_volume', 'source',
  'video_id', 'transcoder_path', 'video_ts', 'video_type', 'video_title', 'position', 'bandwidth',
  'orientation', 'play_start_type', 'player_location', 'hls_level', 'dimensions', 'buffer_count', 'buffer_duration', 'youtube_id'
];

function directMapFieldName(config, field) {
  config.addMapTo(field, '').mapFrom(`data.${field}`);
}

export function pixiedustMap(mapper) {
  const videoRouter = mapper.getOrCreateRouter('track/videoplayer');
  const videoConfig = videoRouter.createDefaultConfig();

  videoConfig.addMapTo('page_edition', '').mapFrom('data.page.country');
  videoConfig.addMapTo('page_type', '').mapFrom('data.page.type');
  videoConfig.addMapTo('platform', '').mapFrom('data.page.platform');
  videoConfig.addMapTo('referrer', '').mapFrom('data.user.referrer');

  videoFields.forEach(directMapFieldName.bind(null, videoConfig));

  return videoRouter;
}
