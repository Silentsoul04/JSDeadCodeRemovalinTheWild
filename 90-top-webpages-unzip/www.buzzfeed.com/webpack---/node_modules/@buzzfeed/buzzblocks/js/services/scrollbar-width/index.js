function checkScrollbarWidth() {
  const div = document.createElement('div');
  div.style.overflowY = 'scroll';
  div.style.width = '100px';
  div.style.height = '100px';
  div.style.zIndex = '-1';
  div.style.visibility = 'hidden';
  // the element has to be in DOM for the browser to calculate its dimensions
  document.body.appendChild(div);
  const scrollbarWidth = div.offsetWidth - div.clientWidth;
  document.body.removeChild(div);
  return scrollbarWidth;
}

const scrollbarWidth = checkScrollbarWidth();

function setScrollbarClass(element) {
  if (scrollbarWidth === 0) {
    element.classList.add('scrollbar--overlay');
  } else {
    element.classList.add(`scrollbar--${Math.ceil(scrollbarWidth)}px`); // should be integer, but just in case
  }
}

// so it can be used in CSS cascades
setScrollbarClass(document.documentElement);


export default {
  /**
   * Width of the broswer scrollbar in pixels
   * @returns {Number}
   */
  get scrollbarWidth() {
    return scrollbarWidth;
  },

  /**
   * Adds `scrollbar--overlay` CSS class to element if the broswer scrollbar width is 0
   * (i.e. it's an overlay scrollbar),
   * otherwise adds `scrollbar--Npx` CSS class accordingly (e.g. `scrollbar--15px` for 15px-wide scrollbar, etc.)
   * @param {HTMLElement} element
   */
  setScrollbarClass
};
